/*! For license information please see main.5e1e672b.chunk.js.LICENSE.txt */
(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{243:function(e,t,a){"use strict";var n=a(21),r=a(4),o=a(23),i=a(6),c=a(66),l=a(27),s=a(45),u=a(46),m=a(65),d=a(54),p=a(56),_=a(0),f=a.n(_),h=a(36),g=a(436),E=a(654),v=a(644),b=a(655),y=a(648),x=a(293),O=a(653),w=a(247),j=a(446),C=a(656),S=a(40),k=a.n(S);function P(){P=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function l(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(k){l=function(e,t,a){return e[t]=a}}function s(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),c=new j(r||[]);return n(i,"_invoke",{value:y(e,a,c)}),i}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(k){return{type:"throw",arg:k}}}e.wrap=s;var m={};function d(){}function p(){}function _(){}var f={};l(f,o,(function(){return this}));var h=Object.getPrototypeOf,g=h&&h(h(C([])));g&&g!==t&&a.call(g,o)&&(f=g);var E=_.prototype=d.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var r;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(r,i){!function n(r,o,i,c){var l=u(e[r],e,o);if("throw"!==l.type){var s=l.arg,m=s.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(m).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}(n,o,r,i)}))}return r=r?r.then(i,i):i()}})}function y(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return S()}for(a.method=r,a.arg=o;;){var i=a.delegate;if(i){var c=x(i,a);if(c){if(c===m)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var l=u(e,t,a);if("normal"===l.type){if(n=a.done?"completed":"suspendedYield",l.arg===m)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n="completed",a.method="throw",a.arg=l.arg)}}}function x(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function C(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=_,n(E,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:p,configurable:!0}),p.displayName=l(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},v(b.prototype),l(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var i=new b(s(t,a,n,r),o);return e.isGeneratorFunction(a)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},v(E),l(E,c,"Generator"),l(E,o,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=C,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return i.type="throw",i.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),w(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;w(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:C(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}var M=[{primary:"#0077BB",1:"#0077BB",2:"#0077BB"},{primary:"#009988",1:"#009988",2:"#009988"},{primary:"#CC3311",1:"#CC3311",2:"#CC3311"},{primary:"#33BBEE",1:"#33BBEE",2:"#33BBEE"},{primary:"#EE7733",1:"#EE7733",2:"#EE7733"},{primary:"#EE3377",1:"#EE3377",2:"#EE3377"},{primary:"#BBBBBB",1:"#BBBBBB",2:"#BBBBBB"},{primary:"#a6cee3",1:"#a6cee3",2:"#a6cee3"},{primary:"#1f78b4",1:"#1f78b4",2:"#1f78b4"},{primary:"#b2df8a",1:"#b2df8a",2:"#b2df8a"},{primary:"#33a02c",1:"#33a02c",2:"#33a02c"},{primary:"#fb9a99",1:"#fb9a99",2:"#fb9a99"},{primary:"#e31a1c",1:"#e31a1c",2:"#e31a1c"},{primary:"#fdbf6f",1:"#fdbf6f",2:"#fdbf6f"},{primary:"#ff7f00",1:"#ff7f00",2:"#ff7f00"},{primary:"#cab2d6",1:"#cab2d6",2:"#cab2d6"},{primary:"#6a3d9a",1:"#6a3d9a",2:"#6a3d9a"},{primary:"#ffff99",1:"#ffff99",2:"#ffff99"},{primary:"#b15928",1:"#b15928",2:"#b15928"}],L={};function D(e){if(e in L)return L[e];var t=/(.*)-[1234]/;if(t.test(e))return D(e.match(t)[1]);var a=M.shift();return L[e]=a.primary,L[e+"-1"]=a[1],L[e+"-2"]=a[2],L[e+"-3"]=a[3],L[e+"-4"]=a[4],D(e)}var T=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).createToolTip=function(e){return"".concat(e.datum.x.format("MMM DD HH:mm"),"\n").concat(n.relabelAndFormatSeries(e.datum.childName),": ").concat(Math.round(n.yTransformation(e.datum.y)*Math.pow(10,n.props.fixedDecimals))/Math.pow(10,n.props.fixedDecimals))},n.state={seriesMap:{},hiddenSeries:new Set,names:[],legendEvents:[],fetched:!1},n.onConnect=n.onConnect.bind(Object(m.a)(n)),n.onMessageArrived=n.onMessageArrived.bind(Object(m.a)(n)),n.selectLegendData=n.selectLegendData.bind(Object(m.a)(n)),n.selectVictoryLines=n.selectVictoryLines.bind(Object(m.a)(n)),n.yTransformation=n.props.yTransformation||function(e){return e},n.VictoryVoronoiContainer=n.props.allowZoom?Object(g.a)("zoom","voronoi"):Object(g.a)("voronoi"),n}return Object(u.a)(a,[{key:"onConnect",value:function(){this.client.subscribe(["pioreactor","+",this.props.experiment,this.props.topic].join("/"))}},{key:"componentDidUpdate",value:function(e){e.experiment!==this.props.experiment&&this.getData()}},{key:"componentDidMount",value:function(){this.getData(),this.props.config&&this.props.config["cluster.topology"]&&(this.props.config.remote&&this.props.config.remote.ws_url?this.client=new h.Client("ws://".concat(this.props.config.remote.ws_url,"/"),"webui_Chart"+Math.floor(1e4*Math.random())):this.client=new h.Client("".concat(this.props.config["cluster.topology"].leader_address),9001,"webui_Chart"+Math.floor(1e4*Math.random())),this.client.connect({userName:"pioreactor",password:"raspberry",keepAliveInterval:900,onSuccess:this.onConnect,reconnect:!0}),this.client.onMessageArrived=this.onMessageArrived)}},{key:"getData",value:function(){var e=Object(l.a)(P().mark((function e(){var t,a=this;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.experiment){e.next=2;break}return e.abrupt("return");case 2:return.6,t=new URLSearchParams({filter_mod_N:this.props.downSample?Math.max(Math.floor(.6*Math.min(this.props.deltaHours,this.props.lookback)),1):1,lookback:this.props.lookback}),e.next=6,fetch("/api/time_series/".concat(this.props.dataSource,"/").concat(this.props.experiment).concat(this.props.dataSourceColumn?"/"+this.props.dataSourceColumn:"","?").concat(t)).then((function(e){return e.json()})).then((function(e){var t,n={},r=Object(c.a)(e.series.entries());try{for(r.s();!(t=r.n()).done;){var o=Object(i.a)(t.value,2),l=o[0],s=o[1];e.data[l].length>0&&(n[s]={data:e.data[l].map((function(e){return{y:e.y,x:k.a.utc(e.x,"YYYY-MM-DDTHH:mm:ss.SSSSS").local()}})),name:s,color:D(s)})}}catch(m){r.e(m)}finally{r.f()}var u=Object.keys(n);a.setState({seriesMap:n,legendEvents:a.createLegendEvents(),names:u,fetched:!0})})).catch((function(e){console.log(e),a.setState({fetched:!0})}));case 6:this.forceUpdate();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteAndReturnSet",value:function(e,t){return e.delete(t),e}},{key:"createLegendEvents",value:function(){var e=this;return[{childName:"legend",target:"data",eventHandlers:{onClick:function(t,a){return[{childName:a.datum.name,target:"data",eventKey:"all",mutation:function(){return e.state.hiddenSeries.has(a.datum.name)?e.setState((function(t){return{hiddenSeries:e.deleteAndReturnSet(t.hiddenSeries,a.datum.name)}})):e.setState((function(e){return{hiddenSeries:e.hiddenSeries.add(a.datum.name)}})),null}}]}}}]}},{key:"onMessageArrived",value:function(e){if(this.state.fetched&&!e.retained&&e.payloadString){if(this.props.payloadKey)var t=JSON.parse(e.payloadString),a=k.a.utc(t.timestamp).local(),i=parseFloat(t[this.props.payloadKey]);else i=parseFloat(e.payloadString),a=k.a.utc().local();var c=this.props.isODReading?e.topic.split("/")[1]+"-"+e.topic.split("/")[5]:e.topic.split("/")[1];try{if(c in this.state.seriesMap)this.state.seriesMap[c].data.push({x:a,y:i}),this.setState({seriesMap:this.state.seriesMap});else{var l=Object(o.a)(Object(o.a)({},this.state.seriesMap),{},Object(r.a)({},c,{data:[{x:a,y:i}],name:c,color:D(c)}));this.setState({seriesMap:l}),this.setState({names:[].concat(Object(n.a)(this.state.names),[c])})}}catch(s){console.log(s)}}}},{key:"breakString",value:function(e){return e.length>12?e.slice(0,5)+"..."+e.slice(e.length-2,e.length):e}},{key:"relabelAndFormatSeries",value:function(e){if(!this.props.relabelMap)return e;if(e.match(/(.*)-([1234])/g)){var t=e.match(/(.*)-([1234])/),a=t[1],n=t[2];return this.breakString(this.props.relabelMap[a]||a)+"-ch"+n}return this.breakString(this.props.relabelMap[e]||e)}},{key:"selectLegendData",value:function(e){var t=this.relabelAndFormatSeries(e);if(!this.state.seriesMap)return{};var a={name:t,symbol:{fill:this.state.seriesMap[e].color}};return this.state.hiddenSeries.has(t)?Object(o.a)(Object(o.a)({},a),{},{symbol:{fill:"white"}}):a}},{key:"selectVictoryLines",value:function(e){var t=this,a=this.relabelAndFormatSeries(e),n=null;return n=1===this.state.seriesMap[e].data.length?f.a.createElement(E.a,{size:4,key:"line-"+a+this.props.id,name:a,style:{data:{fill:this.state.seriesMap[e].color}}}):f.a.createElement(v.a,{interpolation:this.props.interpolation,key:"line-"+a+this.props.id,name:a,style:{labels:{fill:this.state.seriesMap[e].color},data:{stroke:this.state.seriesMap[e].color,strokeWidth:2},parent:{border:"1px solid #ccc"}}}),f.a.createElement(b.a,{key:this.props.id,data:this.state.hiddenSeries.has(a)?[]:this.state.seriesMap[e].data,x:"x",y:function(e){return t.yTransformation(e.y)}},n)}},{key:"render",value:function(){var e=this;return f.a.createElement(y.a,{style:{parent:{maxWidth:"700px"}},title:this.props.title,domainPadding:10,padding:{left:70,right:50,bottom:80,top:50},events:this.state.legendEvents,height:315,width:600,scale:{x:"time"},theme:x.a.material,containerComponent:f.a.createElement(this.VictoryVoronoiContainer,{zoomDimension:"x",responsive:!0,voronoiBlacklist:["parent"],labels:this.createToolTip,labelComponent:f.a.createElement(O.a,{cornerRadius:0,flyoutStyle:{fill:"white",stroke:"#90a4ae",strokeWidth:1.5}})})},f.a.createElement(w.a,{text:this.props.title,x:300,y:30,textAnchor:"middle",style:{fontSize:16,fontFamily:"inherit"}}),f.a.createElement(j.a,{style:{tickLabels:{fontSize:14,padding:5,fontFamily:"inherit"}},offsetY:80,orientation:"bottom"}),f.a.createElement(j.a,{crossAxis:!1,dependentAxis:!0,domain:this.props.allowZoom?null:this.props.yAxisDomain,tickFormat:function(t){return"".concat(t.toFixed(e.props.fixedDecimals))},label:this.props.yAxisLabel,axisLabelComponent:f.a.createElement(w.a,{dy:-41,style:{fontSize:15,padding:10,fontFamily:"inherit"}}),style:{tickLabels:{fontSize:14,padding:5,fontFamily:"inherit"}}}),f.a.createElement(C.a,{x:65,y:270,symbolSpacer:6,itemsPerRow:4,name:"legend",borderPadding:{right:8},orientation:"horizontal",cursor:"pointer",gutter:15,rowGutter:5,style:{labels:{fontSize:13},data:{stroke:"#485157",strokeWidth:.5,size:6.5}},data:this.state.names.map(this.selectLegendData)}),Object.keys(this.state.seriesMap).map(this.selectVictoryLines))}}]),a}(f.a.Component);t.a=T},29:function(e,t,a){"use strict";function n(e){fetch("/api/configs/config.ini").then((function(e){if(e.ok)return e.text();throw new Error("Something went wrong")})).then((function(t){e(function(e){var t={section:/^\s*\[\s*([^\]]*)\s*\]\s*$/,param:/^\s*([^=]+?)\s*=\s*(.*?)\s*$/,comment:/^\s*;.*$/},a={},n=e.split(/[\r\n]+/),r=null;return n.forEach((function(e){if(!t.comment.test(e))if(t.param.test(e)){var n=e.match(t.param);r?a[r][n[1]]=n[2]:a[n[1]]=n[2]}else if(t.section.test(e)){n=e.match(t.section);a[n[1]]={},r=n[1]}else 0===e.length&&r&&(r=null)})),a}(t))})).catch((function(e){}))}function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"current";fetch("/api/unit_labels/".concat(t)).then((function(e){return e.json()})).then((function(t){e(t)}))}function o(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0;fetch("/api/run/".concat(e,"/").concat(t),{method:"PATCH",body:JSON.stringify({args:a,options:n}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){r&&"function"===typeof r&&r(e)}))}a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return o}))},297:function(module,__webpack_exports__,__webpack_require__){"use strict";var _Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),_mui_material_Grid__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(70),_mui_material_Button__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(165),_components_LogTable__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(385),_components_ExperimentSummary__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(387),_components_Chart__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(243),_components_MediaCard__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(406),_components_PioreactorIcon__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(64),react_router_dom__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(34),_utilities__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(29),_mui_material_Card__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(143),_mui_icons_material_ListAltOutlined__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(407),_mui_icons_material_ListAltOutlined__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_mui_icons_material_ListAltOutlined__WEBPACK_IMPORTED_MODULE_12__);function Overview(props){var _React$useState=react__WEBPACK_IMPORTED_MODULE_1___default.a.useState({}),_React$useState2=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_React$useState,2),experimentMetadata=_React$useState2[0],setExperimentMetadata=_React$useState2[1],_React$useState3=react__WEBPACK_IMPORTED_MODULE_1___default.a.useState({}),_React$useState4=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_React$useState3,2),relabelMap=_React$useState4[0],setRelabelMap=_React$useState4[1],_React$useState5=react__WEBPACK_IMPORTED_MODULE_1___default.a.useState({}),_React$useState6=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_React$useState5,2),config=_React$useState6[0],setConfig=_React$useState6[1],_React$useState7=react__WEBPACK_IMPORTED_MODULE_1___default.a.useState({}),_React$useState8=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_React$useState7,2),charts=_React$useState8[0],setCharts=_React$useState8[1];return react__WEBPACK_IMPORTED_MODULE_1___default.a.useEffect((function(){document.title=props.title,fetch("/api/experiments/latest").then((function(e){return e.json()})).then((function(e){setExperimentMetadata(e)})),fetch("/api/contrib/charts").then((function(e){return e.json()})).then((function(e){setCharts(e.reduce((function(e,t){return e[t.chart_key]=t,e}),{}))})),Object(_utilities__WEBPACK_IMPORTED_MODULE_10__.b)(setRelabelMap),Object(_utilities__WEBPACK_IMPORTED_MODULE_10__.a)(setConfig)}),[props.title]),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_mui_material_Grid__WEBPACK_IMPORTED_MODULE_2__.a,{container:!0,spacing:2,justifyContent:"space-between"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_mui_material_Grid__WEBPACK_IMPORTED_MODULE_2__.a,{item:!0,xs:12,md:12},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_components_ExperimentSummary__WEBPACK_IMPORTED_MODULE_5__.a,{experimentMetadata:experimentMetadata})),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_mui_material_Grid__WEBPACK_IMPORTED_MODULE_2__.a,{item:!0,xs:12,md:7,container:!0,spacing:2,justifyContent:"flex-start",style:{height:"100%"}},Object.entries(charts).filter((function(e){var t=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(e,2),a=t[0];t[1];return config["ui.overview.charts"]&&"1"===config["ui.overview.charts"][a]})).map((function(_ref3){var _ref4=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_ref3,2),chart_key=_ref4[0],chart=_ref4[1];return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment,{key:"grid-chart-".concat(chart_key)},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_mui_material_Grid__WEBPACK_IMPORTED_MODULE_2__.a,{item:!0,xs:12},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_mui_material_Card__WEBPACK_IMPORTED_MODULE_11__.a,{style:{maxHeight:"100%"}},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_components_Chart__WEBPACK_IMPORTED_MODULE_6__.a,{key:"chart-".concat(chart_key),config:config,dataSource:chart.data_source,title:chart.title,topic:chart.mqtt_topic,payloadKey:chart.payload_key,yAxisLabel:chart.y_axis_label,experiment:experimentMetadata.experiment,deltaHours:experimentMetadata.delta_hours,downSample:chart.down_sample,interpolation:chart.interpolation||"stepAfter",yAxisDomain:chart.y_axis_domain?chart.y_axis_domain:null,lookback:chart.lookback?eval(chart.lookback):1e4,fixedDecimals:chart.fixed_decimals,relabelMap:relabelMap,yTransformation:eval(chart.y_transformation||"(y) => y"),dataSourceColumn:chart.data_source_column,id:chart_key,isODReading:"raw_optical_density"===chart_key}))))}))),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_mui_material_Grid__WEBPACK_IMPORTED_MODULE_2__.a,{item:!0,xs:12,md:5,container:!0,spacing:1,justifyContent:"flex-end",style:{height:"100%"}},config["ui.overview.cards"]&&"1"===config["ui.overview.cards"].dosings&&react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_mui_material_Grid__WEBPACK_IMPORTED_MODULE_2__.a,{item:!0,xs:12},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_components_MediaCard__WEBPACK_IMPORTED_MODULE_7__.a,{experiment:experimentMetadata.experiment,config:config,relabelMap:relabelMap}),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_mui_material_Button__WEBPACK_IMPORTED_MODULE_3__.a,{to:"/pioreactors",component:react_router_dom__WEBPACK_IMPORTED_MODULE_9__.b,color:"primary",style:{textTransform:"none",verticalAlign:"middle",margin:"0px 3px"}},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_components_PioreactorIcon__WEBPACK_IMPORTED_MODULE_8__.a,{style:{fontSize:17,margin:"0px 3px"},color:"primary"})," See all Pioreactor details")),config["ui.overview.cards"]&&"1"===config["ui.overview.cards"].event_logs&&react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_mui_material_Grid__WEBPACK_IMPORTED_MODULE_2__.a,{item:!0,xs:12},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_components_LogTable__WEBPACK_IMPORTED_MODULE_4__.a,{experiment:experimentMetadata.experiment,config:config,relabelMap:relabelMap}),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_mui_material_Button__WEBPACK_IMPORTED_MODULE_3__.a,{to:"/export-data?experiment=".concat(experimentMetadata.experiment,"&logs=1"),component:react_router_dom__WEBPACK_IMPORTED_MODULE_9__.b,color:"primary",style:{textTransform:"none",verticalAlign:"middle",margin:"0px 3px"}},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_mui_icons_material_ListAltOutlined__WEBPACK_IMPORTED_MODULE_12___default.a,{style:{fontSize:17,margin:"0px 3px"},color:"primary"})," Export all logs")))))}__webpack_exports__.a=Overview},382:function(e,t,a){},385:function(e,t,a){"use strict";var n=a(4),r=a(21),o=a(23),i=a(27),c=a(45),l=a(46),s=a(65),u=a(54),m=a(56),d=a(0),p=a.n(d),_=a(7),f=a(36),h=a(40),g=a.n(h),E=a(445),v=a(143),b=a(440),y=a(71),x=a(117),O=a(442),w=a(444),j=a(60),C=a(441),S=a(443),k=a(195);function P(){P=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function l(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(k){l=function(e,t,a){return e[t]=a}}function s(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),c=new j(r||[]);return n(i,"_invoke",{value:y(e,a,c)}),i}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(k){return{type:"throw",arg:k}}}e.wrap=s;var m={};function d(){}function p(){}function _(){}var f={};l(f,o,(function(){return this}));var h=Object.getPrototypeOf,g=h&&h(h(C([])));g&&g!==t&&a.call(g,o)&&(f=g);var E=_.prototype=d.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var r;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(r,i){!function n(r,o,i,c){var l=u(e[r],e,o);if("throw"!==l.type){var s=l.arg,m=s.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(m).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}(n,o,r,i)}))}return r=r?r.then(i,i):i()}})}function y(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return S()}for(a.method=r,a.arg=o;;){var i=a.delegate;if(i){var c=x(i,a);if(c){if(c===m)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var l=u(e,t,a);if("normal"===l.type){if(n=a.done?"completed":"suspendedYield",l.arg===m)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n="completed",a.method="throw",a.arg=l.arg)}}}function x(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function C(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=_,n(E,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:p,configurable:!0}),p.displayName=l(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},v(b.prototype),l(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var i=new b(s(t,a,n,r),o);return e.isGeneratorFunction(a)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},v(E),l(E,c,"Generator"),l(E,o,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=C,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return i.type="throw",i.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),w(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;w(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:C(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}var M={NOTSET:0,DEBUG:1,INFO:2,NOTICE:2.5,WARNING:3,ERROR:4,CRITICAL:5},L=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={listOfLogs:[]},n.onConnect=n.onConnect.bind(Object(s.a)(n)),n.onMessageArrived=n.onMessageArrived.bind(Object(s.a)(n)),n}return Object(l.a)(a,[{key:"getData",value:function(){var e=Object(i.a)(P().mark((function e(){var t=this;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/logs/recent?"+new URLSearchParams({min_level:this.props.config.logging.ui_log_level})).then((function(e){return e.json()})).then((function(e){t.setState({listOfLogs:e.map((function(e,t){return Object(o.a)(Object(o.a)({},e),{},{key:t})}))})})).catch((function(e){console.log(e)}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.getData(),this.props.config.remote&&this.props.config.remote.ws_url?this.client=new f.Client("ws://".concat(this.props.config.remote.ws_url,"/"),"webui_LogTable"+Math.floor(1e4*Math.random())):this.client=new f.Client("".concat(this.props.config["cluster.topology"].leader_address),9001,"webui_LogTable"+Math.floor(1e4*Math.random())),this.client.connect({userName:"pioreactor",password:"raspberry",keepAliveInterval:900,timeout:180,onSuccess:this.onConnect,reconnect:!0}),this.client.onMessageArrived=this.onMessageArrived}},{key:"componentDidUpdate",value:function(e){e.experiment!==this.props.experiment&&this.getData()}},{key:"onConnect",value:function(){this.client.subscribe(["pioreactor","+",this.props.experiment,"logs","+"].join("/")),this.client.subscribe(["pioreactor","+","$experiment","logs","+"].join("/"))}},{key:"onMessageArrived",value:function(e){this.state.listOfLogs.length>50&&this.state.listOfLogs.pop();var t=e.topic.split("/")[1],a=JSON.parse(e.payloadString);M[a.level.toUpperCase()]<M[this.props.config.logging.ui_log_level.toUpperCase()]||this.setState({listOfLogs:[{timestamp:g.a.utc().format("YYYY-MM-DD[T]HH:mm:ss.SSSSS[Z]"),pioreactor_unit:t,message:String(a.message),task:a.task,is_error:"ERROR"===a.level,is_warning:"WARNING"===a.level,is_notice:"NOTICE"===a.level,key:Math.random()}].concat(Object(r.a)(this.state.listOfLogs))})}},{key:"relabelUnit",value:function(e){return this.props.relabelMap&&this.props.relabelMap[e]?"".concat(this.props.relabelMap[e]," / ").concat(e):e}},{key:"render",value:function(){var e=this,t=this.props.classes;return p.a.createElement(v.a,null,p.a.createElement(b.a,null,p.a.createElement(y.a,{variant:"h6",component:"h2"},p.a.createElement(x.a,{fontWeight:"fontWeightRegular"},"Recent event logs")),p.a.createElement(C.a,{style:{height:"660px",width:"100%",overflowY:"scroll"}},p.a.createElement(O.a,{stickyHeader:!0,size:"small","aria-label":"log table"},p.a.createElement(S.a,null,p.a.createElement(k.a,null,p.a.createElement(j.a,{className:Object(_.a)(t.headerCell)},"Time"),p.a.createElement(j.a,{className:Object(_.a)(t.headerCell)},"Pioreactor"),p.a.createElement(j.a,{className:Object(_.a)(t.headerCell)},"Source"),p.a.createElement(j.a,{className:Object(_.a)(t.headerCell)},"Message"))),p.a.createElement(w.a,null,this.state.listOfLogs.map((function(a){var r,o,i,c;return p.a.createElement(k.a,{key:a.key},p.a.createElement(j.a,{className:Object(_.a)(t.tightCell,t.smallText,(r={},Object(n.a)(r,t.noticeLog,a.is_notice),Object(n.a)(r,t.errorLog,a.is_error),Object(n.a)(r,t.warningLog,a.is_warning),r))},p.a.createElement("span",{title:g.a.utc(a.timestamp,"YYYY-MM-DD[T]HH:mm:ss.SSSSS[Z]").local().format("YYYY-MM-DD HH:mm:ss.SS")},g.a.utc(a.timestamp,"YYYY-MM-DD[T]HH:mm:ss.SSSSS[Z]").local().format("HH:mm:ss")," ")),p.a.createElement(j.a,{className:Object(_.a)(t.tightCell,t.smallText,(o={},Object(n.a)(o,t.noticeLog,a.is_notice),Object(n.a)(o,t.errorLog,a.is_error),Object(n.a)(o,t.warningLog,a.is_warning),o))}," ",e.relabelUnit(a.pioreactor_unit)),p.a.createElement(j.a,{className:Object(_.a)(t.tightCell,t.smallText,(i={},Object(n.a)(i,t.noticeLog,a.is_notice),Object(n.a)(i,t.errorLog,a.is_error),Object(n.a)(i,t.warningLog,a.is_warning),i))},a.task.replace(/_/g," ")),p.a.createElement(j.a,{className:Object(_.a)(t.tightCell,t.smallText,(c={},Object(n.a)(c,t.noticeLog,a.is_notice),Object(n.a)(c,t.errorLog,a.is_error),Object(n.a)(c,t.warningLog,a.is_warning),c))},a.message))})))))))}}]),a}(p.a.Component);t.a=Object(E.a)((function(e){return{tightCell:{padding:"6px 6px 6px 10px",fontSize:13},smallText:{fontSize:12},headerCell:{backgroundColor:"white",padding:"8px 6px 6px 6px"},tightRight:{textAlign:"right"},errorLog:{backgroundColor:"#ff7961"},warningLog:{backgroundColor:"#FFEA8A"},noticeLog:{backgroundColor:"#addcaf"}}}))(L)},387:function(e,t,a){"use strict";var n=a(45),r=a(46),o=a(54),i=a(56),c=a(4),l=a(0),s=a.n(l),u=a(40),m=a.n(u),d=a(143),p=a(435),_=a(71),f=a(117),h=a(652),g=a(649),E=a(642),v=a(165),b=a(392),y=a.n(b),x=a(393),O=a.n(x),w=a(154),j=a.n(w),C=a(242),S=a.n(C),k=a(187),P=a.n(k),M=a(111),L=a(34),D=Object(p.a)((function(e){return{title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0},textIcon:{fontSize:15,verticalAlign:"middle",margin:"0px 3px"},headerMenu:Object(c.a)({display:"flex",justifyContent:"space-between",marginBottom:"5px"},e.breakpoints.down("lg"),{flexFlow:"nowrap",flexDirection:"column"}),headerButtons:{display:"flex",flexDirection:"row",justifyContent:"flex-start",flexFlow:"wrap"}}})),T=function(e){Object(o.a)(a,e);var t=Object(i.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).saveToDatabaseOrSkip=function(){r.state.recentChange?(r.setState({recentChange:!1}),setTimeout(r.saveToDatabaseOrSkip,150)):(fetch("/api/experiments/".concat(r.props.experiment),{method:"PATCH",body:JSON.stringify({description:r.state.desc}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){200!==e.status&&console.log("Didn't save successfully.")})),r.setState({savingLoopActive:!1}))},r.onFocus=function(e){e.target.style.height=e.target.scrollHeight+"px"},r.handleChange=function(e){e.target.style.height=e.target.scrollHeight+"px",r.setState({desc:e.target.value}),r.setState({recentChange:!0}),r.state.savingLoopActive||(r.setState({savingLoopActive:!0}),setTimeout(r.saveToDatabaseOrSkip,150))},r.render=function(){return s.a.createElement("div",{style:{padding:"0px 5px 0px 5px"}},s.a.createElement(g.a,{htmlFor:"description-box"},"Description"),s.a.createElement(h.a,{placeholder:"Provide a description of your experiment.",id:"description-box",multiline:!0,fullWidth:!0,onChange:r.handleChange,value:r.state.desc,style:{padding:"10px 5px 10px 5px",fontSize:"14px",fontFamily:"Roboto",width:"100%",overflow:"hidden"}}))},r.contentEditable=s.a.createRef(),r.state={desc:"",recentChange:!1,savingLoopActive:!1},r}return Object(r.a)(a,[{key:"componentDidUpdate",value:function(e){this.props.description!==e.description&&this.setState({desc:this.props.description})}}]),a}(s.a.Component),B=function(){var e=D(),t=Object(M.b)();return s.a.createElement(s.a.Fragment,null,s.a.createElement(v.a,{style:{textTransform:"none",float:"right"},color:"primary",onClick:function(){t({description:"Starting a new experiment will stop data collection for the current experiment. Do you wish to proceed?",title:"Start a new experiment?",confirmationText:"Confirm",confirmationButtonProps:{color:"primary",to:"/start-new-experiment",component:L.b},cancellationButtonProps:{color:"secondary"}})}},s.a.createElement(P.a,{fontSize:"15",classes:{root:e.textIcon}})," New experiment"))},A=function(){var e=D(),t=Object(M.b)();return s.a.createElement(s.a.Fragment,null,s.a.createElement(v.a,{style:{textTransform:"none",float:"right"},color:"primary",onClick:function(){t({description:"This will halt all activities (stirring, dosing, optical density reading, etc.) in all Pioreactor units. You can manually start them again later. Do you wish to end the experiment?",title:"End experiment?",confirmationText:"Confirm",confirmationButtonProps:{color:"primary"},cancellationButtonProps:{color:"secondary"}}).then((function(){return fetch("/api/stop_all",{method:"POST"})}))}},s.a.createElement(S.a,{fontSize:"15",classes:{root:e.textIcon}})," End experiment"))};t.a=function(e){var t=D(),a=e.experimentMetadata.experiment||"",n=e.experimentMetadata.created_at||"",r=e.experimentMetadata.description||"",o=e.experimentMetadata.delta_hours||0;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",null,s.a.createElement("div",{className:t.headerMenu},s.a.createElement(_.a,{variant:"h5",component:"h1"},s.a.createElement(f.a,{fontWeight:"fontWeightBold"},a)),s.a.createElement("div",{className:t.headerButtons},s.a.createElement(B,null),s.a.createElement(A,null),s.a.createElement(v.a,{to:"/export-data?experiment=".concat(a),component:L.b,style:{textTransform:"none",marginRight:"0px",float:"right"},color:"primary"},s.a.createElement(j.a,{fontSize:"15",classes:{root:t.textIcon}})," Export experiment data"))),s.a.createElement(E.a,null),s.a.createElement("div",{style:{margin:"10px 2px 10px 2px",display:"flex",flexDirection:"row",justifyContent:"flex-start",flexFlow:"wrap"}},s.a.createElement(_.a,{variant:"subtitle2",style:{flexGrow:1}},s.a.createElement("div",{style:{display:"inline"}},s.a.createElement(f.a,{fontWeight:"fontWeightBold",style:{display:"inline-block"}},s.a.createElement(y.a,{style:{fontSize:12,verticalAlign:"-1px"}})," Experiment started:"),s.a.createElement(f.a,{fontWeight:"fontWeightRegular",style:{marginRight:"1%",display:"inline-block"}},""!==n&&s.a.createElement("span",{title:m()(n).format("YYYY-MM-DD HH:mm:ss")},m()(n).format("dddd, MMMM D, h:mm a")))),s.a.createElement("div",{style:{display:"inline"}},s.a.createElement(f.a,{fontWeight:"fontWeightBold",style:{display:"inline-block"}},s.a.createElement(O.a,{style:{fontSize:12,verticalAlign:"-1px"}}),"Time elapsed:"),s.a.createElement(f.a,{fontWeight:"fontWeightRegular",style:{marginRight:"1%",display:"inline-block"}},o,"h"))))),s.a.createElement(d.a,{className:t.root},s.a.createElement(d.a,{className:t.cardContent},s.a.createElement(T,{experiment:a,description:r}))))}},406:function(e,t,a){"use strict";var n=a(4),r=a(23),o=a(27),i=a(45),c=a(46),l=a(65),s=a(54),u=a(56),m=a(0),d=a.n(m),p=a(143),_=a(440),f=a(36),h=a(71),g=a(117),E=a(445),v=a(442),b=a(444),y=a(60),x=a(441),O=a(443),w=a(195),j=a(64);function C(){C=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function l(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(P){l=function(e,t,a){return e[t]=a}}function s(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),c=new j(r||[]);return n(i,"_invoke",{value:y(e,a,c)}),i}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(P){return{type:"throw",arg:P}}}e.wrap=s;var m={};function d(){}function p(){}function _(){}var f={};l(f,o,(function(){return this}));var h=Object.getPrototypeOf,g=h&&h(h(S([])));g&&g!==t&&a.call(g,o)&&(f=g);var E=_.prototype=d.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var r;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(r,i){!function n(r,o,i,c){var l=u(e[r],e,o);if("throw"!==l.type){var s=l.arg,m=s.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(m).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}(n,o,r,i)}))}return r=r?r.then(i,i):i()}})}function y(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return k()}for(a.method=r,a.arg=o;;){var i=a.delegate;if(i){var c=x(i,a);if(c){if(c===m)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var l=u(e,t,a);if("normal"===l.type){if(n=a.done?"completed":"suspendedYield",l.arg===m)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n="completed",a.method="throw",a.arg=l.arg)}}}function x(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:k}}function k(){return{value:void 0,done:!0}}return p.prototype=_,n(E,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:p,configurable:!0}),p.displayName=l(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},v(b.prototype),l(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var i=new b(s(t,a,n,r),o);return e.isGeneratorFunction(a)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},v(E),l(E,c,"Generator"),l(E,o,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=S,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return i.type="throw",i.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),w(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;w(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:S(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}var S=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={mediaThroughputPerUnit:{},altMediaThroughputPerUnit:{},mediaThroughput:0,altMediaThroughput:0,rates:{all:{mediaRate:0,altMediaRate:0}},activeUnits:[]},n.onConnect=n.onConnect.bind(Object(l.a)(n)),n.onMessageArrived=n.onMessageArrived.bind(Object(l.a)(n)),n}return Object(c.a)(a,[{key:"getRecentRates",value:function(){var e=Object(o.a)(C().mark((function e(){var t=this;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/media_rates/current").then((function(e){return e.json()})).then((function(e){t.setState((function(t){return Object(r.a)(Object(r.a)({},t),{},{rates:e})}))}));case 2:return e.abrupt("return");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e){e.experiment!==this.props.experiment&&this.getRecentRates()}},{key:"componentDidMount",value:function(){this.props.config.remote&&this.props.config.remote.ws_url?this.client=new f.Client("ws://".concat(this.props.config.remote.ws_url,"/"),"webui_MediaCard"+Math.floor(1e4*Math.random())):this.client=new f.Client("".concat(this.props.config["cluster.topology"].leader_address),9001,"webui_MediaCard"+Math.floor(1e4*Math.random())),this.client.connect({userName:"pioreactor",password:"raspberry",keepAliveInterval:900,timeout:180,onSuccess:this.onConnect}),this.client.onMessageArrived=this.onMessageArrived,this.setState({activeUnits:Object.entries(this.props.config["cluster.inventory"]).filter((function(e){return"1"===e[1]})).map((function(e){return e[0]}))}),this.getRecentRates()}},{key:"onConnect",value:function(){this.client.subscribe(["pioreactor","+",this.props.experiment,"dosing_automation","alt_media_throughput"].join("/")),this.client.subscribe(["pioreactor","+",this.props.experiment,"dosing_automation","media_throughput"].join("/"))}},{key:"addOrUpdate",value:function(e,t,a){return Object.hasOwnProperty(e)?t[e]=a+t[e]:t[e]=a,t}},{key:"onMessageArrived",value:function(e){var t=e.destinationName.split("/"),a=parseFloat(e.payloadString),r=t[1],o="alt_media_throughput"===t.slice(-1)[0]?"altMediaThroughputPerUnit":"mediaThroughputPerUnit",i="alt_media_throughput"===t.slice(-1)[0]?"altMediaThroughput":"mediaThroughput";this.setState(Object(n.a)({},o,this.addOrUpdate(r,this.state[o],a)));var c=Object.values(this.state[o]).reduce((function(e,t){return e+t}),0);this.setState(Object(n.a)({},i,c))}},{key:"relabelUnit",value:function(e){return this.props.relabelMap&&this.props.relabelMap[e]?"".concat(this.props.relabelMap[e]," / ").concat(e):e}},{key:"render",value:function(){var e=this;return d.a.createElement(p.a,null,d.a.createElement(_.a,null,d.a.createElement(h.a,{variant:"h6",component:"h2"},d.a.createElement(g.a,{fontWeight:"fontWeightRegular"},"Dosing")),d.a.createElement(x.a,{style:{width:"100%"}},d.a.createElement(v.a,{size:"small","aria-label":"media throughput"},d.a.createElement(O.a,null,d.a.createElement(w.a,null,d.a.createElement(y.a,{style:{padding:"6px 0px"}}),d.a.createElement(y.a,{style:{padding:"6px 0px"},align:"right"},"Media"),d.a.createElement(y.a,{style:{padding:"6px 0px"},align:"right"},"Alt. Media"))),d.a.createElement(b.a,null,d.a.createElement(w.a,{key:"all"},d.a.createElement(y.a,{style:{padding:"6px 0px"},component:"th",scope:"row"},"All Pioreactors"),d.a.createElement(y.a,{align:"right",style:{fontSize:13,padding:"6px 0px"}},this.state.mediaThroughput.toFixed(1),"mL (~",this.state.rates.all.mediaRate.toFixed(1),"mL/h)"),d.a.createElement(y.a,{align:"right",style:{fontSize:13,padding:"6px 0px"}},this.state.altMediaThroughput.toFixed(1),"mL (~",this.state.rates.all.altMediaRate.toFixed(1),"mL/h)")),this.state.activeUnits.map((function(t){return d.a.createElement(w.a,{key:t},d.a.createElement(y.a,{style:{padding:"6px 0px"},component:"th",scope:"row"},d.a.createElement(j.a,{style:{fontSize:14,verticalAlign:"middle"},color:"inherit"}),e.relabelUnit(t)),d.a.createElement(y.a,{align:"right",style:{fontSize:13,padding:"6px 0px"}},(e.state.mediaThroughputPerUnit[t]||0).toFixed(1),"mL (~",e.state.rates[t]?e.state.rates[t].mediaRate.toFixed(1):"0.0","mL/h)"),d.a.createElement(y.a,{align:"right",style:{fontSize:13,padding:"6px 0px"}},(e.state.altMediaThroughputPerUnit[t]||0).toFixed(1),"mL (~",e.state.rates[t]?e.state.rates[t].altMediaRate.toFixed(1):"0.0","mL/h)"))})))))))}}]),a}(d.a.Component);t.a=Object(E.a)((function(e){return{tightCell:{padding:"8px 2px 6px 4px",fontSize:13},smallText:{fontSize:12},headerCell:{backgroundColor:"white",padding:"8px 6px 6px 6px"},tightRight:{textAlign:"right"}}}))(S)},419:function(module,__webpack_exports__,__webpack_require__){"use strict";var _Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(252),_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toPropertyKey__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(431),_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(23),_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(21),_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(27),_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(6),_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_7__),moment__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(40),moment__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_8__),_mui_material_FormLabel__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(434),_mui_material_FormControl__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(438),_mui_material_FormGroup__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(439),_mui_material_FormControlLabel__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(651),_mui_material_Grid__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(70),_mui_material_Button__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(165),_components_Chart__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(243),_mui_styles__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(435),_mui_material_Select__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(645),_mui_material__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(71),_mui_material_Box__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(117),_mui_material_MenuItem__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(650),_mui_material_Checkbox__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(646),_mui_material_Card__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(143),_utilities__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(29),_mui_icons_material_GetApp__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(154),_mui_icons_material_GetApp__WEBPACK_IMPORTED_MODULE_24___default=__webpack_require__.n(_mui_icons_material_GetApp__WEBPACK_IMPORTED_MODULE_24__),react_router_dom__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(34);function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function l(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(k){l=function(e,t,a){return e[t]=a}}function s(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),c=new j(r||[]);return n(i,"_invoke",{value:y(e,a,c)}),i}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(k){return{type:"throw",arg:k}}}e.wrap=s;var m={};function d(){}function p(){}function _(){}var f={};l(f,o,(function(){return this}));var h=Object.getPrototypeOf,g=h&&h(h(C([])));g&&g!==t&&a.call(g,o)&&(f=g);var E=_.prototype=d.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var r;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(r,i){!function n(r,o,i,c){var l=u(e[r],e,o);if("throw"!==l.type){var s=l.arg,m=s.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(m).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}(n,o,r,i)}))}return r=r?r.then(i,i):i()}})}function y(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return S()}for(a.method=r,a.arg=o;;){var i=a.delegate;if(i){var c=x(i,a);if(c){if(c===m)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var l=u(e,t,a);if("normal"===l.type){if(n=a.done?"completed":"suspendedYield",l.arg===m)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n="completed",a.method="throw",a.arg=l.arg)}}}function x(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function C(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=_,n(E,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:p,configurable:!0}),p.displayName=l(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},v(b.prototype),l(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var i=new b(s(t,a,n,r),o);return e.isGeneratorFunction(a)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},v(E),l(E,c,"Generator"),l(E,o,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=C,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return i.type="throw",i.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),w(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;w(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:C(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}var useStyles=Object(_mui_styles__WEBPACK_IMPORTED_MODULE_16__.a)((function(e){return{root:{marginTop:"15px"},formControl:{margin:e.spacing(2)},title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0},caption:{marginLeft:"30px",maxWidth:"650px"},headerMenu:Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_6__.a)({display:"flex",justifyContent:"space-between",marginBottom:"5px"},e.breakpoints.down("lg"),{flexFlow:"nowrap",flexDirection:"column"}),headerButtons:{display:"flex",flexDirection:"row",justifyContent:"flex-start",flexFlow:"wrap"}}}));function ExperimentSelection(e){var t=useStyles(),a=react__WEBPACK_IMPORTED_MODULE_7___default.a.useState([]),n=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_5__.a)(a,2),r=n[0],o=n[1],i=r.find((function(t){return t.experiment===e.experimentSelection}));react__WEBPACK_IMPORTED_MODULE_7___default.a.useEffect((function(){function t(){return(t=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/experiments").then((function(e){return e.json()})).then((function(t){o((function(e){return[].concat(Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__.a)(t),Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__.a)(e))})),e.handleExperimentSelectionChange(t[0].experiment)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]);return react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement("div",{style:{maxWidth:"450px",margin:"10px"}},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_FormControl__WEBPACK_IMPORTED_MODULE_10__.a,{fullWidth:!0,component:"fieldset",className:t.formControl},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_FormLabel__WEBPACK_IMPORTED_MODULE_9__.a,{component:"legend"},"Experiment"),react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_Select__WEBPACK_IMPORTED_MODULE_17__.a,{labelId:"expSelect",variant:"standard",value:e.experimentSelection,onChange:function(t){e.handleExperimentSelectionChange(t.target.value)}},r.map((function(e){return react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_MenuItem__WEBPACK_IMPORTED_MODULE_20__.a,{key:e.experiment,value:e.experiment},e.experiment+(e.created_at?" (".concat(moment__WEBPACK_IMPORTED_MODULE_8___default()(e.created_at).format("MMMM D, YYYY"),")"):""))})))),react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_Box__WEBPACK_IMPORTED_MODULE_19__.a,{sx:{p:2,pt:0}},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_18__.a,{sx:{fontSize:16},color:"text.secondary",gutterBottom:!0},"Experiment started"),react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_18__.a,{variant:"body2",style:{whiteSpace:"pre-line"},gutterBottom:!0},moment__WEBPACK_IMPORTED_MODULE_8___default()(null===i||void 0===i?void 0:i.created_at).format("MMMM D, YYYY, h:mm a")),react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_18__.a,{sx:{fontSize:16,pt:1},color:"text.secondary",gutterBottom:!0},"Description"),react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_18__.a,{variant:"body2",style:{whiteSpace:"pre-line"}},null===i||void 0===i?void 0:i.description)))}function ChartSelection(e){var t=useStyles(),a=react__WEBPACK_IMPORTED_MODULE_7___default.a.useState({}),n=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_5__.a)(a,2),r=n[0],o=n[1];react__WEBPACK_IMPORTED_MODULE_7___default.a.useEffect((function(){function e(){return(e=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/contrib/charts").then((function(e){return e.json()})).then((function(e){o(e.reduce((function(e,t){return e[t.chart_key]=t,e}),{}))}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var i=function(t){e.handleChartSelectionChange(r[t.target.name],t.target.checked)};return react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement("div",{style:{maxWidth:"450px",margin:"10px"}},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_FormControl__WEBPACK_IMPORTED_MODULE_10__.a,{fullWidth:!0,component:"fieldset",className:t.formControl},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_FormLabel__WEBPACK_IMPORTED_MODULE_9__.a,{component:"legend"},"Charts"),react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_FormGroup__WEBPACK_IMPORTED_MODULE_11__.a,null,Object.entries(r).filter((function(t){var a=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_5__.a)(t,2),n=a[0];a[1];return e.config["ui.overview.charts"]&&"1"===e.config["ui.overview.charts"][n]})).map((function(t){var a=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_5__.a)(t,2),n=a[0],r=a[1];return react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_FormControlLabel__WEBPACK_IMPORTED_MODULE_12__.a,{key:n,control:react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_Checkbox__WEBPACK_IMPORTED_MODULE_21__.a,{checked:n in e.chartSelection,onChange:i,name:n,size:"small"}),label:r.title})})))))}function ExperimentsContainer(props){var classes=useStyles(),_React$useState5=react__WEBPACK_IMPORTED_MODULE_7___default.a.useState(""),_React$useState6=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_5__.a)(_React$useState5,2),experimentSelection=_React$useState6[0],setExperimentSelection=_React$useState6[1],_React$useState7=react__WEBPACK_IMPORTED_MODULE_7___default.a.useState({}),_React$useState8=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_5__.a)(_React$useState7,2),chartSelection=_React$useState8[0],setChartSelection=_React$useState8[1],_React$useState9=react__WEBPACK_IMPORTED_MODULE_7___default.a.useState({}),_React$useState10=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_5__.a)(_React$useState9,2),config=_React$useState10[0],setConfig=_React$useState10[1],_React$useState11=react__WEBPACK_IMPORTED_MODULE_7___default.a.useState({}),_React$useState12=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_5__.a)(_React$useState11,2),relabelMap=_React$useState12[0],setRelabelMap=_React$useState12[1];function handleExperimentSelectionChange(e){setExperimentSelection(e),Object(_utilities__WEBPACK_IMPORTED_MODULE_23__.b)(setRelabelMap,e)}function handleChartSelectionChange(e,t){if(t)setChartSelection(Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.a)(Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.a)({},chartSelection),{},Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_6__.a)({},e.chart_key,e)));else{var a=e.chart_key,n=(chartSelection[a],Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__.a)(chartSelection,[a].map(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toPropertyKey__WEBPACK_IMPORTED_MODULE_1__.a)));setChartSelection(n)}}function objectToQueryString(e){var t={implied_growth_rate:"growth_rates",raw_optical_density:"od_readings",temperature:"temperature_readings",normalized_optical_density:"od_readings_filtered",fraction_of_volume_that_is_alternative_media:"alt_media_fraction"},a="";for(var n in e)e.hasOwnProperty(n)&&t.hasOwnProperty(n)&&(a+="&".concat(t[n],"=1"));return a}react__WEBPACK_IMPORTED_MODULE_7___default.a.useEffect((function(){document.title=props.title,Object(_utilities__WEBPACK_IMPORTED_MODULE_23__.a)(setConfig)}),[props.title]);var additionalQueryString=objectToQueryString(chartSelection);return react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_7___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement("div",{className:classes.headerMenu},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_18__.a,{variant:"h5",component:"h2"},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_Box__WEBPACK_IMPORTED_MODULE_19__.a,{fontWeight:"fontWeightBold"},"Past Experiments")),react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement("div",{className:classes.headerButtons},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_Button__WEBPACK_IMPORTED_MODULE_14__.a,{to:"/export-data?experiment=".concat(experimentSelection,"&experiments=1").concat(additionalQueryString),component:react_router_dom__WEBPACK_IMPORTED_MODULE_25__.b,style:{textTransform:"none",marginRight:"0px",float:"right"},color:"primary"},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_icons_material_GetApp__WEBPACK_IMPORTED_MODULE_24___default.a,{fontSize:"15",classes:{root:classes.textIcon}})," Export experiment data")))),react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_Card__WEBPACK_IMPORTED_MODULE_22__.a,{className:classes.root},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_Card__WEBPACK_IMPORTED_MODULE_22__.a,{className:classes.cardContent},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_Grid__WEBPACK_IMPORTED_MODULE_13__.a,{container:!0,spacing:2,justifyContent:"space-between"},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_Grid__WEBPACK_IMPORTED_MODULE_13__.a,{item:!0,xs:6},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(ExperimentSelection,{experimentSelection:experimentSelection,handleExperimentSelectionChange:handleExperimentSelectionChange})),react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_Grid__WEBPACK_IMPORTED_MODULE_13__.a,{item:!0,xs:6},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(ChartSelection,{chartSelection:chartSelection,handleChartSelectionChange:handleChartSelectionChange,config:config})),react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_Grid__WEBPACK_IMPORTED_MODULE_13__.a,{item:!0,xs:12,md:12,container:!0,spacing:2,justifyContent:"flex-start",style:{height:"100%"}},Object.entries(chartSelection).sort().map((function(_ref5){var _ref6=Object(_Users_camerondavidson_pilon_code_pioreactorui_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_5__.a)(_ref5,2),chart_key=_ref6[0],chart=_ref6[1];return react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_7___default.a.Fragment,{key:"grid-chart-".concat(chart_key)},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_Grid__WEBPACK_IMPORTED_MODULE_13__.a,{item:!0,xs:6},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_components_Chart__WEBPACK_IMPORTED_MODULE_15__.a,{key:"chart-".concat(chart_key),config:config,dataSource:chart.data_source,title:chart.title,topic:chart.mqtt_topic,payloadKey:chart.payload_key,yAxisLabel:chart.y_axis_label,experiment:experimentSelection,deltaHours:10,downSample:!0,interpolation:chart.interpolation||"stepAfter",yAxisDomain:chart.y_axis_domain?chart.y_axis_domain:null,lookback:1e4,fixedDecimals:chart.fixed_decimals,yTransformation:eval(chart.y_transformation||"(y) => y"),dataSourceColumn:chart.data_source_column,id:chart_key,relabelMap:relabelMap,isODReading:"raw_optical_density"===chart_key,allowZoom:!0})))})))))))}function Experiments(e){return react__WEBPACK_IMPORTED_MODULE_7___default.a.useEffect((function(){document.title=e.title}),[e.title]),react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_Grid__WEBPACK_IMPORTED_MODULE_13__.a,{container:!0,spacing:2},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_mui_material_Grid__WEBPACK_IMPORTED_MODULE_13__.a,{item:!0,md:12,xs:12},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(ExperimentsContainer,null)))}__webpack_exports__.a=Experiments},480:function(e,t,a){e.exports=a(632)},485:function(e,t,a){},632:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(90),i=a.n(o),c=(a(485),a(20)),l=a(34),s=a(429),u=a(771),m=a(733),d=a(732),p=a(6),_=a(36),f=a(738),h=a(752),g=a(29),E=a(741);var v=function(e){var t=r.a.useState(""),a=Object(p.a)(t,2),n=a[0],o=a[1],i=r.a.useState(""),c=Object(p.a)(i,2),l=c[0],s=c[1],u=r.a.useState(!1),m=Object(p.a)(u,2),d=m[0],v=m[1],b=r.a.useState({}),y=Object(p.a)(b,2),x=y[0],O=y[1],w=r.a.useState({}),j=Object(p.a)(w,2),C=j[0],S=j[1];return r.a.useEffect((function(){Object(g.b)(O),Object(g.a)(S)}),[]),r.a.useEffect((function(){if(C["cluster.topology"]){var e;(e=C.remote&&C.remote.ws_url?new _.Client("ws://".concat(C.remote.ws_url,"/"),"webui_TactileButtonNotification"+Math.floor(1e4*Math.random())):new _.Client("".concat(C["cluster.topology"].leader_address),9001,"webui_TactileButtonNotification"+Math.floor(1e4*Math.random()))).connect({userName:"pioreactor",password:"raspberry",keepAliveInterval:900,onSuccess:function(){e.subscribe(["pioreactor","+","$experiment","monitor","button_down"].join("/"),{qos:1})},timeout:180,reconnect:!0}),e.onMessageArrived=function(e){if("True"===e.payloadString){var t=e.topic.split("/")[1];o(t);try{s(x[t])}catch(a){}v(!0)}else v(!1)}}}),[C,x]),r.a.createElement(E.a,{open:d,autoHideDuration:null,onClose:function(){},anchorOrigin:{vertical:"bottom",horizontal:"center"},key:"button-tactile-snackbar",transitionDuration:{enter:10}},r.a.createElement(f.a,{severity:"info",variant:"filled",icon:!1},r.a.createElement(h.a,{style:{fontSize:30}},n+(l?" / "+l:"")),"Holding ",r.a.createElement("b",null,n),"'s button down"))};var b=function(e){var t=r.a.useState(!1),a=Object(p.a)(t,2),n=a[0],o=a[1],i=r.a.useState(""),c=Object(p.a)(i,2),l=c[0],s=c[1],u=r.a.useState(""),m=Object(p.a)(u,2),d=m[0],v=m[1],b=r.a.useState(""),y=Object(p.a)(b,2),x=y[0],O=y[1],w=r.a.useState("error"),j=Object(p.a)(w,2),C=j[0],S=j[1],k=r.a.useState(""),P=Object(p.a)(k,2),M=P[0],L=P[1],D=r.a.useState({}),T=Object(p.a)(D,2),B=T[0],A=T[1],I=r.a.useState({}),R=Object(p.a)(I,2),N=R[0],W=R[1];r.a.useEffect((function(){Object(g.b)(A),Object(g.a)(W)}),[]),r.a.useEffect((function(){if(N["cluster.topology"]){var e;(e=N.remote&&N.remote.ws_url?new _.Client("ws://".concat(N.remote.ws_url,"/"),"webui_ErrorSnackbarNotification"+Math.floor(1e4*Math.random())):new _.Client("".concat(N["cluster.topology"].leader_address),9001,"webui_ErrorSnackbarNotification"+Math.floor(1e4*Math.random()))).connect({userName:"pioreactor",password:"raspberry",keepAliveInterval:900,timeout:10,onSuccess:function(){e.subscribe(["pioreactor","+","+","logs","+"].join("/"),{qos:1})},onFailure:function(){O("Failed to connect to MQTT. Is configuration for leader_address correct? Currently set to ".concat(N["cluster.topology"].leader_address,".")),L("PioreactorUI"),S("ERROR"),v(N["cluster.topology"].leader_hostname),o(!0)}}),e.onMessageArrived=U}}),[N]);var U=function(e){var t=JSON.parse(e.payloadString);if(("ERROR"===t.level||"WARNING"===t.level||"NOTICE"===t.level)&&!e.topic.endsWith("/ui")){var a=e.topic.split("/")[1];try{s(B[a])}catch(n){}O(t.message),L(t.task),S("NOTICE"===t.level?"SUCCESS":t.level),v(a),o(!0)}},F=function(e,t){"clickaway"!==t&&o(!1)};return r.a.createElement(E.a,{open:n,anchorOrigin:{vertical:"bottom",horizontal:"right"},key:"error-snackbar",autoHideDuration:12e3,style:{maxWidth:"500px"},onClose:F},r.a.createElement(f.a,{variant:"standard",severity:C.toLowerCase(),onClose:F},r.a.createElement(h.a,{style:{fontSize:15}},M," encountered a ",C.toLowerCase()," in ",d+(l?" / "+l:"")),r.a.createElement("span",{style:{whiteSpace:"pre-wrap"}},x)))},y=a(297),x=a(23),O=a(21),w=a(27),j=a(4),C=a(40),S=a.n(C),k=a(70),P=a(7),M=a(435),L=a(434),D=a(438),T=a(439),B=a(651),A=a(646),I=a(143),R=a(650),N=a(71),W=a(645),U=a(117),F=a(757),K=a(409),z=a.n(K);function G(){G=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function l(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(k){l=function(e,t,a){return e[t]=a}}function s(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),c=new j(r||[]);return n(i,"_invoke",{value:y(e,a,c)}),i}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(k){return{type:"throw",arg:k}}}e.wrap=s;var m={};function d(){}function p(){}function _(){}var f={};l(f,o,(function(){return this}));var h=Object.getPrototypeOf,g=h&&h(h(C([])));g&&g!==t&&a.call(g,o)&&(f=g);var E=_.prototype=d.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var r;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(r,i){!function n(r,o,i,c){var l=u(e[r],e,o);if("throw"!==l.type){var s=l.arg,m=s.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(m).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}(n,o,r,i)}))}return r=r?r.then(i,i):i()}})}function y(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return S()}for(a.method=r,a.arg=o;;){var i=a.delegate;if(i){var c=x(i,a);if(c){if(c===m)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var l=u(e,t,a);if("normal"===l.type){if(n=a.done?"completed":"suspendedYield",l.arg===m)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n="completed",a.method="throw",a.arg=l.arg)}}}function x(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function C(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=_,n(E,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:p,configurable:!0}),p.displayName=l(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},v(b.prototype),l(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var i=new b(s(t,a,n,r),o);return e.isGeneratorFunction(a)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},v(E),l(E,c,"Generator"),l(E,o,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=C,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return i.type="throw",i.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),w(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;w(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:C(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}var H=Object(M.a)((function(e){return{root:{marginTop:"15px"},title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0},datasetItem:{padding:"10px"},recommended:{backgroundColor:"rgba(83, 49, 202, 0.08)"},datasetDescription:{marginLeft:"30px",fontSize:14},headerButtons:{display:"flex",flexDirection:"row",justifyContent:"flex-start",flexFlow:"wrap"},headerMenu:Object(j.a)({display:"flex",justifyContent:"space-between",marginBottom:"5px"},e.breakpoints.down("lg"),{flexFlow:"nowrap",flexDirection:"column"})}}));function Y(e){var t=H(),a=r.a.useState([{experiment:"<All experiments>"}]),n=Object(p.a)(a,2),o=n[0],i=n[1];r.a.useEffect((function(){function t(){return(t=Object(w.a)(G().mark((function t(){return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/experiments").then((function(e){return e.json()})).then((function(t){i((function(e){return[].concat(Object(O.a)(t),Object(O.a)(e))})),(""===e.experimentSelection||0===t.filter((function(t){return t.experiment===e.experimentSelection})).length)&&e.handleChange(t[0].experiment)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]);return r.a.createElement("div",{style:{maxWidth:"450px",margin:"10px"}},r.a.createElement(D.a,{fullWidth:!0,component:"fieldset",className:t.formControl},r.a.createElement(L.a,{component:"legend"},"Experiment"),r.a.createElement(W.a,{labelId:"expSelect",variant:"standard",value:e.experimentSelection,onChange:function(t){e.handleChange(t.target.value)}},o.map((function(e){return r.a.createElement(R.a,{value:e.experiment},e.experiment+(e.created_at?" (started ".concat(S()(e.created_at).format("MMMM D, YYYY"),")"):""))})))))}var $=function(e){var t=H();return r.a.createElement("div",{className:t.root,style:{margin:"10px"}},r.a.createElement(D.a,{component:"fieldset",className:t.formControl},r.a.createElement(L.a,{component:"legend"},"Available datasets"),r.a.createElement(T.a,null,r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.pioreactor_unit_activity_data,onChange:e.handleChange,name:"pioreactor_unit_activity_data"}),label:"Pioreactor unit activity data (recommended)"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},"This dataset contains most of your experiment data, including the time series of OD metrics, temperature, stirring rates, LED updates, and dosings.")),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.logs,onChange:e.handleChange,name:"logs"}),label:"Pioreactor logs"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},'This dataset includes the append-only collection of logs from all Pioreactors. A subset of the these logs are displayed in the Log Table in the Experiment Overview. These are the logs that should be provided to get assistance when troubleshooting, but choose "<All experiments>" above.')),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.growth_rates,onChange:e.handleChange,name:"growth_rates"}),label:"Implied growth rate"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},'This dataset includes a time series of the calculated (implied) growth rate. This data matches what\'s presented in the "Implied growth rate" chart in the Experiment Overview.')),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.od_readings,onChange:e.handleChange,name:"od_readings"}),label:"Optical density"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},'This dataset includes a time series of readings provided by the sensors (transformed via a calibration curve, if available), the inputs for growth calculations and normalized optical densities. This data matches what\'s presented in the "Optical density" chart in the Experiment Overview.')),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.od_readings_filtered,onChange:e.handleChange,name:"od_readings_filtered"}),label:"Normalized optical density"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},'This dataset includes a time series of normalized optical densities. This data matches what\'s presented in the "Normalized optical density" chart in the Experiment Overview.')),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.temperature_readings,onChange:e.handleChange,name:"temperature_readings"}),label:"Temperature readings"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},'This dataset includes a time series of temperature readings from the Pioreactors. This data matches what\'s presented in the "Temperature of vials" chart in the Experiment Overview.')),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.experiments,onChange:e.handleChange,name:"experiments"}),label:"Experiment metadata"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},"This dataset includes your experiment description and metadata.")),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.alt_media_fractions,onChange:e.handleChange,name:"alt_media_fractions"}),label:"Alternative media fraction"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},'This dataset includes a time series of how much alternative media is in each Pioreactor. This data matches what\'s presented in the "Fraction of volume that is alternative media" chart in the Experiment Overview.')),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.pioreactor_unit_activity_data_rollup,onChange:e.handleChange,name:"pioreactor_unit_activity_data_rollup"}),label:"Pioreactor unit activity data roll-up"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},"This dataset is a rolled-up version of Pioreactor unit activity data (above) aggregated to the minute level. This is useful for reducing the size of the exported dataset.")),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.dosing_events,onChange:e.handleChange,name:"dosing_events"}),label:"Dosing event log"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},"In this dataset, you'll find a detailed log table of all dosing events, including the volume exchanged, and the source of who or what triggered the event.")),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.led_change_events,onChange:e.handleChange,name:"led_change_events"}),label:"LED event log"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},"In this dataset, you'll find a log table of all LED events, including the channel, intensity, and the source of who or what triggered the event.")),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.dosing_automation_settings,onChange:e.handleChange,name:"dosing_automation_settings"}),label:"Dosing automation changelog"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},"Anytime an automation is updated (new automation, new setting, etc.), a new row is recorded. You can reconstruct all the dosing automation states from this dataset.")),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.led_automation_settings,onChange:e.handleChange,name:"led_automation_settings"}),label:"LED automation changelog"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},"Whenever a LED automation is updated (new automation, new setting, etc.), a new row is recorded. You can reconstruct all the LED automation states from this dataset.")),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.temperature_automation_settings,onChange:e.handleChange,name:"temperature_automation_settings"}),label:"Temperature automation changelog"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},"Whenever a temperature automation is updated (new automation, new setting, etc.), a new row is recorded. You can reconstruct all the temperature automation states from this dataset.")),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.dosing_automation_events,onChange:e.handleChange,name:"dosing_automation_events"}),label:"Dosing automation events"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},"This dataset includes a log of automation events created by dosing automations.")),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.led_automation_events,onChange:e.handleChange,name:"led_automation_events"}),label:"LED automation events"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},"This dataset includes a log of automation events created by LED automations.")),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.temperature_automation_events,onChange:e.handleChange,name:"temperature_automation_events"}),label:"Temperature automation events"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},"This dataset includes a log of automation events created by temperature automations.")),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.kalman_filter_outputs,onChange:e.handleChange,name:"kalman_filter_outputs"}),label:"Kalman filter outputs"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},"This dataset includes a time series of the internal Kalman filter. The Kalman filter produces the normalized optical densities, growth rates, an acceleration term, and variances (and covariances) between the estimates.")),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.stirring_rates,onChange:e.handleChange,name:"stirring_rates"}),label:"Stirring rates"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},"This dowload includes the measured RPM of the onboard stirring.")),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.pioreactor_unit_labels,onChange:e.handleChange,name:"pioreactor_unit_labels"}),label:"Pioreactor unit labels"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},"In this dataset, you'll find the labels assigned to a Pioreactor during an experiment.")),r.a.createElement("div",{className:Object(P.a)(t.datasetItem)},r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:e.isChecked.pwm_dcs,onChange:e.handleChange,name:"pwm_dcs"}),label:"PWM duty cycles"}),r.a.createElement(N.a,{className:t.datasetDescription,gutterBottom:!0},"This dataset contains a time series of the PWMs duty cycle percentages. Useful for debugging PWM use.")))))};function q(){var e=Object(l.c)(),t=Object(p.a)(e,2),a=t[0],n=(t[1],H()),o=r.a.useState(!1),i=Object(p.a)(o,2),c=i[0],s=i[1],u=r.a.useState(!1),m=Object(p.a)(u,2),d=m[0],_=m[1],f=r.a.useState(""),h=Object(p.a)(f,2),g=h[0],E=h[1],v=r.a.useState({experimentSelection:a.get("experiment")||"",datasetCheckbox:{pioreactor_unit_activity_data:"1"===a.get("pioreactor_unit_activity_data"),growth_rates:"1"===a.get("growth_rates"),dosing_events:"1"===a.get("dosing_events"),led_change_events:"1"===a.get("led_change_events"),experiments:"1"===a.get("experiments"),od_readings:"1"===a.get("od_readings"),od_readings_filtered:"1"===a.get("od_readings_filtered"),logs:"1"===a.get("logs"),alt_media_fractions:"1"===a.get("alt_media_fractions"),dosing_automation_settings:"1"===a.get("dosing_automation_settings"),led_automation_settings:"1"===a.get("led_automation_settings"),temperature_automation_settings:"1"===a.get("temperature_automation_settings"),kalman_filter_outputs:"1"===a.get("kalman_filter_outputs"),stirring_rates:"1"===a.get("stirring_rates"),temperature_readings:"1"===a.get("temperature_readings"),pioreactor_unit_labels:"1"===a.get("pioreactor_unit_labels"),led_automation_events:"1"===a.get("led_automation_events"),dosing_automation_events:"1"===a.get("dosing_automation_events"),temperature_automation_events:"1"===a.get("temperature_automation_events"),pwm_dcs:"1"===a.get("pwm_dcs"),pioreactor_unit_activity_data_rollup:"1"===a.get("pioreactor_unit_activity_data_rollup")}}),b=Object(p.a)(v,2),y=b[0],O=b[1],w=function(){return Object.values(y.datasetCheckbox).reduce((function(e,t){return e+(!0===t?1:0)}),0)};var C=d?r.a.createElement(U.a,{color:"error.main"},g):"";return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("div",{className:n.headerMenu},r.a.createElement(N.a,{variant:"h5",component:"h2"},r.a.createElement(U.a,{fontWeight:"fontWeightBold"},"Export Experiment Data")),r.a.createElement("div",{className:n.headerButtons},r.a.createElement(F.a,{type:"submit",variant:"contained",color:"primary",loading:c,loadingPosition:"end",onClick:function(e){if(e.preventDefault(),!Object.values(y.datasetCheckbox).some((function(e){return e})))return _(!0),void E("At least one dataset must be selected.");s(!0),E(""),fetch("/api/export_datasets",{method:"POST",body:JSON.stringify(y),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var t=document.createElement("a"),a=e.filename.replace(/%/g,"%25");t.setAttribute("export",a),t.href="/static/exports/"+a,document.body.appendChild(t),t.click(),t.remove(),s(!1)})).catch((function(e){s(!1),_(!0),E("Server error occurred. Check UI logs.")}))},endIcon:r.a.createElement(z.a,null),disabled:0===w()},"Export ",w()>0?w():"")))),r.a.createElement(I.a,{className:n.root},r.a.createElement(I.a,{className:n.cardContent},r.a.createElement("p",{style:{marginLeft:10}},C),r.a.createElement("form",null,r.a.createElement(k.a,{container:!0,spacing:0},r.a.createElement(k.a,{item:!0,xs:12,md:12},r.a.createElement(Y,{experimentSelection:y.experimentSelection,handleChange:function(e){O((function(t){return Object(x.a)(Object(x.a)({},t),{},{experimentSelection:e})}))}})),r.a.createElement(k.a,{item:!0,xs:12,md:12},r.a.createElement($,{isChecked:y.datasetCheckbox,handleChange:function(e){O((function(t){return Object(x.a)(Object(x.a)({},t),{},{datasetCheckbox:Object(x.a)(Object(x.a)({},y.datasetCheckbox),{},Object(j.a)({},e.target.name,e.target.checked))})}))}})),r.a.createElement(k.a,{item:!0,xs:0}),r.a.createElement(k.a,{item:!0,xs:12},r.a.createElement("p",{style:{textAlign:"center",marginTop:"30px"}},"Learn more about ",r.a.createElement("a",{href:"https://docs.pioreactor.com/user-guide/export-data",target:"_blank",rel:"noopener noreferrer"},"data exporting"),".")))))))}var J=function(e){return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(k.a,{container:!0,spacing:2},r.a.createElement(k.a,{item:!0,md:12,xs:12},r.a.createElement(q,null)))},V=a(66),Z=a(252),Q=a(730),X=a(754),ee=a(725),te=a(755),ae=a(642),ne=a(758),re=a(744),oe=a(764),ie=a(759),ce=a(735),le=a(760),se=a(165),ue=a(187),me=a.n(ue),de=a(242),pe=a.n(de),_e=a(82),fe=a.n(_e),he=a(140),ge=a.n(he),Ee=a(250),ve=a.n(Ee),be=a(303),ye=a.n(be),xe=a(249),Oe=a.n(xe),we=a(410),je=a.n(we),Ce=a(301),Se=a.n(Ce),ke=a(728),Pe=a(729),Me=a(753),Le=a(751),De=a(746),Te=a(761),Be=a(302),Ae=a.n(Be),Ie=a(763),Re=a(111),Ne=a(756),We=a(189),Ue=a.n(We),Fe=a(64),Ke=Object(M.a)((function(e){return{textFieldCompact:{marginTop:e.spacing(3),marginRight:e.spacing(2),marginBottom:e.spacing(0),width:"18ch"}}}));var ze=function(e){var t=Ke(),a=Object.assign.apply(Object,[{}].concat(Object(O.a)(e.fields.map((function(e){return Object(j.a)({},e.key,e.default)})))));Object(n.useEffect)((function(){e.updateParent(a)}),[e.fields]);var o=function(t){e.updateParent(Object(j.a)({},t.target.id,t.target.value))},i=e.fields.map((function(a){return r.a.createElement(re.a,{size:"small",autoComplete:"off",id:a.key,key:a.key+e.name,label:a.label,defaultValue:a.default,disabled:a.disabled,InputProps:{endAdornment:r.a.createElement(ie.a,{position:"end"},a.unit)},variant:"outlined",onChange:o,onKeyPress:function(e){"Enter"===e.key&&e.preventDefault()},className:t.textFieldCompact})}));return r.a.createElement("div",null,r.a.createElement("p",null," ",e.description," "),i)},Ge=Object(M.a)((function(e){return{formControl:{marginTop:e.spacing(2)},unitTitle:{fontSize:17,color:"rgba(0, 0, 0, 0.87)"},unitTitleDialog:{fontSize:20,color:"rgba(0, 0, 0, 0.87)"},suptitle:{fontSize:"13px",color:"rgba(0, 0, 0, 0.60)"}}})),He={temperature:"thermostat",dosing:"chemostat",led:"light_dark_cycle"};var Ye=function(e){var t,a=Ge(),o=e.automationType,i="led"===o?"LED":o,c=Object(n.useState)(He[o]),s=Object(p.a)(c,2),u=s[0],m=s[1],d=Object(n.useState)({skip_first_run:0}),f=Object(p.a)(d,2),h=f[0],v=f[1],b=Object(n.useState)(null),y=Object(p.a)(b,2),w=y[0],C=y[1],S=Object(n.useState)({}),k=Object(p.a)(S,2),P=k[0],M=k[1],T=Object(n.useState)(!1),I=Object(p.a)(T,2),U=I[0],F=I[1];Object(n.useEffect)((function(){fetch("/api/contrib/automations/"+o).then((function(e){if(e.ok)return e.json();throw new Error("Something went wrong")})).then((function(e){M(Object.assign.apply(Object,[{}].concat(Object(O.a)(e.map((function(e){return Object(j.a)({},e.automation_name,e)}))))))})).catch((function(e){}))}),[o]),Object(n.useEffect)((function(){var t;e.config["cluster.topology"]&&((t=e.config.remote&&e.config.remote.ws_url?new _.Client("ws://".concat(e.config.remote.ws_url,"/"),"webui_ButtonChangeDialog"+Math.floor(1e4*Math.random())):new _.Client("".concat(e.config["cluster.topology"].leader_address),9001,"webui_ButtonChangeDialog"+Math.floor(1e4*Math.random()))).connect({userName:"pioreactor",password:"raspberry",keepAliveInterval:900}),C(t))}),[e.config]);var K=function(){e.onFinished()};return r.a.createElement(r.a.Fragment,null,r.a.createElement(X.a,{open:e.open,onClose:K,"aria-labelledby":"form-dialog-title",PaperProps:{style:{height:"100%"}}},r.a.createElement(ee.a,null,r.a.createElement(N.a,{className:a.suptitle},r.a.createElement(Fe.a,{style:{verticalAlign:"middle",fontSize:"1.2em"}}),"$broadcast"===e.unit?r.a.createElement("b",null,"All active Pioreactors"):e.title||e.label?" ".concat(e.label," / ").concat(e.unit):"".concat(e.unit)),r.a.createElement(N.a,{className:a.unitTitleDialog},"Select ",i," automation"),r.a.createElement(Le.a,{"aria-label":"close",onClick:K,sx:{position:"absolute",right:8,top:8,color:function(e){return e.palette.grey[500]}},size:"large"},r.a.createElement(fe.a,null))),r.a.createElement(te.a,null,r.a.createElement(N.a,{variant:"body2",component:"span",gutterBottom:!0},r.a.createElement("span",{style:{textTransform:"capitalize"}},i)," automations control the ",i," in the Pioreactor's vial. Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.pioreactor.com/user-guide/"+i+"-automations"},i," automations"),"."),r.a.createElement("form",null,r.a.createElement(D.a,{component:"fieldset",className:a.formControl},r.a.createElement(L.a,{component:"legend"},"Automation"),r.a.createElement(W.a,{variant:"standard",value:u,onChange:function(t){m(t.target.value),v(Object(x.a)({},!e.no_skip_first_run&&{skip_first_run:h.skip_first_run}))},style:{maxWidth:"270px"}},Object.keys(P).map((function(e){return r.a.createElement(R.a,{id:e,value:e,key:"change-io"+e},P[e].display_name)}))),Object.keys(P).length>0&&r.a.createElement(ze,{fields:P[u].fields,description:P[u].description,updateParent:function(e){v((function(t){return Object(x.a)(Object(x.a)({},t),e)}))},name:u}),e.no_skip_first_run?r.a.createElement(r.a.Fragment,null):r.a.createElement("div",null,r.a.createElement(B.a,{control:r.a.createElement(A.a,{checked:Boolean(h.skip_first_run),color:"primary",onChange:function(e){v(Object(x.a)(Object(x.a)({},h),{},{skip_first_run:e.target.checked?1:0}))},size:"small"}),label:"Skip first run",style:{marginRight:"3px"}}),r.a.createElement(Le.a,{component:l.b,target:"_blank",rel:"noopener noreferrer",to:{pathname:"https://docs.pioreactor.com/user-guide/intro-to-automations#skip-first-run"}},r.a.createElement(Ue.a,{style:{fontSize:17,verticalAlign:"middle",marginLeft:"0px"}})))))),r.a.createElement(Ne.a,null,r.a.createElement(se.a,{type:"submit",variant:"contained",color:"primary",onClick:e.isJobRunning?function(t){t.preventDefault();var a=new _.Message(JSON.stringify({automation_name:u,type:o,args:h}));a.destinationName=["pioreactor",e.unit,e.experiment,"".concat(o,"_control"),"automation","set"].join("/"),a.qos=2;try{w.publish(a),F(!0)}catch(n){console.log(n)}K()}:function(t){t.preventDefault(),Object(g.c)(e.unit,"".concat(o,"_control"),[],Object(x.a)({automation_name:u},h)),F(!0),K()}},"Start"),r.a.createElement(se.a,{color:"secondary",onClick:K},"Cancel"))),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:U,onClose:function(){F(!1)},message:"Starting ".concat(i," automation ").concat(null===(t=P[u])||void 0===t?void 0:t.display_name,"."),autoHideDuration:7e3,key:"snackbar-change-"+o}))},$e=a(740),qe=a(727),Je=Object(M.a)({actionTextField:{padding:"0px 10px 0px 0px",width:"140px"},actionForm:{padding:"10px 0px 0px 0px"}}),Ve={remove_waste:"Removing waste",add_media:"Adding media",add_alt_media:"Adding alt. media"};function Ze(e){var t,a,o,i=Je(),c=Object(n.useState)(""),l=Object(p.a)(c,2),s=l[0],u=l[1],m=Object(n.useState)(""),d=Object(p.a)(m,2),_=d[0],f=d[1],h=Object(n.useState)(!1),v=Object(p.a)(h,2),b=v[0],y=v[1],x=Object(n.useState)(""),O=Object(p.a)(x,2),w=O[0],j=O[1],C=Object(n.useState)(!1),S=Object(p.a)(C,2),k=S[0],P=S[1],M=Object(n.useState)(!1),L=Object(p.a)(M,2),T=L[0],A=L[1],I=Object(n.useState)("volume"),R=Object(p.a)(I,2),N=R[0],W=R[1],U=Object(n.useState)(!1),K=Object(p.a)(U,2),z=K[0],G=K[1],H=Object(n.useState)(!1),Y=Object(p.a)(H,2),$=Y[0],q=Y[1];return r.a.createElement("div",{id:e.action,className:i.actionForm},r.a.createElement(D.a,null,r.a.createElement(qe.a,{"aria-labelledby":"how to dose",name:"how-to-dose-media",value:N,onChange:function(e){W(e.target.value)}},r.a.createElement("div",{style:{marginBottom:"10px",maxWidth:"260px",display:"flex",justifyContent:"space-between"}},r.a.createElement(B.a,{value:"volume",control:r.a.createElement($e.a,null),label:"Volume"}),r.a.createElement(re.a,{name:"mL",autoComplete:"off",error:$||k,value:s,size:"small",id:e.action+"_mL",variant:"outlined",onChange:function(e){P(!1),u(e.target.value),""===e.target.value||/^[0-9.\b]+$/.test(e.target.value)?q(!1):q(!0)},disabled:"volume"!==N,className:i.actionTextField,InputProps:{endAdornment:r.a.createElement(ie.a,{position:"end"},"mL")}})),r.a.createElement("div",{style:{marginBottom:"10px",maxWidth:"260px",display:"flex",justifyContent:"space-between"}},r.a.createElement(B.a,{value:"duration",control:r.a.createElement($e.a,null),label:"Duration"}),r.a.createElement(re.a,{name:"duration",autoComplete:"off",value:_,error:z||k,size:"small",id:e.action+"_duration",variant:"outlined",disabled:"duration"!==N,onChange:function(e){P(!1),f(e.target.value),""===e.target.value||/^[0-9.\b]+$/.test(e.target.value)?G(!1):G(!0)},className:i.actionTextField,InputProps:{endAdornment:r.a.createElement(ie.a,{position:"end"},"s")}})),r.a.createElement(B.a,{value:"continuously",control:r.a.createElement($e.a,null),label:"Run continuously"}))),r.a.createElement("div",{style:{display:"flex",marginTop:"5px"}},r.a.createElement(F.a,{loading:T&&"disconnected"===(null===e||void 0===e||null===(t=e.job)||void 0===t?void 0:t.state),disabled:$&&"volume"===N||z&&"duration"===N||"ready"===(null===e||void 0===e||null===(a=e.job)||void 0===a?void 0:a.state),type:"submit",variant:"contained",size:"small",color:"primary",onClick:function(t){if(t.preventDefault(),"continuously"===N||"volume"===N&&""!==s||"duration"===N&&""!==_){A(!0);var a={},n="";"volume"===N?(a={ml:parseFloat(s),source_of_event:"UI"},n=Ve[e.action]+" until "+s+"mL is reached."):"duration"===N?(a={duration:parseFloat(_),source_of_event:"UI"},n=Ve[e.action]+" for "+_+" seconds."):(a={continuously:!0,source_of_event:"UI"},n=Ve[e.action]+" continuously"),Object(g.c)(e.unit,e.action,[],a)(),j(n),y(!0),setTimeout((function(){return A(!1)}),2500)}else P(!0)},style:{marginRight:"3px"}},"Start"),r.a.createElement(se.a,{size:"small",color:"secondary",disabled:"ready"!==(null===e||void 0===e||null===(o=e.job)||void 0===o?void 0:o.state),onClick:function(t){fetch("/api/stop/".concat(e.unit,"/").concat(e.action),{method:"PATCH"}).catch((function(e){j("\ud83d\uded1 Failed to stop - please try again!"),y(!0)}))}},"Stop")),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:b,onClose:function(){y(!1)},message:w,autoHideDuration:7e3,key:"snackbar"+e.unit+e.action}))}var Qe=Object(M.a)({actionTextField:{padding:"0px 10px 0px 0px",width:"140px"},actionForm:{padding:"10px 0px 0px 0px"}}),Xe={remove_waste:"removing waste",add_media:"adding media",add_alt_media:"adding alt. media"};function et(e){var t=Qe(),a=Object(n.useState)(""),o=Object(p.a)(a,2),i=o[0],c=o[1],l=Object(n.useState)(!1),s=Object(p.a)(l,2),u=s[0],m=s[1],d=Object(n.useState)(""),_=Object(p.a)(d,2),f=_[0],h=_[1],v=Object(n.useState)(!1),b=Object(p.a)(v,2),y=b[0],x=b[1],O=Object(n.useState)("add_media"),w=Object(p.a)(O,2),j=w[0],C=w[1],k=Object(n.useState)(!1),P=Object(p.a)(k,2),M=P[0],L=P[1];function T(e){x(!1),c(e.target.value),""===e.target.value||/^[0-9.\b]+$/.test(e.target.value)?L(!1):L(!0)}return r.a.createElement("div",{id:e.action,className:t.actionForm},r.a.createElement(D.a,null,r.a.createElement(qe.a,{"aria-labelledby":"what action",name:"what action",value:j,onChange:function(e){C(e.target.value),c("")}},r.a.createElement("div",{style:{marginBottom:"10px",maxWidth:"460px",display:"flex",justifyContent:"space-between"}},r.a.createElement(B.a,{value:"add_media",control:r.a.createElement($e.a,null),label:"Add media"}),r.a.createElement(re.a,{name:"mL",autoComplete:"off",error:M||y,value:"add_media"===j?i:"",size:"small",variant:"outlined",onChange:T,disabled:"add_media"!==j,className:t.actionTextField,InputProps:{endAdornment:r.a.createElement(ie.a,{position:"end"},"mL")}})),r.a.createElement("div",{style:{marginBottom:"10px",maxWidth:"460px",display:"flex",justifyContent:"space-between"}},r.a.createElement(B.a,{value:"add_alt_media",control:r.a.createElement($e.a,null),label:"Add alt-media"}),r.a.createElement(re.a,{name:"mL",autoComplete:"off",error:M||y,value:"add_alt_media"===j?i:"",size:"small",variant:"outlined",onChange:T,disabled:"add_alt_media"!==j,className:t.actionTextField,InputProps:{endAdornment:r.a.createElement(ie.a,{position:"end"},"mL")}})),r.a.createElement("div",{style:{marginBottom:"10px",maxWidth:"460px",display:"flex",justifyContent:"space-between"}},r.a.createElement(B.a,{value:"remove_waste",control:r.a.createElement($e.a,null),label:"Remove waste"}),r.a.createElement(re.a,{name:"mL",autoComplete:"off",error:M||y,value:"remove_waste"===j?i:"",size:"small",variant:"outlined",onChange:T,disabled:"remove_waste"!==j,className:t.actionTextField,InputProps:{endAdornment:r.a.createElement(ie.a,{position:"end"},"mL")}})))),r.a.createElement("div",{style:{display:"flex",marginTop:"5px"}},r.a.createElement(se.a,{type:"submit",variant:"contained",size:"small",color:"primary",onClick:function(t){if(t.preventDefault(),i>0){var a="Recorded ".concat(Xe[j]," of ").concat(i," mL at ").concat(S()().format("h:mm:ss a"),"."),n={ml:parseFloat(i),source_of_event:"manually",manually:!0};Object(g.c)(e.unit,j,[],n),h(a),m(!0),c("")}else x(!0)},disabled:M,style:{marginRight:"3px"}},"Adjust")),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:u,onClose:function(){m(!1)},message:f,autoHideDuration:7e3,key:"snackbar"+e.unit}))}var tt=Object(M.a)({actionTextField:{padding:"0px 10px 0px 0px",width:"140px"},actionForm:{padding:"10px 0px 0px 0px"}}),at={circulate_media:"Circulating media",circulate_alt_media:"Circulating alt. media"};function nt(e){var t,a,o,i=tt(),c=Object(n.useState)(""),l=Object(p.a)(c,2),s=l[0],u=l[1],m=Object(n.useState)(!1),d=Object(p.a)(m,2),_=d[0],f=d[1],h=Object(n.useState)(""),v=Object(p.a)(h,2),b=v[0],y=v[1],x=Object(n.useState)(!1),O=Object(p.a)(x,2),w=O[0],j=O[1],C=Object(n.useState)(!1),S=Object(p.a)(C,2),k=S[0],P=S[1],M=Object(n.useState)(!1),L=Object(p.a)(M,2),T=L[0],B=L[1];return r.a.createElement("div",{id:e.action,className:i.actionForm},r.a.createElement(D.a,null,r.a.createElement("div",{style:{marginBottom:"10px",maxWidth:"260px",display:"flex",justifyContent:"space-between"}},r.a.createElement(re.a,{name:"duration",autoComplete:"off",value:s,error:T||w,size:"small",id:e.action+"_duration",variant:"outlined",disabled:!1,onChange:function(e){j(!1),u(e.target.value),""===e.target.value||/^[0-9.\b]+$/.test(e.target.value)?B(!1):B(!0)},className:i.actionTextField,InputProps:{endAdornment:r.a.createElement(ie.a,{position:"end"},"s")}}))),r.a.createElement("br",null),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(F.a,{loading:k&&"disconnected"===(null===e||void 0===e||null===(t=e.job)||void 0===t?void 0:t.state),disabled:T||"ready"===(null===e||void 0===e||null===(a=e.job)||void 0===a?void 0:a.state),type:"submit",variant:"contained",size:"small",color:"primary",onClick:function(t){if(t.preventDefault(),""!==s){P(!0);var a={duration:parseFloat(s),source_of_event:"UI"},n=at[e.action]+" for "+s+" seconds.";Object(g.c)(e.unit,e.action,[],a),y(n),f(!0),setTimeout((function(){return P(!1)}),2500)}else j(!0)},style:{marginRight:"3px"}},"Start"),r.a.createElement(se.a,{size:"small",color:"secondary",disabled:"ready"!==(null===e||void 0===e||null===(o=e.job)||void 0===o?void 0:o.state),onClick:function(t){fetch("/api/stop/".concat(e.unit,"/").concat(e.action),{method:"PATCH"}).catch((function(e){y("\ud83d\uded1 Failed to stop - please try again!"),f(!0)}))}},"Stop")),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:_,onClose:function(){f(!1)},message:b,autoHideDuration:7e3,key:"snackbar"+e.unit+e.action}))}var rt=Object(M.a)({actionTextField:{padding:"0px 0px 0px 0px",width:"150px"},actionForm:{padding:"10px 0px 0px 0px"}});function ot(e){var t=/^[0-9.\b]+$/,a=rt(),o=Object(n.useState)(!1),i=Object(p.a)(o,2),c=i[0],l=i[1],s=Object(n.useState)(""),u=Object(p.a)(s,2),m=u[0],d=u[1],_=Object(n.useState)(!1),f=Object(p.a)(_,2),h=f[0],v=f[1],b=function(e){return!!(""!==e&&t.test(e)&&parseFloat(e)>=0&&parseFloat(e)<=100)};function y(t){if(b(m)){var a;v(!1),l(!0);var n=(a={},Object(j.a)(a,e.channel,parseFloat(m)),Object(j.a)(a,"source_of_event","UI"),a);Object(g.c)(e.unit,"led_intensity",[],n)()}else v(""!==m)}return r.a.createElement("form",{id:e.action,className:a.actionForm},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(re.a,{size:"small",error:h,name:"intensity",autoComplete:"off",value:m,id:e.channel+"_intensity_edit",label:"new intensity",variant:"outlined",onChange:function(e){var t=e.target.value;d(t),b(t)?v(!1):v(""!==t)},onKeyPress:function(e){"Enter"===e.key&&e.target.value&&(e.preventDefault(),y())},InputProps:{endAdornment:r.a.createElement(ie.a,{position:"end"},"%")},className:a.actionTextField}),r.a.createElement(se.a,{size:"small",color:"primary",onClick:y,disabled:!b(m),style:{marginLeft:"7px"}},"Update")),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:c,onClose:function(e,t){"clickaway"!==t&&l(!1)},message:"Updating channel ".concat(e.channel," to ").concat(m,"%."),autoHideDuration:7e3,key:"snackbar"+e.unit+e.channel}))}function it(e){var t=e.title;return r.a.createElement("span",{className:Object(P.a)({underlineSpan:!!t}),title:t},e.children)}var ct=["children","value","index"],lt=Object(M.a)((function(e){return{lostRed:{color:"#DE3618"},readyGreen:{color:"#4caf50"},textIcon:{verticalAlign:"middle",margin:"0px 3px"},pioreactorCard:{marginTop:"0px",marginBottom:"20px"},cardContent:{padding:"10px 20px 20px 20px"},code:{backgroundColor:"rgba(0, 0, 0, 0.07)",padding:"1px 4px"},unitTitle:{fontSize:20,color:"rgba(0, 0, 0, 0.87)",fontWeight:500},suptitle:{fontSize:"13px",color:"rgba(0, 0, 0, 0.60)"},disabledText:{color:"rgba(0, 0, 0, 0.38)"},textbox:{width:"130px",marginTop:"10px"},textboxLabel:{width:"100px",marginTop:"10px",marginRight:"5px"},footnote:{marginBottom:0,fontSize:12},textField:{marginTop:"15px",maxWidth:"180px"},textFieldWide:{marginTop:"15px",maxWidth:"220px"},textFieldCompact:{marginTop:"15px",width:"120px"},slider:{width:"70%",margin:"40px auto 0px auto"},divider:{marginTop:15,marginBottom:10},jobButton:{paddingRight:"15px",paddingLeft:"15px"},unitSettingsSubtext:{fontSize:"11px",wordBreak:"break-word"},unitSettingsSubtextEmpty:{minHeight:"15px"},ledBlock:{width:"55px",display:"inline-block"},rowOfUnitSettingDisplay:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"stretch",alignContent:"stretch"},testingListItemIcon:{minWidth:"30px"},testingListItem:{paddingTop:"0px",paddingBottom:"0px"},headerMenu:Object(j.a)({display:"flex",justifyContent:"space-between",marginBottom:"5px"},e.breakpoints.down("lg"),{flexFlow:"nowrap",flexDirection:"column"}),cardHeaderSettings:Object(j.a)({display:"flex",justifyContent:"space-between"},e.breakpoints.down("md"),{flexFlow:"nowrap",flexDirection:"column"}),cardHeaderButtons:Object(j.a)({display:"flex",justifyContent:"flex-end",flexDirection:"row",flexWrap:"wrap"},e.breakpoints.down("md"),{justifyContent:"space-between"}),headerButtons:{display:"flex",flexDirection:"row",justifyContent:"flex-start",flexFlow:"wrap"},patientButton:{width:"70px",marginTop:"5px",height:"31px",marginRight:"3px"}}}));function st(e){return"True"===e||"False"!==e&&null}function ut(e){var t=e.children,a=e.value,n=e.index,o=Object(Z.a)(e,ct);return r.a.createElement("div",Object.assign({role:"tabpanel",hidden:a!==n,id:"simple-tabpanel-".concat(n),key:"simple-tabpanel-".concat(n),"aria-labelledby":"simple-tab-".concat(n)},o),a===n&&r.a.createElement("div",null,t))}function mt(e){var t=lt();return e.subtext?r.a.createElement("div",{className:t.unitSettingsSubtext},r.a.createElement("code",null,e.subtext)):r.a.createElement("div",{className:t.unitSettingsSubtextEmpty})}function dt(e){var t=lt(),a={init:{display:"Starting",color:"#4caf50"},ready:{display:"On",color:"#4caf50"},sleeping:{display:"Paused",color:"grey"},disconnected:{display:"Off",color:"grey"},lost:{display:"Lost",color:"#DE3618"},NA:{display:"Not available",color:"grey"}},n=null===e.value?"":e.value;function o(e){return e>=10?e.toFixed(0):0===e?"0":e<1?"<1":e.toFixed(1).replace(/[.,]0$/,"")}if(e.isStateSetting){if(e.isUnitActive){var i=a[n];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{color:i.color,fontWeight:500}},i.display),r.a.createElement(mt,{subtext:e.subtext}))}return r.a.createElement("div",{className:Object(P.a)(Object(j.a)({},t.disabledText,!e.isUnitActive))}," ",a[n].display," ")}if(e.isLEDIntensity){if(e.isUnitActive&&"\u2014"!==n&&""!==n){var c=JSON.parse(n),l=e.config.leds,s=l.A?l.A.replace("_"," "):null,u=l.B?l.B.replace("_"," "):null,m=l.C?l.C.replace("_"," "):null,d=l.D?l.D.replace("_"," "):null;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{fontSize:"13px"}},r.a.createElement("div",null,r.a.createElement("span",{className:t.ledBlock},r.a.createElement(it,{title:s||null},"A"),": ",o(c.A),"%"),r.a.createElement("span",{className:t.ledBlock},r.a.createElement(it,{title:u||null},"B"),": ",o(c.B),"%")),r.a.createElement("div",null,r.a.createElement("span",{className:t.ledBlock},r.a.createElement(it,{title:m||null},"C"),": ",o(c.C),"%"),r.a.createElement("span",{className:t.ledBlock},r.a.createElement(it,{title:d||null},"D"),": ",o(c.D),"%"))),r.a.createElement(mt,{subtext:e.subtext}))}return r.a.createElement("div",{style:{color:"grey",fontSize:"13px"}}," ",e.default," ")}if(e.isPWMDc){if(e.isUnitActive&&"\u2014"!==n&&""!==n){var p=JSON.parse(n),_={1:"17",2:"13",3:"16",4:"12"},f=e.config.PWM,h=f[1]?f[1].replace("_"," "):null,g=f[2]?f[2].replace("_"," "):null,E=f[3]?f[3].replace("_"," "):null,v=f[4]?f[4].replace("_"," "):null;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{fontSize:"13px"}},r.a.createElement("div",null,r.a.createElement("span",{className:t.ledBlock},r.a.createElement(it,{title:h||null},"1"),": ",o(p[_[1]]||0),"%"),r.a.createElement("span",{className:t.ledBlock},r.a.createElement(it,{title:g||null},"2"),": ",o(p[_[2]]||0),"%")),r.a.createElement("div",null,r.a.createElement("span",{className:t.ledBlock},r.a.createElement(it,{title:E||null},"3"),": ",o(p[_[3]]||0),"%"),r.a.createElement("span",{className:t.ledBlock},r.a.createElement(it,{title:v||null},"4"),": ",o(p[_[4]]||0),"%"))),r.a.createElement(mt,{subtext:e.subtext}))}return r.a.createElement("div",{style:{color:"grey",fontSize:"13px"}}," ",e.default," ")}return e.isUnitActive&&"\u2014"!==n&&""!==n?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{fontSize:"13px"}},function(t){return"string"===typeof t?t:"boolean"===typeof t?t?"On":"Off":+t.toFixed(e.precision)}(n)+" "+(e.measurementUnit?e.measurementUnit:"")),r.a.createElement(mt,{subtext:e.subtext})):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{color:"grey",fontSize:"13px"}}," ",e.default," "),r.a.createElement(mt,{subtext:e.subtext}))}function pt(){var e=lt(),t=Object(Re.b)();return r.a.createElement(se.a,{style:{textTransform:"none",float:"right"},color:"secondary",onClick:function(){t({description:"This will immediately halt all activities (stirring, dosing, etc.) in all Pioreactor units. You can manually start them again later. Do you wish to continue?",title:"Stop all activities?",confirmationText:"Confirm",confirmationButtonProps:{color:"primary"},cancellationButtonProps:{color:"secondary"}}).then((function(){return fetch("/api/stop_all",{method:"POST"})}))}},r.a.createElement(pe.a,{fontSize:"15",classes:{root:e.textIcon}})," Stop all activity")}function _t(e){var t=lt(),a=Object(n.useState)(!1),o=Object(p.a)(a,2),i=o[0],c=o[1],l=r.a.useState(""),s=Object(p.a)(l,2),u=s[0],m=s[1],d=r.a.useState(!1),_=Object(p.a)(d,2),f=_[0],h=_[1],g=r.a.useState(""),E=Object(p.a)(g,2),v=E[0],b=E[1],y=r.a.useState(!1),x=Object(p.a)(y,2),O=x[0],w=x[1],j=r.a.useState(""),C=Object(p.a)(j,2),S=C[0],k=C[1],M=r.a.useState(!1),L=Object(p.a)(M,2),D=L[0],T=L[1],B=r.a.useState(""),A=Object(p.a)(B,2),I=A[0],R=A[1],N=function(){c(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(se.a,{onClick:function(){c(!0)},style:{textTransform:"none",float:"right",marginRight:"0px"},color:"primary"},r.a.createElement(me.a,{fontSize:"15",classes:{root:t.textIcon}})," Add new Pioreactor"),r.a.createElement(X.a,{open:i,onClose:N,"aria-labelledby":"form-dialog-title"},r.a.createElement(ee.a,null,"Add a Pioreactor worker to your current cluster",r.a.createElement(Le.a,{"aria-label":"close",onClick:N,sx:{position:"absolute",right:8,top:8,color:function(e){return e.palette.grey[500]}},size:"large"},r.a.createElement(fe.a,null))),r.a.createElement(te.a,null,r.a.createElement("p",null,"Follow the instructions at ",r.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:"https://docs.pioreactor.com/user-guide/software-set-up#adding-additional-workers-to-your-cluster"},"set up your new Pioreactor's Raspberry Pi"),"."),r.a.createElement("p",null,"After",r.a.createElement("ol",null,r.a.createElement("li",null," image installation is complete and,"),r.a.createElement("li",null," the new Pioreactor worker is powered on, ")),"provide the hostname you used when installing the Pioreactor image onto the Raspberry Pi. Your existing Pioreactor will automatically connect the new Pioreactor to the cluster. When finished, the new Pioreactor will show up on this page (after a refresh)."),r.a.createElement("div",null,r.a.createElement(re.a,{size:"small",id:"new-pioreactor-name",label:"Hostname",variant:"outlined",className:t.textField,onChange:function(e){m(e.target.value)},value:u,InputProps:{startAdornment:r.a.createElement(ie.a,{position:"start"},r.a.createElement(Fe.a,{style:{fontSize:"1.1em"}})),endAdornment:r.a.createElement(ie.a,{position:"end"},".local")}})),r.a.createElement("div",{style:{minHeight:"60px",alignItems:"center",display:"flex"}},f?r.a.createElement("p",null,r.a.createElement(fe.a,{className:Object(P.a)(t.textIcon,t.lostRed)}),v):r.a.createElement(r.a.Fragment,null),D?r.a.createElement("p",null,I):r.a.createElement(r.a.Fragment,null),O?r.a.createElement("p",null,r.a.createElement(ge.a,{className:Object(P.a)(t.textIcon,t.readyGreen)}),S):r.a.createElement(r.a.Fragment,null)),r.a.createElement(F.a,{variant:"contained",color:"primary",style:{marginTop:"10px"},onClick:function(e){if(e.preventDefault(),!u)return h(!0),void b("Provide the hostname for the new Pioreactor worker");h(!1),w(!1),T(!0),R("Setting up new Pioreactor..."),fetch("/api/setup_worker_pioreactor",{method:"POST",body:JSON.stringify({newPioreactorName:u}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){T(!1),R(""),e.ok?(w(!0),k("Success! Rebooting ".concat(u," now. Refresh to see ").concat(u," in your cluster."))):(h(!0),e.json().then((function(e){return b("Unable to complete installation. The following error occurred: ".concat(e.msg))})))}))},type:"submit",loading:D,endIcon:r.a.createElement(me.a,null)},"Add Pioreactor"))))}function ft(e){var t=lt();return r.a.createElement("div",null,r.a.createElement("div",{className:t.headerMenu},r.a.createElement(N.a,{variant:"h5",component:"h1"},r.a.createElement(U.a,{fontWeight:"fontWeightBold"},"Pioreactors")),r.a.createElement("div",{className:t.headerButtons},r.a.createElement(pt,null),r.a.createElement(_t,{config:e.config}),r.a.createElement(bt,{config:e.config,experiment:e.experiment}))),r.a.createElement(ae.a,null))}function ht(e){var t=lt(),a=Object(n.useState)(e.buttonText),o=Object(p.a)(a,2),i=o[0],c=o[1];Object(n.useEffect)((function(){c(e.buttonText)}),[e.buttonText]);return r.a.createElement(se.a,{disableElevation:!0,className:t.patientButton,color:e.color,variant:e.variant,disabled:e.disabled,size:"small",onClick:function(){c(r.a.createElement(ne.a,{color:"inherit",size:21})),e.onClick(),setTimeout((function(){return c(e.buttonText)}),3e4)}},i)}function gt(e){var t=lt(),a=Object(n.useState)(!1),o=Object(p.a)(a,2),i=o[0],c=o[1],l=r.a.useState(0),s=Object(p.a)(l,2),u=s[0],m=s[1],d=function(){c(!1),setTimeout((function(){return m(0)}),200)};function _(t,a){switch(t){case"disconnected":return r.a.createElement("div",null,r.a.createElement(ht,{color:"primary",variant:"contained",onClick:function(){return Object(g.c)(e.unit,a)},buttonText:"Start"}));case"ready":return r.a.createElement("div",null,r.a.createElement(ht,{color:"primary",variant:"contained",buttonText:"Running",disabled:!0}));default:return r.a.createElement("div",null)}}var f=_(e.odBlankJobState,"od_blank"),h=_(e.stirringCalibrationState,"stirring_calibration");return r.a.createElement(r.a.Fragment,null,r.a.createElement(se.a,{style:{textTransform:"none",float:"right"},color:"primary",disabled:e.disabled,onClick:function(){c(!0)}},r.a.createElement(Oe.a,{color:e.disabled?"disabled":"primary",fontSize:"15",classes:{root:t.textIcon}})," Calibrate"),r.a.createElement(X.a,{open:i,onClose:d,"aria-labelledby":"form-dialog-title"},r.a.createElement(ee.a,null,r.a.createElement(N.a,{className:t.suptitle},r.a.createElement(Fe.a,{style:{verticalAlign:"middle",fontSize:"1.2em"}})," ",e.label?"".concat(e.label," / ").concat(e.unit):"".concat(e.unit)),r.a.createElement(ce.a,{value:u,onChange:function(e,t){m(t)},indicatorColor:"primary",textColor:"primary"},r.a.createElement(le.a,{label:"Blanks"}),r.a.createElement(le.a,{label:"Stirring"}),r.a.createElement(le.a,{label:"Dosing"}),r.a.createElement(le.a,{label:"OD600"})),r.a.createElement(Le.a,{"aria-label":"close",onClick:d,sx:{position:"absolute",right:8,top:8,color:function(e){return e.palette.grey[500]}},size:"large"},r.a.createElement(fe.a,null))),r.a.createElement(te.a,null,r.a.createElement(ut,{value:u,index:0},r.a.createElement(N.a,{gutterBottom:!0},"Record optical densities of blank (optional)"),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"For more accurate growth rate and biomass inferences, the Pioreactor can subtract out the media's un-inoculated optical density ",r.a.createElement("i",null,"per experiment"),". Read more about ",r.a.createElement("a",{href:"https://docs.pioreactor.com/user-guide/od-normal-growth-rate#blanking"},"using blanks"),"."),r.a.createElement(N.a,{variant:"body2",component:"p",style:{margin:"20px 0px"}},"Recorded optical densities of blank vial: ",r.a.createElement("code",null,e.odBlankReading?Object.entries(JSON.parse(e.odBlankReading)).map((function(e){var t=Object(p.a)(e,2),a=t[0],n=t[1];return"".concat(a,":").concat(n.toFixed(5))})).join(", "):"\u2014")),r.a.createElement("div",{style:{display:"flex"}},f,r.a.createElement("div",null,r.a.createElement(se.a,{size:"small",className:t.patientButton,color:"secondary",disabled:null===e.odBlankReading,onClick:function(){return Object(g.c)(e.unit,"od_blank",["delete"])}}," Clear "))),r.a.createElement(ae.a,{className:t.divider})),r.a.createElement(ut,{value:u,index:1},r.a.createElement(N.a,{gutterBottom:!0},"Stirring calibration (optional)"),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"You can improve the responsiveness of stirring RPM changes by running this calibration. This calibration is optional, and stirring RPM changes can still occur without running this calibration. Only needs to be performed once - results are saved to disk."),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"Add a vial, with a stirbar and ~15ml of liquid, to the Pioreactor, then hit Start below. This calibration will take less than five minutes."),h,r.a.createElement(ae.a,{className:t.divider})),r.a.createElement(ut,{value:u,index:2},r.a.createElement(N.a,{gutterBottom:!0},"Dosing calibration for pumps"),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"To use a peristatlic pump with your Pioreactor, you'll need to calibrate it to accuractly dose specific volumes."),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"See instructions ",r.a.createElement("a",{href:"https://docs.pioreactor.com/user-guide/hardware-calibrations#pump-calibration"},"here"),"."),r.a.createElement(ae.a,{className:t.divider})),r.a.createElement(ut,{value:u,index:3},r.a.createElement(N.a,{gutterBottom:!0},"OD600 Calibration (optional)"),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"By performing the following calibration, you can relate Pioreactor's internal OD readings (measured in volts) to an offline OD600 value. The UI and datasets will be measured in your OD600 values instead of voltages."),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"See instructions ",r.a.createElement("a",{href:"https://docs.pioreactor.com/user-guide/calibrate-od600"},"here"),"."),r.a.createElement(ae.a,{className:t.divider})))))}function Et(e){var t=lt(),a=Object(n.useState)(!1),o=Object(p.a)(a,2),i=o[0],c=o[1],l=function(){c(!1)};function s(a,n){return null==e.selfTestTests?r.a.createElement(Se.a,null):1===e.selfTestTests.publishedSettings[a].value?r.a.createElement(ge.a,{className:t.readyGreen}):0===e.selfTestTests.publishedSettings[a].value?r.a.createElement(fe.a,{className:t.lostRed}):"ready"===n?r.a.createElement(ne.a,{size:20}):r.a.createElement(Se.a,null)}function u(){return e.disabled?"disabled":"primary"}var m=function(t,a){switch(t){case"disconnected":return r.a.createElement("div",{key:"disconnected_"+a},r.a.createElement(ht,{color:"primary",variant:"contained",onClick:function(){return Object(g.c)(e.unit,a)},buttonText:"Start"}));case"ready":return r.a.createElement("div",{key:"ready_"+a},r.a.createElement(ht,{color:"primary",variant:"contained",disabled:!0,buttonText:"Running"}));default:return r.a.createElement("div",null)}}(e.selfTestState,"self_test");return r.a.createElement(r.a.Fragment,null,r.a.createElement(se.a,{style:{textTransform:"none",float:"right"},color:"primary",disabled:e.disabled,onClick:function(){c(!0)}},null==e.selfTestTests?r.a.createElement(Ae.a,{color:u(),fontSize:"15",classes:{root:t.textIcon}}):e.selfTestTests.publishedSettings.all_tests_passed.value?r.a.createElement(je.a,{color:u(),fontSize:"15",classes:{root:t.textIcon}}):r.a.createElement(Ae.a,{color:u(),fontSize:"15",classes:{root:t.textIcon}})," Self test"),r.a.createElement(X.a,{open:i,onClose:l},r.a.createElement(ee.a,null,r.a.createElement(N.a,{className:t.suptitle,gutterBottom:!0},r.a.createElement(Fe.a,{style:{verticalAlign:"middle",fontSize:"1.2em"}})," ",e.label?"".concat(e.label," / ").concat(e.unit):"".concat(e.unit)),"Self test",r.a.createElement(Le.a,{"aria-label":"close",onClick:l,sx:{position:"absolute",right:8,top:8,color:function(e){return e.palette.grey[500]}},size:"large"},r.a.createElement(fe.a,null))),r.a.createElement(te.a,null,r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"Perform a check of the heating & temperature sensor, LEDs & photodiodes, and stirring."),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"Add a closed vial with water and stirbar into the Pioreactor."),m,r.a.createElement(ae.a,{className:t.divider}),r.a.createElement(Me.a,{component:"nav",subheader:r.a.createElement(Te.a,{style:{lineHeight:"20px"},component:"div",disableSticky:!0,disableGutters:!0},"LEDs & photodiodes")},r.a.createElement(De.a,{className:t.testingListItem},r.a.createElement(ke.a,{className:t.testingListItemIcon},s("test_pioreactor_HAT_present",e.selfTestState)),r.a.createElement(Pe.a,{primary:"Pioreactor HAT is detected"})),r.a.createElement(De.a,{className:t.testingListItem},r.a.createElement(ke.a,{className:t.testingListItemIcon},s("test_all_positive_correlations_between_pds_and_leds",e.selfTestState)),r.a.createElement(Pe.a,{primary:"Photodiodes are responsive to IR LED",secondary:e.selfTestTests?JSON.parse(e.selfTestTests.publishedSettings.correlations_between_pds_and_leds.value).map((function(e){return"".concat(e[0]," \u21dd ").concat(e[1])})).join(",  "):""})),r.a.createElement(De.a,{className:t.testingListItem},r.a.createElement(ke.a,{className:t.testingListItemIcon},s("test_ambient_light_interference",e.selfTestState)),r.a.createElement(Pe.a,{primary:"No ambient IR light detected"})),r.a.createElement(De.a,{className:t.testingListItem},r.a.createElement(ke.a,{className:t.testingListItemIcon},s("test_REF_is_lower_than_0_dot_256_volts",e.selfTestState)),r.a.createElement(Pe.a,{primary:"Reference photodiode is correct magnitude"})),r.a.createElement(De.a,{className:t.testingListItem},r.a.createElement(ke.a,{className:t.testingListItemIcon},s("test_REF_is_in_correct_position",e.selfTestState)),r.a.createElement(Pe.a,{primary:"Reference photodiode is in correct position"})),r.a.createElement(De.a,{className:t.testingListItem},r.a.createElement(ke.a,{className:t.testingListItemIcon},s("test_PD_is_near_0_volts_for_blank",e.selfTestState)),r.a.createElement(Pe.a,{primary:"Photodiode measures near nil signal for aturbid water"}))),r.a.createElement(Me.a,{component:"nav",subheader:r.a.createElement(Te.a,{style:{lineHeight:"20px"},component:"div",disableSticky:!0,disableGutters:!0},"Heating & temperature")},r.a.createElement(De.a,{className:t.testingListItem},r.a.createElement(ke.a,{className:t.testingListItemIcon},s("test_detect_heating_pcb",e.selfTestState)),r.a.createElement(Pe.a,{primary:"Heating PCB is detected"})),r.a.createElement(De.a,{className:t.testingListItem},r.a.createElement(ke.a,{className:t.testingListItemIcon},s("test_positive_correlation_between_temperature_and_heating",e.selfTestState)),r.a.createElement(Pe.a,{primary:"Heating is responsive"}))),r.a.createElement(Me.a,{component:"nav",subheader:r.a.createElement(Te.a,{style:{lineHeight:"20px"},component:"div",disableSticky:!0,disableGutters:!0},"Stirring")},r.a.createElement(De.a,{className:t.testingListItem},r.a.createElement(ke.a,{className:t.testingListItemIcon},s("test_positive_correlation_between_rpm_and_stirring",e.selfTestState)),r.a.createElement(Pe.a,{primary:"Stirring RPM is responsive"})),r.a.createElement(De.a,{className:t.testingListItem},r.a.createElement(ke.a,{className:t.testingListItemIcon},s("test_aux_power_is_not_too_high",e.selfTestState)),r.a.createElement(Pe.a,{primary:"AUX power supply is appropriate value"}))),r.a.createElement(ae.a,{className:t.divider}),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"Learn more about self tests and ",r.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:"https://docs.pioreactor.com/user-guide/running-self-test#explanation-of-each-test"},"what to do if a test fails.")))))}function vt(e){var t=lt(),a=Object(n.useState)(!1),o=Object(p.a)(a,2),i=o[0],c=o[1],l=Object(n.useState)(!1),s=Object(p.a)(l,2),u=s[0],m=s[1],d=Object(n.useState)(""),h=Object(p.a)(d,2),v=h[0],b=h[1],y=r.a.useState(0),x=Object(p.a)(y,2),O=x[0],w=x[1],j=r.a.useState(!1),C=Object(p.a)(j,2),k=C[0],M=C[1],L=r.a.useState(!1),D=Object(p.a)(L,2),T=D[0],B=D[1],A=r.a.useState(!1),I=Object(p.a)(A,2),R=I[0],W=I[1],U=r.a.useState(!1),K=Object(p.a)(U,2),z=K[0],G=K[1];function H(e,t){return function(){$("".concat(e,"/$state"),t)}}function Y(e){return function(){$("".concat(e,"/$state"),"disconnected")}}function $(t,a){var n=new _.Message(String(a));n.destinationName=["pioreactor",e.unit,e.experiment,t,"set"].join("/"),n.qos=1;try{e.client.publish(n)}catch(r){console.log(r),e.client.connect({userName:"pioreactor",password:"raspberry",keepAliveInterval:900,onSuccess:function(){return $(t,a)}})}}var q=function(){c(!1),setTimeout((function(){return w(0)}),200)};function J(t,a){switch(t){case"lost":return r.a.createElement("div",{key:"patient_buttons_lost"+a},r.a.createElement(ht,{color:"primary",variant:"contained",onClick:function(){return Object(g.c)(e.unit,a)},buttonText:"Start"}));case"disconnected":return r.a.createElement("div",{key:"patient_buttons_disconnected"+a},r.a.createElement(ht,{color:"primary",variant:"contained",onClick:function(){return Object(g.c)(e.unit,a)},buttonText:"Start"}),r.a.createElement(ht,{color:"secondary",disabled:!0,buttonText:"Stop"}));case"init":return r.a.createElement("div",{key:"patient_buttons_init"+a},r.a.createElement(ht,{color:"primary",variant:"contained",onClick:function(){return!1},buttonText:r.a.createElement(ne.a,{color:"inherit",size:22}),disabled:!0}),r.a.createElement(ht,{color:"secondary",onClick:Y(a),buttonText:"Stop"}));case"ready":return r.a.createElement("div",{key:"patient_buttons_ready"+a},r.a.createElement(ht,{color:"secondary",variant:"contained",onClick:H(a,"sleeping"),buttonText:"Pause"}),r.a.createElement(ht,{color:"secondary",onClick:Y(a),buttonText:"Stop"}));case"sleeping":return r.a.createElement("div",{key:"patient_buttons_sleeping"+a},r.a.createElement(ht,{color:"primary",variant:"contained",onClick:H(a,"ready"),buttonText:"Resume"}),r.a.createElement(ht,{color:"secondary",onClick:Y(a),buttonText:"Stop"}));default:return r.a.createElement("div",{key:"patient_buttons_empty"+a})}}var V=e.config.leds,Z=Object.fromEntries(Object.entries(e.jobs).map((function(e,t){var a=Object(p.a)(e,2),n=a[0];return[n,J(a[1].state,n)]}))),re=JSON.parse(e.jobs.monitor.publishedSettings.versions.value||"{}"),oe=JSON.parse(e.jobs.monitor.publishedSettings.voltage_on_pwm_rail.value||"{}"),ie=e.jobs.monitor.publishedSettings.ipv4.value,ue={init:{display:"Starting",color:"#4caf50"},ready:{display:"On",color:"#4caf50"},sleeping:{display:"Paused",color:"grey"},disconnected:{display:"Off",color:"grey"},lost:{display:"Lost",color:"#DE3618"},NA:{display:"Not available",color:"grey"}},me=Object(Q.a)((function(e){return e.breakpoints.down("xl")})),de=e.jobs.dosing_control,pe=["ready","sleeping","init"].includes(null===de||void 0===de?void 0:de.state),_e=e.jobs.led_control,he=["ready","sleeping","init"].includes(null===_e||void 0===_e?void 0:_e.state),ge=e.jobs.temperature_control,Ee=["ready","sleeping","init"].includes(null===ge||void 0===ge?void 0:ge.state);return r.a.createElement("div",null,r.a.createElement(se.a,{style:{textTransform:"none",float:"right"},disabled:e.disabled,onClick:function(){c(!0)},color:"primary"},r.a.createElement(ye.a,{color:e.disabled?"disabled":"primary",fontSize:"15",classes:{root:t.textIcon}})," Manage"),r.a.createElement(X.a,{maxWidth:me?"sm":"md",fullWidth:!0,open:i,onClose:q,PaperProps:{sx:{height:"calc(100% - 64px)"}}},r.a.createElement(ee.a,null,r.a.createElement(N.a,{className:t.suptitle},r.a.createElement(Fe.a,{style:{verticalAlign:"middle",fontSize:"1.2em"}}),r.a.createElement("span",null," ",e.label?"".concat(e.label," / ").concat(e.unit):"".concat(e.unit)," ")),r.a.createElement(Le.a,{"aria-label":"close",onClick:q,sx:{position:"absolute",right:8,top:8,color:function(e){return e.palette.grey[500]}},size:"large"},r.a.createElement(fe.a,null)),r.a.createElement(ce.a,{value:O,onChange:function(e,t){w(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:!0,allowScrollButtonsMobile:!0},r.a.createElement(le.a,{label:"Activities"}),r.a.createElement(le.a,{label:"Settings"}),r.a.createElement(le.a,{label:"Dosing"}),r.a.createElement(le.a,{label:"LEDs"}),r.a.createElement(le.a,{label:"System"}))),r.a.createElement(te.a,null,r.a.createElement(ut,{value:O,index:0},Object.entries(e.jobs).filter((function(e){var t=Object(p.a)(e,2);t[0];return t[1].metadata.display})).filter((function(e){var t=Object(p.a)(e,2),a=t[0];t[1];return!["dosing_control","led_control","temperature_control"].includes(a)})).map((function(e){var a=Object(p.a)(e,2),n=a[0],o=a[1];return r.a.createElement("div",{key:n},r.a.createElement("div",{style:{justifyContent:"space-between",display:"flex"}},r.a.createElement(N.a,{display:"block"},o.metadata.display_name),r.a.createElement(N.a,{display:"block",gutterBottom:!0},r.a.createElement("span",{style:{color:ue[o.state].color}},ue[o.state].display))),r.a.createElement(N.a,{variant:"caption",display:"block",gutterBottom:!0,color:"textSecondary"},"app"!==o.metadata.source?"Installed by ".concat(o.metadata.source||"unknown"):""),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:o.metadata.description}})),Z[n],r.a.createElement(ae.a,{className:t.divider}))})),ge&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{justifyContent:"space-between",display:"flex"}},r.a.createElement(N.a,{display:"block"},"Temperature automation"),r.a.createElement(N.a,{display:"block",gutterBottom:!0},r.a.createElement("span",{style:{color:ue[ge.state].color}},ue[ge.state].display))),r.a.createElement(N.a,{variant:"caption",display:"block",gutterBottom:!0,color:"textSecondary"}),r.a.createElement("div",{key:ge.metadata.key},"ready"===ge.state||"sleeping"===ge.state||"init"===ge.state?r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"Currently running temperature automation ",r.a.createElement("code",{className:t.code},ge.publishedSettings.automation_name.value),". Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.pioreactor.com/user-guide/temperature-automations"},"temperature automations"),"."),Z[ge.metadata.key]):r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:ge.metadata.description}})),r.a.createElement(se.a,{className:t.patientButton,size:"small",color:"primary",variant:"contained",onClick:function(){return G(!0)}},"Start"),r.a.createElement(se.a,{className:t.patientButton,size:"small",color:"primary",disabled:!0},"Stop"))),r.a.createElement(se.a,{onClick:function(){return G(!0)},style:{marginTop:"10px"},size:"small",color:"primary",disabled:!Ee},"Change temperature automation"),r.a.createElement(Ye,{open:z,onFinished:function(){return G(!1)},unit:e.unit,label:e.label,config:e.config,experiment:e.experiment,isJobRunning:Ee,automationType:"temperature",no_skip_first_run:!0})),r.a.createElement(ae.a,{className:t.divider}),de&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{justifyContent:"space-between",display:"flex"}},r.a.createElement(N.a,{display:"block"},"Dosing automation"),r.a.createElement(N.a,{display:"block",gutterBottom:!0},r.a.createElement("span",{style:{color:ue[de.state].color}},ue[de.state].display))),r.a.createElement(N.a,{variant:"caption",display:"block",gutterBottom:!0,color:"textSecondary"}),r.a.createElement("div",{key:de.metadata.key},"ready"===de.state||"sleeping"===de.state||"init"===ge.state?r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"Currently running dosing automation ",r.a.createElement("code",null,de.publishedSettings.automation_name.value),". Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.pioreactor.com/user-guide/dosing-automations"},"dosing automations"),"."),Z[de.metadata.key]):r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:de.metadata.description}})),r.a.createElement(se.a,{className:t.patientButton,size:"small",color:"primary",variant:"contained",onClick:function(){return B(!0)}},"Start"),r.a.createElement(se.a,{className:t.patientButton,size:"small",color:"primary",disabled:!0},"Stop"))),r.a.createElement(se.a,{onClick:function(){return B(!0)},style:{marginTop:"10px"},size:"small",color:"primary",disabled:!pe},"Change dosing automation"),r.a.createElement(Ye,{automationType:"dosing",open:T,onFinished:function(){return B(!1)},unit:e.unit,label:e.label,config:e.config,experiment:e.experiment,isJobRunning:pe,no_skip_first_run:!1})),r.a.createElement(ae.a,{className:t.divider}),_e&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{justifyContent:"space-between",display:"flex"}},r.a.createElement(N.a,{display:"block"},"LED automation"),r.a.createElement(N.a,{display:"block",gutterBottom:!0},r.a.createElement("span",{style:{color:ue[_e.state].color}},ue[_e.state].display))),r.a.createElement(N.a,{variant:"caption",display:"block",gutterBottom:!0,color:"textSecondary"}),r.a.createElement("div",{key:_e.metadata.key},"ready"===_e.state||"sleeping"===_e.state||"init"===ge.state?r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"Currently running LED automation ",r.a.createElement("code",null,_e.publishedSettings.automation_name.value),". Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.pioreactor.com/user-guide/led-automations"},"LED automations"),"."),Z[_e.metadata.key]):r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:_e.metadata.description}})),r.a.createElement(se.a,{className:t.patientButton,size:"small",color:"primary",variant:"contained",onClick:function(){return W(!0)}},"Start"),r.a.createElement(se.a,{className:t.patientButton,size:"small",color:"primary",disabled:!0},"Stop"))),r.a.createElement(se.a,{onClick:function(){return W(!0)},style:{marginTop:"10px"},size:"small",color:"primary",disabled:!he},"Change LED automation"),r.a.createElement(Ye,{automationType:"led",open:R,onFinished:function(){return W(!1)},unit:e.unit,config:e.config,label:e.label,experiment:e.experiment,isJobRunning:he,no_skip_first_run:!1})),r.a.createElement(ae.a,{className:t.divider})),r.a.createElement(ut,{value:O,index:1},r.a.createElement(N.a,{gutterBottom:!0},"Assign label to Pioreactor"),r.a.createElement(N.a,{variant:"body2",component:"p"},"Assign a temporary label to this Pioreactor for this experiment. The new label will display in graph legends, and throughout the interface."),r.a.createElement(yt,{value:e.label,onUpdate:function(t,a){var n=a;b("Updating to ".concat(n)),m(!0),fetch("/api/unit_labels/current",{method:"PUT",body:JSON.stringify({label:n,unit:e.unit}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(t){t.ok&&e.setLabel(n)}))},setSnackbarMessage:b,setSnackbarOpen:m,id:"relabeller"+e.unit,disabled:!1}),r.a.createElement(ae.a,{className:t.divider}),Object.values(e.jobs).filter((function(e){return e.metadata.display})).map((function(e){return[e.state,e.metadata.key,e.publishedSettings]})).map((function(e,a){var n=Object(p.a)(e,3),o=n[0],i=n[1],c=n[2];return Object.entries(c).filter((function(e,t){var a=Object(p.a)(e,2);a[0];return a[1].display})).map((function(e,a){var n=Object(p.a)(e,2),c=n[0],l=n[1];return r.a.createElement(r.a.Fragment,{key:c},r.a.createElement(N.a,{gutterBottom:!0},l.label),r.a.createElement(N.a,{variant:"body2",component:"p"},l.description),"boolean"===l.type&&r.a.createElement(xt,{onUpdate:$,setSnackbarMessage:b,setSnackbarOpen:m,value:l.value,units:l.unit,id:"".concat(i.replace("_control","_automation"),"/").concat(c),disabled:"disconnected"===o}),"boolean"!==l.type&&r.a.createElement(yt,{onUpdate:$,setSnackbarMessage:b,setSnackbarOpen:m,value:l.value,units:l.unit,id:"".concat(i.replace("_control","_automation"),"/").concat(c),disabled:"disconnected"===o}),r.a.createElement(ae.a,{className:t.divider}))}))}))),r.a.createElement(ut,{value:O,index:2},r.a.createElement(N.a,{gutterBottom:!0},"Cycle Media"),r.a.createElement(N.a,{variant:"body2",component:"p"},"Safely cycle media in and out of your Pioreactor for a set duration (seconds) by running the media and waste pump simultaneously."),r.a.createElement(nt,{action:"circulate_media",unit:e.unit,job:e.jobs.circulate_media}),r.a.createElement(ae.a,{classes:{root:t.divider}}),r.a.createElement(N.a,{gutterBottom:!0},"Cycle alternative media"),r.a.createElement(N.a,{variant:"body2",component:"p"},"Safely cycle alternative media in and out of your Pioreactor for a set duration (seconds) by running the alt-media and waste pump simultaneously."),r.a.createElement(nt,{action:"circulate_alt_media",unit:e.unit,job:e.jobs.circulate_alt_media}),r.a.createElement(ae.a,{classes:{root:t.divider}}),r.a.createElement(f.a,{severity:"warning",style:{marginBottom:"10px",marginTop:"10px"}},"It's easy to overflow your vial. Make sure you don't add too much media."),r.a.createElement(N.a,{gutterBottom:!0},"Add media"),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"Run the media pump for a set duration (s), moving a set volume (mL), or continuously add until stopped."),r.a.createElement(N.a,{variant:"body2",component:"p"},"Specify how you\u2019d like to add media:"),r.a.createElement(Ze,{action:"add_media",unit:e.unit,job:e.jobs.add_media}),r.a.createElement(ae.a,{classes:{root:t.divider}}),r.a.createElement(N.a,{gutterBottom:!0},"Remove waste"),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"Run the waste pump for a set duration (s), moving a set volume (mL), or continuously remove until stopped."),r.a.createElement(N.a,{variant:"body2",component:"p"},"Specify how you\u2019d like to remove waste:"),r.a.createElement(Ze,{action:"remove_waste",unit:e.unit,job:e.jobs.remove_waste}),r.a.createElement(ae.a,{className:t.divider}),r.a.createElement(N.a,{gutterBottom:!0},"Add alternative media"),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"Run the alt-media pump for a set duration (s), moving a set volume (mL), or continuously add until stopped."),r.a.createElement(N.a,{variant:"body2",component:"p"},"Specify how you\u2019d like to add alt-media:"),r.a.createElement(Ze,{action:"add_alt_media",unit:e.unit,job:e.jobs.add_alt_media}),r.a.createElement(ae.a,{className:t.divider}),r.a.createElement(N.a,{gutterBottom:!0},"Manual adjustments"),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"Record adjustments before manually adding or removing from the vial. This is recorded in the database and will ensure accurate metrics."),r.a.createElement(et,{unit:e.unit})),r.a.createElement(ut,{value:O,index:3},r.a.createElement(N.a,{style:{textTransform:"capitalize"}},V.A?V.A.replace("_"," ").replace("led","LED"):"Channel A"),r.a.createElement(N.a,{className:Object(P.a)(t.suptitle),color:"textSecondary"},V.A?"Channel A":""),r.a.createElement(ot,{channel:"A",unit:e.unit}),r.a.createElement(ae.a,{className:t.divider}),r.a.createElement(N.a,{style:{textTransform:"capitalize"}},V.B?V.B.replace("_"," ").replace("led","LED"):"Channel B"),r.a.createElement(N.a,{className:Object(P.a)(t.suptitle),color:"textSecondary"},V.B?"Channel B":""),r.a.createElement(ot,{channel:"B",unit:e.unit}),r.a.createElement(ae.a,{className:t.divider}),r.a.createElement(N.a,{style:{textTransform:"capitalize"}},V.C?V.C.replace("_"," ").replace("led","LED"):"Channel C"),r.a.createElement(N.a,{className:Object(P.a)(t.suptitle),color:"textSecondary"},V.C?"Channel C":""),r.a.createElement(ot,{channel:"C",unit:e.unit}),r.a.createElement(ae.a,{className:t.divider}),r.a.createElement(N.a,{style:{textTransform:"capitalize"}},V.D?V.D.replace("_"," ").replace("led","LED"):"Channel D"),r.a.createElement(N.a,{className:Object(P.a)(t.suptitle),color:"textSecondary"},V.D?"Channel D":""),r.a.createElement(ot,{channel:"D",unit:e.unit}),r.a.createElement(ae.a,{className:t.divider})),r.a.createElement(ut,{value:O,index:4},r.a.createElement(N.a,{gutterBottom:!0},"Addresses and hostname"),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"Learn about how to ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.pioreactor.com/user-guide/accessing-raspberry-pi"},"access the Pioreactor's Raspberry Pi"),"."),r.a.createElement(N.a,{variant:"body2",component:"p"},"IPv4: ",r.a.createElement("code",{className:t.code},ie)),r.a.createElement(N.a,{variant:"body2",component:"p"},"Hostname: ",r.a.createElement("code",{className:t.code},e.unit,".local")),r.a.createElement(ae.a,{className:t.divider}),r.a.createElement(N.a,{gutterBottom:!0},"Version information"),r.a.createElement(N.a,{variant:"body2",component:"p"},"HAT version: ",re.hat),r.a.createElement(N.a,{variant:"body2",component:"p"},"HAT serial number: ",r.a.createElement("code",{className:t.code},re.hat_serial)),r.a.createElement(ae.a,{className:t.divider}),r.a.createElement(N.a,{gutterBottom:!0},"Voltage on PWM rail"),r.a.createElement(N.a,{variant:"body2",component:"p"},"Voltage: ",oe.voltage,"V"),r.a.createElement(N.a,{variant:"body2",component:"p"},"Last updated at: ",S.a.utc(oe.timestamp||"","YYYY-MM-DD[T]HH:mm:ss.SSSSS[Z]").local().format("MMMM Do, h:mm a")),r.a.createElement(ae.a,{className:t.divider}),r.a.createElement(N.a,{gutterBottom:!0},"Reboot"),r.a.createElement(N.a,{variant:"body2",component:"p"},"Reboot the Raspberry Pi operating system. This will stop all jobs, and the Pioreactor will be inaccessible for a few minutes."),r.a.createElement(F.a,{loadingIndicator:"Rebooting",loading:k,variant:"contained",color:"primary",size:"small",style:{marginTop:"15px"},onClick:function(){M(!0),fetch("/api/reboot/"+e.unit,{method:"POST"})}},"Reboot RPi"),r.a.createElement(ae.a,{className:t.divider})))),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:u,onClose:function(e,t){"clickaway"!==t&&m(!1)},message:v,autoHideDuration:7e3,resumeHideDuration:2e3,key:"snackbar"+e.unit+"settings"}))}function bt(e){var t=e.config,a=e.experiment,o=lt(),i="$broadcast",c=Object(n.useState)(!1),l=Object(p.a)(c,2),s=l[0],u=l[1],m=Object(n.useState)(null),d=Object(p.a)(m,2),h=d[0],v=d[1],b=Object(n.useState)(!1),y=Object(p.a)(b,2),O=y[0],w=y[1],j=Object(n.useState)(""),C=Object(p.a)(j,2),S=C[0],k=C[1],P=r.a.useState(0),M=Object(p.a)(P,2),L=M[0],D=M[1],T=r.a.useState({}),B=Object(p.a)(T,2),A=B[0],I=B[1],R=r.a.useState(!1),W=Object(p.a)(R,2),U=W[0],F=W[1],K=r.a.useState(!1),z=Object(p.a)(K,2),G=z[0],H=z[1],Y=r.a.useState(!1),$=Object(p.a)(Y,2),q=$[0],J=$[1];Object(n.useEffect)((function(){fetch("/api/contrib/jobs").then((function(e){if(e.ok)return e.json();throw new Error("Something went wrong")})).then((function(e){var t,a={},n=Object(V.a)(e);try{for(n.s();!(t=n.n()).done;){for(var r=t.value,o={publishedSettings:{},metadata:{display_name:r.display_name,display:r.display,description:r.description,key:r.job_name,source:r.source}},i=0;i<r.published_settings.length;++i){var c=r.published_settings[i];o.publishedSettings[c.key]={value:c.default||null,label:c.label,type:c.type,unit:c.unit||null,display:c.display,description:c.description}}a[r.job_name]=o}}catch(l){n.e(l)}finally{n.f()}I((function(e){return Object(x.a)(Object(x.a)({},e),a)}))})).catch((function(e){}))}),[]),Object(n.useEffect)((function(){var e;t["cluster.topology"]&&((e=t.remote&&t.remote.ws_url?new _.Client("ws://".concat(t.remote.ws_url,"/"),"webui_SettingsActionsDialogAll"+Math.floor(1e4*Math.random())):new _.Client("".concat(t["cluster.topology"].leader_address),9001,"webui_SettingsActionsDialogAll"+Math.floor(1e4*Math.random()))).connect({userName:"pioreactor",password:"raspberry",keepAliveInterval:900,reconnect:!0}),v(e))}),[t]);function Z(e,t){return function n(){var r=new _.Message(String(t));r.destinationName=["pioreactor",i,a,e.metadata.key,"$state","set"].join("/"),r.qos=1;try{h.publish(r)}catch(o){console.log(o),setTimeout((function(){n()}),750)}finally{k("".concat({sleeping:"Pausing",disconnected:"Stopping",ready:"Resuming"}[t]," ").concat(e.metadata.display_name.toLowerCase()," on all active Pioreactors")),w(!0)}}}function ne(e,t){var n=new _.Message(String(t));n.destinationName=["pioreactor",i,a,e,"set"].join("/"),n.qos=1;try{h.publish(n),w(!0)}catch(r){console.log(r),h.connect({userName:"pioreactor",password:"raspberry",keepAliveInterval:900,onSuccess:function(){return ne(e,t)}})}}var re=function(){u(!1),setTimeout((function(){return D(0)}),200)};function oe(e){var t=function(t){if(t.ok)return k("Starting ".concat(e.metadata.display_name.toLowerCase()," on all active Pioreactors")),void w(!0)};if("temperature_control"===e.metadata.key)var a=function(){return F(!0)};else a="dosing_control"===e.metadata.key?function(){return H(!0)}:"led_control"===e.metadata.key?function(){return J(!0)}:function(){return Object(g.c)(i,e.metadata.key,[],{},t)};return r.a.createElement("div",{key:e.metadata.key},r.a.createElement(se.a,{className:o.jobButton,disableElevation:!0,color:"primary",onClick:a},"Start"),r.a.createElement(se.a,{className:o.jobButton,disableElevation:!0,color:"primary",onClick:Z(e,"sleeping")},"Pause"),r.a.createElement(se.a,{className:o.jobButton,disableElevation:!0,color:"primary",onClick:Z(e,"ready")},"Resume"),r.a.createElement(se.a,{className:o.jobButton,disableElevation:!0,color:"secondary",onClick:Z(e,"disconnected")},"Stop"))}var ie=Object.fromEntries(Object.entries(A).map((function(e,t){var a=Object(p.a)(e,2);return[a[0],oe(a[1])]}))),ue=Object(Q.a)((function(e){return e.breakpoints.down("xl")})),me=A.dosing_control,de=A.led_control,pe=A.temperature_control;return r.a.createElement(r.a.Fragment,null,r.a.createElement(se.a,{style:{textTransform:"none",float:"right"},onClick:function(){u(!0)},color:"primary"},r.a.createElement(ye.a,{fontSize:"15",classes:{root:o.textIcon}})," Manage all Pioreactors"),r.a.createElement(X.a,{maxWidth:ue?"sm":"md",fullWidth:!0,open:s,onClose:re,"aria-labelledby":"form-dialog-title",PaperProps:{sx:{height:"calc(100% - 64px)"}}},r.a.createElement(ee.a,{style:{backgroundImage:"linear-gradient(to bottom left, rgba(83, 49, 202, 0.4), rgba(0,0,0,0))"}},r.a.createElement(N.a,{className:o.suptitle},r.a.createElement("b",null,"All active Pioreactors")),r.a.createElement(Le.a,{"aria-label":"close",onClick:re,sx:{position:"absolute",right:8,top:8,color:function(e){return e.palette.grey[600]}},size:"large"},r.a.createElement(fe.a,null)),r.a.createElement(ce.a,{value:L,onChange:function(e,t){D(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:!0,allowScrollButtonsMobile:!0},r.a.createElement(le.a,{label:"Activities"}),r.a.createElement(le.a,{label:"Settings"}),r.a.createElement(le.a,{label:"Dosing"}),r.a.createElement(le.a,{label:"LEDs"}))),r.a.createElement(te.a,null,r.a.createElement(ut,{value:L,index:0},Object.entries(A).filter((function(e){var t=Object(p.a)(e,2);t[0];return t[1].metadata.display})).filter((function(e){var t=Object(p.a)(e,2),a=t[0];t[1];return!["dosing_control","led_control","temperature_control"].includes(a)})).map((function(e){var t=Object(p.a)(e,2),a=t[0],n=t[1];return r.a.createElement("div",{key:a},r.a.createElement(N.a,{gutterBottom:!0},n.metadata.display_name),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:n.metadata.description}})),ie[a],r.a.createElement(ae.a,{classes:{root:o.divider}}))})),pe&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{justifyContent:"space-between",display:"flex"}},r.a.createElement(N.a,{display:"block"},"Temperature automation")),r.a.createElement("div",null,r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:pe.metadata.description}})),ie.temperature_control),r.a.createElement(Ye,{open:U,onFinished:function(){return F(!1)},unit:i,config:t,experiment:a,isJobRunning:!1,automationType:"temperature",no_skip_first_run:!0})),r.a.createElement(ae.a,{className:o.divider}),me&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{justifyContent:"space-between",display:"flex"}},r.a.createElement(N.a,{display:"block"},"Dosing automation")),r.a.createElement("div",null,r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:me.metadata.description}})),ie.dosing_control),r.a.createElement(Ye,{automationType:"dosing",open:G,onFinished:function(){return H(!1)},unit:i,config:t,experiment:a,isJobRunning:!1,no_skip_first_run:!1})),r.a.createElement(ae.a,{className:o.divider}),de&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{justifyContent:"space-between",display:"flex"}},r.a.createElement(N.a,{display:"block"},"LED automation")),r.a.createElement("div",null,r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:de.metadata.description}})),ie.led_control),r.a.createElement(Ye,{automationType:"led",open:q,onFinished:function(){return J(!1)},unit:i,config:t,experiment:a,isJobRunning:!1,no_skip_first_run:!1})),r.a.createElement(ae.a,{className:o.divider})),r.a.createElement(ut,{value:L,index:1},Object.values(A).filter((function(e){return e.metadata.display})).map((function(e){return[e.state,e.metadata.key,e.publishedSettings]})).map((function(e,t){var a=Object(p.a)(e,3),n=(a[0],a[1]),i=a[2];return Object.entries(i).filter((function(e,t){var a=Object(p.a)(e,2);a[0];return a[1].display})).map((function(e,t){var a=Object(p.a)(e,2),i=a[0],c=a[1];return r.a.createElement(r.a.Fragment,{key:n+i},r.a.createElement(N.a,{gutterBottom:!0},c.label),r.a.createElement(N.a,{variant:"body2",component:"p"},c.description),"boolean"===c.type&&r.a.createElement(xt,{onUpdate:ne,setSnackbarMessage:k,setSnackbarOpen:w,value:c.value,units:c.unit,id:"".concat(n.replace("_control","_automation"),"/").concat(i),disabled:!1}),"boolean"!==c.type&&r.a.createElement(yt,{onUpdate:ne,setSnackbarMessage:k,setSnackbarOpen:w,value:c.value,units:c.unit,id:"".concat(n.replace("_control","_automation"),"/").concat(i),disabled:!1}),r.a.createElement(ae.a,{classes:{root:o.divider}}))}))}))),r.a.createElement(ut,{value:L,index:2},r.a.createElement(N.a,{gutterBottom:!0},"Cycle Media"),r.a.createElement(N.a,{variant:"body2",component:"p"},"Safely cycle media in and out of your Pioreactor for a set duration (seconds)."),r.a.createElement(nt,{action:"circulate_media",unit:i}),r.a.createElement(ae.a,{classes:{root:o.divider}}),r.a.createElement(N.a,{gutterBottom:!0},"Cycle alternative media"),r.a.createElement(N.a,{variant:"body2",component:"p"},"Safely cycle alternative media in and out of your Pioreactor for a set duration (seconds)."),r.a.createElement(nt,{action:"circulate_alt_media",unit:i}),r.a.createElement(ae.a,{classes:{root:o.divider}}),r.a.createElement(f.a,{severity:"warning",style:{marginBottom:"10px",marginTop:"10px"}},"It's easy to overflow your vial. Make sure you don't add too much media."),r.a.createElement(N.a,{gutterBottom:!0},"Add media"),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"Run the media pumps for a set duration (seconds), moving a set volume (mL), or continuously add until stopped."),r.a.createElement(N.a,{variant:"body2",component:"p"},"Specify how you\u2019d like to add media:"),r.a.createElement(Ze,{action:"add_media",unit:i}),r.a.createElement(ae.a,{className:o.divider}),r.a.createElement(N.a,{gutterBottom:!0},"Remove waste"),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"Run the waste pumps for a set duration (seconds), moving a set volume (mL), or continuously add until stopped."),r.a.createElement(N.a,{variant:"body2",component:"p"},"Specify how you\u2019d like to remove media:"),r.a.createElement(Ze,{action:"remove_waste",unit:i}),r.a.createElement(ae.a,{className:o.divider}),r.a.createElement(N.a,{gutterBottom:!0},"Add alternative media"),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"Run the alternative media pumps for a set duration (seconds), moving a set volume (mL), or continuously add until stopped."),r.a.createElement(N.a,{variant:"body2",component:"p"},"Specify how you\u2019d like to add alt-media:"),r.a.createElement(Ze,{action:"add_alt_media",unit:i}),r.a.createElement(ae.a,{className:o.divider}),r.a.createElement(N.a,{gutterBottom:!0},"Manual adjustments"),r.a.createElement(N.a,{variant:"body2",component:"p",gutterBottom:!0},"Record adjustments before manually adding or removing from the vial. This is recorded in the database and will ensure accurate metrics."),r.a.createElement(et,{unit:i})),r.a.createElement(ut,{value:L,index:3},r.a.createElement(N.a,{style:{textTransform:"capitalize"}},"Channel A"),r.a.createElement(ot,{channel:"A",unit:i}),r.a.createElement(ae.a,{className:o.divider}),r.a.createElement(N.a,{style:{textTransform:"capitalize"}},"Channel B"),r.a.createElement(ot,{channel:"B",unit:i}),r.a.createElement(ae.a,{className:o.divider}),r.a.createElement(N.a,{style:{textTransform:"capitalize"}},"Channel C"),r.a.createElement(ot,{channel:"C",unit:i}),r.a.createElement(ae.a,{className:o.divider}),r.a.createElement(N.a,{style:{textTransform:"capitalize"}},"Channel D"),r.a.createElement(ot,{channel:"D",unit:i}),r.a.createElement(ae.a,{className:o.divider})))),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:O,onClose:function(e,t){"clickaway"!==t&&w(!1)},message:S,autoHideDuration:7e3,resumeHideDuration:2e3,key:"snackbar"+i+"settings"}))}function yt(e){var t=lt(),a=r.a.useState(e.value||""),o=Object(p.a)(a,2),i=o[0],c=o[1],l=r.a.useState(!1),s=Object(p.a)(l,2),u=s[0],m=s[1];Object(n.useEffect)((function(){e.value!==i&&c(e.value||"")}),[e.value]);var d=function(){e.onUpdate(e.id,i),""!==i?e.setSnackbarMessage("Updating to ".concat(i).concat(e.units?" "+e.units:"",".")):e.setSnackbarMessage("Updating."),e.setSnackbarOpen(!0),m(!1)};return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(re.a,{size:"small",autoComplete:"off",disabled:e.disabled,id:e.id,value:i,InputProps:{endAdornment:r.a.createElement(ie.a,{position:"end"},e.units),autoComplete:"new-password"},variant:"outlined",onChange:function(e){m(!0),c(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&e.target.value&&d()},className:t.textFieldCompact}),r.a.createElement(se.a,{size:"small",color:"primary",disabled:!u,onClick:d,style:{marginTop:"15px",marginLeft:"7px",display:e.disabled?"None":""}},"Update"))}function xt(e){var t=r.a.useState(st(e.value)||!1),a=Object(p.a)(t,2),o=a[0],i=a[1];Object(n.useEffect)((function(){e.value!==o&&i(st(e.value)||!1)}),[e.value]);return r.a.createElement(Ie.a,{checked:o,disabled:e.disabled,onChange:function(t){i(t.target.checked),e.onUpdate(e.id,t.target.checked?1:0);var a=t.target.checked?"on":"off";e.setSnackbarMessage("Updating to ".concat(a,".")),e.setSnackbarOpen(!0)},id:e.id})}function Ot(e){var t=r.a.useState({}),a=Object(p.a)(t,2),n=a[0],o=a[1];r.a.useEffect((function(){Object(g.b)(o)}),[]);var i=e.units.map((function(t){return r.a.createElement(jt,{isUnitActive:!0,key:t,unit:t,config:e.config,experiment:e.experiment,label:n[t]})})),c=r.a.createElement("div",{style:{textAlign:"center",marginBottom:"50px",marginTop:"50px"}},r.a.createElement(N.a,{component:"div",variant:"body2"},r.a.createElement(U.a,{fontWeight:"fontWeightRegular"},"No active Pioreactors. Do you need to update `cluster.inventory` section in the ",r.a.createElement("a",{href:"/config"},"configuration"),"?"),r.a.createElement(U.a,{fontWeight:"fontWeightRegular"},"Or, ",r.a.createElement("a",{href:"https://docs.pioreactor.com/user-guide/create-cluster"},"read our documentation")," about managing inventory.")));return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"10px",marginTop:"15px"}},r.a.createElement(N.a,{variant:"h5",component:"h2"},r.a.createElement(U.a,{fontWeight:"fontWeightRegular"},"Active Pioreactors")),r.a.createElement("div",null)),0===e.units.length&&e.experiment?c:i)}function wt(e){var t=lt(),a=Object(n.useState)(!1),o=Object(p.a)(a,2),i=o[0],c=o[1];return r.a.createElement(se.a,{style:{textTransform:"none",float:"right"},className:Object(P.a)({blinkled:i}),disabled:e.disabled,onClick:function(){c(!0);!function t(){var a=new _.Message("1");a.destinationName=["pioreactor",e.unit,"$experiment","monitor","flicker_led_response_okay"].join("/"),a.qos=0;try{e.client.publish(a)}catch(n){console.log(n),setTimeout((function(){t()}),1e3)}}(),setTimeout((function(){c(!1)}),3600)},color:"primary"},r.a.createElement(ve.a,{color:e.disabled?"disabled":"primary",fontSize:"15",classes:{root:t.textIcon}})," ",r.a.createElement("span",null," Identify "))}function jt(e){var t=lt(),a=e.unit,o=e.isUnitActive,i=e.experiment,c=e.config,l=Object(n.useState)(!1),s=Object(p.a)(l,2),u=s[0],m=s[1],d=Object(n.useState)(""),f=Object(p.a)(d,2),h=f[0],g=f[1],E=Object(n.useState)(null),v=Object(p.a)(E,2),b=v[0],y=v[1],O=Object(n.useState)({monitor:{state:"disconnected",metadata:{display:!1},publishedSettings:{versions:{value:null,label:null,type:"json",unit:null,display:!1,description:null},voltage_on_pwm_rail:{value:null,label:null,type:"json",unit:null,display:!1,description:null},ipv4:{value:null,label:null,type:"string",unit:null,display:!1,description:null}}}}),w=Object(p.a)(O,2),C=w[0],S=w[1];Object(n.useEffect)((function(){g(e.label)}),[e.label]),Object(n.useEffect)((function(){fetch("/api/contrib/jobs").then((function(e){if(e.ok)return e.json();throw new Error("Something went wrong")})).then((function(e){var t,a={},n=Object(V.a)(e);try{for(n.s();!(t=n.n()).done;){for(var r=t.value,o={state:"disconnected",publishedSettings:{},metadata:{display_name:r.display_name,subtext:r.subtext,display:r.display,description:r.description,key:r.job_name,source:r.source,is_testing:r.is_testing}},i=0;i<r.published_settings.length;++i){var c=r.published_settings[i];o.publishedSettings[c.key]={value:c.default||null,label:c.label,type:c.type,unit:c.unit||null,display:c.display,description:c.description}}a[r.job_name]=o}}catch(l){n.e(l)}finally{n.f()}S((function(e){return Object(x.a)(Object(x.a)({},e),a)})),m(!0)})).catch((function(e){}))}),[]);var k=function(e,t){return"numeric"===t?parseFloat(e):e};Object(n.useEffect)((function(){var t;e.config["cluster.topology"]&&(o&&u&&i&&((t=e.config.remote&&e.config.remote.ws_url?new _.Client("ws://".concat(e.config.remote.ws_url,"/"),"webui_PioreactorCard"+Math.floor(1e4*Math.random())):new _.Client("".concat(e.config["cluster.topology"].leader_address),9001,"webui_PioreactorCard"+Math.floor(1e4*Math.random()))).onMessageArrived=function(e){var t=e.topic.split("/").slice(-2),a=Object(p.a)(t,2),n=a[0],r=a[1];if("$state"===r){var o=e.payloadString;S((function(e){return Object(x.a)(Object(x.a)({},e),{},Object(j.a)({},n,Object(x.a)(Object(x.a)({},e[n]),{},{state:o})))}))}else if(n.endsWith("_automation")){n=n.replace("_automation","_control");o=k(e.payloadString,C[n].publishedSettings[r].type);S((function(e){return Object(x.a)(Object(x.a)({},e),{},Object(j.a)({},n,Object(x.a)(Object(x.a)({},e[n]),{},{publishedSettings:Object(x.a)(Object(x.a)({},e[n].publishedSettings),{},Object(j.a)({},r,Object(x.a)(Object(x.a)({},e[n].publishedSettings[r]),{},{value:o})))})))}))}else{o=k(e.payloadString,C[n].publishedSettings[r].type);S((function(e){return Object(x.a)(Object(x.a)({},e),{},Object(j.a)({},n,Object(x.a)(Object(x.a)({},e[n]),{},{publishedSettings:Object(x.a)(Object(x.a)({},e[n].publishedSettings),{},Object(j.a)({},r,Object(x.a)(Object(x.a)({},e[n].publishedSettings[r]),{},{value:o})))})))}))}},t.connect({userName:"pioreactor",password:"raspberry",keepAliveInterval:900,onSuccess:function(){t.subscribe(["pioreactor",a,"$experiment","monitor","$state"].join("/"));for(var e=0,n=Object.keys(C);e<n.length;e++){var r=n[e],o=C[r].metadata.is_testing?"_testing_"+i:i;t.subscribe(["pioreactor",a,o,r,"$state"].join("/"));for(var c=0,l=Object.keys(C[r].publishedSettings);c<l.length;c++){var s=l[c],u=["pioreactor",a,"monitor"===r?"$experiment":o,"automation_name"===s?r:r.replace("_control","_automation"),s].join("/");t.subscribe(u)}}},reconnect:!0}),y(t)))}),[c,i,u,o]);var M,L="disconnected"===(M=C.monitor.state)?"grey":"lost"===M?"#DE3618":"#4caf50",D=function(e,t){return"disconnected"===e&&t?"Offline, need to power up":"disconnected"!==e||t?"lost"===e?"Lost, something went wrong. Try manually power-cycling the unit.":"Online and ready":"Offline, change inventory status in config.ini"}(C.monitor.state,o);return r.a.createElement(I.a,{className:t.pioreactorCard,id:a},r.a.createElement(I.a,{className:t.cardContent},r.a.createElement("div",{className:"fixme"},r.a.createElement(N.a,{className:Object(P.a)(t.suptitle),color:"textSecondary"},h?a:""),r.a.createElement("div",{className:t.cardHeaderSettings},r.a.createElement("div",{style:{display:"flex",justifyContent:"left"}},r.a.createElement(N.a,{className:Object(P.a)(t.unitTitle,Object(j.a)({},t.disabledText,!o)),gutterBottom:!0},r.a.createElement(Fe.a,{color:o?"inherit":"disabled",style:{verticalAlign:"middle",marginRight:"3px"},sx:{display:{xs:"none",sm:"none",md:"inline"}}}),h||a),r.a.createElement(oe.a,{title:D,placement:"right"},r.a.createElement("div",null,r.a.createElement("div",{"aria-label":D,className:"indicator-dot",style:{boxShadow:"0 0 ".concat(0,"px ").concat(L,", inset 0 0 12px  ").concat(L)}})))),r.a.createElement("div",{className:t.cardHeaderButtons},r.a.createElement("div",null,r.a.createElement(Et,{client:b,disabled:!o,unit:a,label:h,selfTestState:C.self_test?C.self_test.state:null,selfTestTests:C.self_test?C.self_test:null})),r.a.createElement("div",null,r.a.createElement(wt,{client:b,disabled:!o,config:e.config,unit:a})),r.a.createElement("div",null,r.a.createElement(gt,{client:b,odBlankReading:C.od_blank?C.od_blank.publishedSettings.means.value:null,odBlankJobState:C.od_blank?C.od_blank.state:null,stirringCalibrationState:C.stirring_calibration?C.stirring_calibration.state:null,experiment:i,unit:a,label:h,disabled:!o})),r.a.createElement(vt,{config:e.config,client:b,unit:a,label:h,disabled:!o,experiment:i,jobs:C,setLabel:g})))),r.a.createElement("div",{style:{display:"flex",margin:"15px 20px 20px 0px",flexDirection:"row"}},r.a.createElement("div",{className:t.textboxLabel},r.a.createElement(N.a,{variant:"body2"},r.a.createElement(U.a,{fontWeight:"fontWeightBold",className:Object(P.a)(Object(j.a)({},t.disabledText,!o))},"Activities:"))),r.a.createElement("div",{className:t.rowOfUnitSettingDisplay},Object.values(C).filter((function(e){return e.metadata.display})).map((function(e){return r.a.createElement("div",{className:t.textbox,key:e.metadata.key},r.a.createElement(N.a,{variant:"body2",style:{fontSize:"0.84rem"},className:Object(P.a)(Object(j.a)({},t.disabledText,!o))},e.metadata.display_name),r.a.createElement(dt,{value:e.state,isUnitActive:o,default:"disconnected",subtext:e.metadata.subtext?e.publishedSettings[e.metadata.subtext].value:null,isStateSetting:!0}))})))),r.a.createElement(ae.a,null),r.a.createElement("div",{style:{display:"flex",margin:"15px 20px 20px 0px",flexDirection:"row"}},r.a.createElement("div",{className:t.textboxLabel},r.a.createElement(N.a,{variant:"body2"},r.a.createElement(U.a,{fontWeight:"fontWeightBold",className:Object(P.a)(Object(j.a)({},t.disabledText,!o))},"Settings:"))),r.a.createElement("div",{className:t.rowOfUnitSettingDisplay},Object.values(C).map((function(e){return[e.state,e.metadata.key,e.publishedSettings]})).map((function(a,n){var i=Object(p.a)(a,3),c=(i[0],i[1]),l=i[2];return Object.entries(l).filter((function(e,t){var a=Object(p.a)(e,2);a[0];return a[1].display})).map((function(a,n){var i=Object(p.a)(a,2),l=i[0],s=i[1];return r.a.createElement("div",{className:t.textbox,key:c+l},r.a.createElement(N.a,{variant:"body2",style:{fontSize:"0.84rem"},className:Object(P.a)(Object(j.a)({},t.disabledText,!o))},s.label),r.a.createElement(dt,{value:s.value,isUnitActive:o,measurementUnit:s.unit,precision:2,default:"\u2014",isLEDIntensity:"LED intensity"===s.label,isPWMDc:"PWM intensity"===s.label,config:e.config}))}))}))))))}function Ct(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"10px",marginTop:"15px"}},r.a.createElement(N.a,{variant:"h5",component:"h2"},r.a.createElement(U.a,{fontWeight:"fontWeightRegular"},"Inactive Pioreactors"))),e.units.map((function(t){return r.a.createElement(jt,{isUnitActive:!1,key:t,unit:t,config:e.config,experiment:e.experiment})})))}var St=function(e){var t=e.title,a=r.a.useState({}),n=Object(p.a)(a,2),o=n[0],i=n[1],c=r.a.useState({}),l=Object(p.a)(c,2),s=l[0],u=l[1];r.a.useEffect((function(){document.title=t,Object(g.a)(u),fetch("/api/experiments/latest").then((function(e){return e.json()})).then((function(e){i(e)}))}),[t]);var m=function(e){return Object.entries(e)},d=s["cluster.inventory"]?m(s["cluster.inventory"]).filter((function(e){return"1"===e[1]})).map((function(e){return e[0]})):[],_=s["cluster.inventory"]?m(s["cluster.inventory"]).filter((function(e){return"0"===e[1]})).map((function(e){return e[0]})):[];return r.a.createElement(k.a,{container:!0,spacing:2},r.a.createElement(k.a,{item:!0,md:12,xs:12},r.a.createElement(ft,{config:s,experiment:o.experiment}),r.a.createElement(Ot,{experiment:o.experiment,config:s,units:d}),_.length>0&&r.a.createElement(Ct,{experiment:o.experiment,config:s,units:_})))},kt=a(731),Pt=a(742),Mt=a(251),Lt=a.n(Mt),Dt=a(411),Tt=a.n(Dt),Bt=Object(M.a)((function(e){return{root:{marginTop:"15px"},cardContent:{padding:"10px"},button:{marginRight:e.spacing(1)},textField:{marginTop:e.spacing(1),marginBottom:e.spacing(1),width:"100%"}}}));function At(e){var t=Bt(),a=Object(n.useState)(!1),o=Object(p.a)(a,2),i=o[0],c=o[1];return r.a.createElement(se.a,{style:{textTransform:"none",float:"right"},className:Object(P.a)({blinkled:i}),disabled:e.disabled,onClick:function(){c(!0);!function t(){var a=new _.Message("1");a.destinationName=["pioreactor",e.unit,"$experiment","monitor","flicker_led_response_okay"].join("/"),a.qos=0;try{e.client.publish(a)}catch(n){console.log(n),setTimeout((function(){t()}),1e3)}}(),setTimeout((function(){c(!1)}),3600)},color:"primary"},r.a.createElement(ve.a,{color:e.disabled?"disabled":"primary",fontSize:"15",classes:{root:t.textIcon}})," ",r.a.createElement("span",null," Identify "))}var It=function(e){var t=Bt(),a=Object(n.useState)({}),o=Object(p.a)(a,2),i=o[0],c=o[1],l=Object(n.useState)({}),s=Object(p.a)(l,2),u=s[0],m=s[1],d=Object(n.useState)(null),f=Object(p.a)(d,2),h=f[0],E=f[1],v=Object(n.useState)(!1),b=Object(p.a)(v,2),y=b[0],O=b[1],w=e.config["cluster.inventory"]?Object.entries(e.config["cluster.inventory"]).filter((function(e){return"1"===e[1]})).map((function(e){return e[0]})):[];r.a.useEffect((function(){Object(g.b)(m)}),[]),Object(n.useEffect)((function(){var t;(t=e.config.remote&&e.config.remote.ws_url?new _.Client("ws://".concat(e.config.remote.ws_url,"/"),"webui_publishExpNameToMQTT"+Math.floor(1e4*Math.random())):new _.Client("".concat(e.config["cluster.topology"].leader_address),9001,"webui_publishExpNameToMQTT"+Math.floor(1e4*Math.random()))).connect(),E(t)}),[e.config]);var C=function(e){return function(t){return c(Object(x.a)(Object(x.a)({},i),{},Object(j.a)({},e,t.target.value)))}},S=Object.values(i).reduce((function(e,t){return e+(""!==t)}),0);return r.a.createElement("div",{className:t.root},r.a.createElement(k.a,{container:!0,spacing:1},r.a.createElement(k.a,{item:!0,xs:12},r.a.createElement("p",null," Assign labels to Pioreactors in your cluster. These labels are temporary for this experiment, and will show up in charts, tables, and elsewhere in this interface.  "),r.a.createElement("p",null,"Labels can be changed later, too."),r.a.createElement(ae.a,{style:{marginBottom:"20px"}})),w.map((function(t){return r.a.createElement(r.a.Fragment,{key:t},r.a.createElement(k.a,{item:!0,lg:2,md:1,xs:0}),r.a.createElement(k.a,{item:!0,lg:8,md:10,xs:12},r.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between"}},r.a.createElement("div",{style:{width:"140px"}},r.a.createElement(Fe.a,{style:{verticalAlign:"middle",fontSize:"1.0em"}}),r.a.createElement("span",{style:{lineHeight:"40px"}},t)),r.a.createElement("div",null,r.a.createElement(re.a,{size:"small",defaultValue:u[t],placeholder:"(Optional)",onChange:C(t),style:{width:"140px",marginRight:"10px"}})),r.a.createElement("div",null,r.a.createElement(At,{client:h,disable:!1,config:e.config,unit:t})))),r.a.createElement(k.a,{item:!0,lg:2,md:1,xs:0}))})),r.a.createElement(k.a,{item:!0,xs:12,lg:4}),r.a.createElement(k.a,{item:!0,xs:12,lg:8},r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},r.a.createElement(se.a,{variant:"contained",color:"primary",onClick:function(){Object.entries(i).map((function(e){return fetch("/api/unit_labels/current",{method:"PUT",body:JSON.stringify({label:e[1],unit:e[0]}),headers:{Accept:"application/json","Content-Type":"application/json"}})})),O(!0)},endIcon:y?r.a.createElement(ge.a,null):r.a.createElement(Tt.a,null),disabled:0===S||y},y?"Assigned":S>0?"Assign ".concat(S):"Assign")))))},Rt=Object(M.a)((function(e){return{root:{marginTop:"15px"},cardContent:{padding:"10px"},skipButton:{marginRight:e.spacing(1),float:"right"},instructions:{marginTop:e.spacing(2),marginBottom:e.spacing(4),marginLeft:"auto",marginRight:"auto",width:"60%"},textField:{marginTop:e.spacing(0),marginBottom:e.spacing(2),width:"100%"},thinTextField:{marginTop:e.spacing(2),marginBottom:e.spacing(0),width:"100%"},formControl:{margin:e.spacing(3)}}})),Nt=Object(kt.a)();function Wt(e){var t=Rt(),a=r.a.useState({key:e.value}),n=Object(p.a)(a,2),o=n[0],i=n[1],c=e.options,l=e.updateParentCallback;return r.a.useEffect((function(){i({key:e.value})}),[e.value]),r.a.createElement(Pt.a,{value:o,className:t.textField,onChange:function(e,t){"string"===typeof t?(i({key:t}),l(t)):t&&t.inputValue?(i({key:t.inputValue}),l(t.inputValue)):(i(t),l(null===t||void 0===t?void 0:t.key))},filterOptions:function(e,t){var a=Nt(e,t),n=t.inputValue,r=e.some((function(e){return n===e.key}));return""===n||r||a.push({inputValue:n,key:'Add "'.concat(n,'"')}),a},selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,id:"free-solo-with-text-addition",options:c,getOptionLabel:function(e){return"string"===typeof e?e:e.inputValue?e.inputValue:e.key?e.key:""},renderOption:function(e,t){return r.a.createElement("li",e,t.key)},sx:{width:300},freeSolo:!0,renderInput:function(t){return r.a.createElement(re.a,Object.assign({},t,{label:e.label}))}})}function Ut(e){var t=Rt(),a=S.a.utc(),n=r.a.useState(!1),o=Object(p.a)(n,2),i=o[0],c=o[1],l=r.a.useState(" "),s=Object(p.a)(l,2),u=s[0],m=s[1],d=r.a.useState(""),_=Object(p.a)(d,2),f=_[0],h=_[1],g=r.a.useState(""),E=Object(p.a)(g,2),v=E[0],b=E[1],y=r.a.useState(""),x=Object(p.a)(y,2),O=x[0],w=x[1],j=r.a.useState(""),C=Object(p.a)(j,2),P=C[0],M=C[1],L=r.a.useState([]),D=Object(p.a)(L,2),B=D[0],A=D[1],I=r.a.useState([]),R=Object(p.a)(I,2),N=R[0],W=R[1],U=r.a.useState({}),F=Object(p.a)(U,2),K=F[0],z=F[1];r.a.useEffect((function(){fetch("/api/historical_media").then((function(e){if(e.ok)return e.json()})).then((function(e){return A(e)})),fetch("/api/historical_organisms").then((function(e){if(e.ok)return e.json()})).then((function(e){return W(e)})),fetch("/api/experiments").then((function(e){if(e.ok)return e.json()})).then((function(e){return e.reduce((function(e,t){return e[t.experiment]=1,e}),{})})).then((function(e){return z(e)}))}),[]);return r.a.createElement("div",{className:t.root},r.a.createElement(T.a,null,r.a.createElement(k.a,{container:!0,spacing:1},r.a.createElement(k.a,{item:!0,xs:12,md:8},r.a.createElement(re.a,{error:i,id:"expName",label:"Experiment name",value:f,required:!0,className:t.thinTextField,onChange:function(e){var t=e.target.value;h(t),t.trim()in K?(c(!0),m("Experiment name already used. Please choose another.")):t.includes("#")||t.includes("+")||t.includes("/")?(c(!0),m("Can't use #, / or + characters in experiment name.")):(m(" "),c(!1))},helperText:u})),r.a.createElement(k.a,{item:!0,xs:12,md:6}),r.a.createElement(k.a,{item:!0,xs:12,md:12},r.a.createElement(re.a,{label:"Description (optional)",rows:2,placeholder:"Add a description. This description can be changed later.",multiline:!0,value:v,className:t.textField,onChange:function(e){b(e.target.value)},fullWidth:!0})),r.a.createElement(k.a,{item:!0,xs:12,md:6},r.a.createElement(Wt,{options:N,label:"Organism / strain (optional)",updateParentCallback:w,value:O})),r.a.createElement(k.a,{item:!0,xs:12,md:6},r.a.createElement(Wt,{options:B,label:"Media (optional)",updateParentCallback:M,value:P})),r.a.createElement(k.a,{item:!0,xs:12,md:4}),r.a.createElement(k.a,{item:!0,xs:12,md:8},r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},r.a.createElement(se.a,{style:{marginRight:"10px"},size:"small",color:"primary",onClick:function(){fetch("/api/experiments/latest").then((function(e){return e.json()})).then((function(e){h(e.experiment),b(e.description),w(e.organism_used),M(e.media_used)}))}},"Populate with previous experiment"),r.a.createElement(se.a,{variant:"contained",color:"primary",onClick:function(t){return t.preventDefault(),""===f?(c(!0),void m("Can't be blank.")):f.includes("#")||f.includes("+")||f.includes("/")?(c(!0),void m("Can't use #, / or + characters in experiment name.")):void fetch("/api/experiments",{method:"POST",body:JSON.stringify({experiment:f.trim(),created_at:a.toISOString(),description:v,mediaUsed:P,organismUsed:O}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(t){t.ok?(m(" "),c(!1),fetch("/api/stop_all",{method:"POST"}),e.handleNext()):409===t.status?(c(!0),m("Experiment name already used. Please choose another.")):(c(!0),m("Sever error. See UI logs."))}))},endIcon:r.a.createElement(Lt.a,null),disabled:""===f||i},"Save"))))))}function Ft(e){var t=Rt(),a=r.a.useState(0),n=Object(p.a)(a,2),o=n[0],i=n[1],c=r.a.useState(new Set),l=Object(p.a)(c,2),s=l[0],u=l[1],m=function(){if(o===d.length-1)window.location.href="/overview";else{var e=s;t=o,s.has(t)&&(e=new Set(e.values())).delete(o),i((function(e){return e+1})),u(e),window.scrollTo({top:0})}var t},d=[{title:"Experiment summary",content:r.a.createElement(Ut,{config:e.config,handleNext:m}),optional:!1},{title:"Assign labels",content:r.a.createElement(It,{config:e.config,handleNext:m}),optional:!0}];return r.a.createElement(I.a,{className:t.root},r.a.createElement(I.a,{className:t.cardContent},r.a.createElement(N.a,{variant:"h5",component:"h1"},"Start a new experiment"),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",{className:t.instructions},d[o].content),r.a.createElement("div",null,0!==o&&r.a.createElement("div",null,r.a.createElement(se.a,{color:"inherit",onClick:m,sx:{mr:1},className:t.skipButton},"Skip / Next")))))))}var Kt=function(e){var t=r.a.useState({}),a=Object(p.a)(t,2),n=a[0],o=a[1];return r.a.useEffect((function(){Object(g.a)(o)}),[]),r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(k.a,{container:!0,spacing:2},r.a.createElement(k.a,{item:!0,xs:12,md:12},r.a.createElement(Ft,{config:n})))},zt=a(291),Gt=Object(M.a)((function(e){return{title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0},textIcon:{fontSize:15,verticalAlign:"middle",margin:"0px 3px"}}}));function Ht(e){Gt();return r.a.createElement("div",null,r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"}},r.a.createElement(N.a,{variant:"h5",component:"h1"},r.a.createElement(U.a,{fontWeight:"fontWeightBold"},"Calibrations")),r.a.createElement(ae.a,null)))}var Yt=function(e){return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(k.a,{container:!0,spacing:2},r.a.createElement(k.a,{item:!0,md:12,xs:12},r.a.createElement(Ht,null)))},$t=a(45),qt=a(46),Jt=a(65),Vt=a(54),Zt=a(56),Qt=a(649),Xt=a(413),ea=Object(M.a)((function(e){return{root:{marginTop:"15px"},title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0}}})),ta=function(e){Object(Vt.a)(a,e);var t=Object(Zt.a)(a);function a(e){var n;return Object($t.a)(this,a),(n=t.call(this,e)).onSelectionChange=function(e){var t=e.target.value;n.setState({filename:t}),n.getConfig(t),n.getHistoricalConfigFiles(t)},n.onSelectionHistoricalChange=function(e){var t=e.target.value,a=n.state.historicalConfigs.findIndex((function(e){return e.timestamp===t})),r=n.state.historicalConfigs[a];n.setState({code:r.data,timestamp_ix:a})},n.getCodeFlaskRef=function(e){n.codeFlask=e},n.onTextChange=function(e){n.setState({code:e,hasChangedSinceSave:!0})},n.handleSnackbarClose=function(){n.setState({openSnackbar:!1})},n.state={code:"Loading...",openSnackbar:!1,filename:"config.ini",snackbarMsg:"",saving:!1,historicalConfigs:[{filename:"config.ini",data:"",timestamp:"2000-01-01"}],timestamp_ix:0,errorMsg:"",isError:!1,hasChangedSinceSave:!0,availableConfigs:[{name:"shared config.ini",filename:"config.ini"}]},n.saveCurrentCode=n.saveCurrentCode.bind(Object(Jt.a)(n)),n.deleteConfig=n.deleteConfig.bind(Object(Jt.a)(n)),n}return Object(qt.a)(a,[{key:"getConfig",value:function(e){var t=this;fetch("/api/configs/".concat(e)).then((function(e){return e.text()})).then((function(e){t.setState({code:e})}))}},{key:"getListOfConfigFiles",value:function(){var e=this;fetch("/api/configs").then((function(e){return e.json()})).then((function(t){e.setState((function(e){return{availableConfigs:[].concat(Object(O.a)(e.availableConfigs),Object(O.a)(t.filter((function(e){return"config.ini"!==e})).map((function(e){return{name:e,filename:e}}))))}}))}))}},{key:"getHistoricalConfigFiles",value:function(e){var t=this;fetch("/api/historical_configs/"+e).then((function(e){return e.json()})).then((function(e){e.shift(),t.setState({historicalConfigs:e,timestamp_ix:0})}))}},{key:"saveCurrentCode",value:function(){var e=this;this.setState({saving:!0,isError:!1}),fetch("/api/configs/".concat(this.state.filename),{method:"PATCH",body:JSON.stringify({code:this.state.code,filename:this.state.filename}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(t){t.ok?(e.setState({snackbarMsg:e.state.filename+" saved and synced.",hasChangedSinceSave:!1,saving:!1}),e.setState({openSnackbar:!0})):t.json().then((function(t){return e.setState({errorMsg:t.msg,isError:!0,hasChangedSinceSave:!0,saving:!1})}))}))}},{key:"deleteConfig",value:function(){var e=this;fetch("/api/configs/".concat(this.state.filename),{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(t){t.ok?e.setState({snackbarMsg:e.state.filename+" deleted."}):e.setState({snackbarMsg:"Hm. Something when wrong deleting..."}),e.setState({openSnackbar:!0}),setTimeout((function(){window.location.reload()}),750)}))}},{key:"componentDidMount",value:function(){this.getConfig(this.state.filename),this.getListOfConfigFiles(),this.getHistoricalConfigFiles(this.state.filename),this.setState({timestamp:this.state.historicalConfigs[0].timestamp})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"100%",margin:"10px",display:"flex",justifyContent:"space-between"}},r.a.createElement(D.a,null,r.a.createElement("div",null,r.a.createElement(Qt.a,{id:"configSelect",variant:"standard"},"Config file"),r.a.createElement(W.a,{labelId:"configSelect",variant:"standard",value:this.state.filename,onChange:this.onSelectionChange},this.state.availableConfigs.map((function(e){return r.a.createElement(R.a,{key:e.filename,value:e.filename},e.name)}))))),this.state.historicalConfigs.length>0?r.a.createElement(D.a,{style:{marginRight:"20px"}},r.a.createElement("div",null,r.a.createElement(Qt.a,{id:"configSelect",variant:"standard"},"Versions"),r.a.createElement(W.a,{labelId:"historicalConfigSelect",variant:"standard",value:this.state.historicalConfigs.length>0?this.state.historicalConfigs[this.state.timestamp_ix].timestamp:"",displayEmpty:!0,onChange:this.onSelectionHistoricalChange},this.state.historicalConfigs.map((function(e,t){return r.a.createElement(R.a,{key:e.timestamp,value:e.timestamp},0===t?"Current":S()(e.timestamp).format("MMM DD [at] hh:mm a"))}))))):r.a.createElement("div",null)),r.a.createElement("div",{style:{letterSpacing:"0em",margin:"10px auto 10px auto",position:"relative",width:"98%",height:"280px",border:"1px solid #ccc"}},r.a.createElement(Xt.CodeFlaskReact,{code:this.state.code,onChange:this.onTextChange,editorRef:this.getCodeFlaskRef,language:"python"})),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement("div",null,r.a.createElement(F.a,{style:{margin:"5px 12px 5px 12px"},color:"primary",variant:"contained",onClick:this.saveCurrentCode,disabled:!this.state.hasChangedSinceSave,loading:this.state.saving,loadingPosition:"end",endIcon:r.a.createElement(Lt.a,null)},0===this.state.timestamp_ix?"Save":"Revert"),r.a.createElement("p",{style:{marginLeft:12}},this.state.isError?r.a.createElement(U.a,{color:"error.main"},this.state.errorMsg):"")),r.a.createElement(se.a,{style:{margin:"5px 10px 5px 10px"},color:"secondary",onClick:this.deleteConfig,disabled:"config.ini"===this.state.filename},"Delete config file")),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:this.state.openSnackbar,onClose:this.handleSnackbarClose,message:this.state.snackbarMsg,autoHideDuration:2e3,key:"edit-config-snackbar"}))}}]),a}(r.a.Component);function aa(){var e=ea();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(N.a,{variant:"h5",component:"h2"},r.a.createElement(U.a,{fontWeight:"fontWeightBold"},"Configuration")))),r.a.createElement(I.a,{className:e.root},r.a.createElement(I.a,{className:e.cardContent},r.a.createElement(ta,null),r.a.createElement("p",{style:{textAlign:"center",marginTop:"30px"}},"Learn more about Pioreactor  ",r.a.createElement("a",{href:"https://docs.pioreactor.com/user-guide/configuration",target:"_blank",rel:"noopener noreferrer"},"configuration"),"."))))}var na=function(e){return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(k.a,{container:!0,spacing:2},r.a.createElement(k.a,{item:!0,md:12,xs:12},r.a.createElement(aa,null)))},ra=a(747),oa=a(156),ia=a.n(oa),ca=a(292),la=a.n(ca),sa=a(99),ua=a.n(sa),ma=a(414),da=a.n(ma),pa=a(769),_a=a(430),fa=a(768),ha=Object(M.a)({button:function(e){return e.buttonStyle},buttonDropdown:{}}),ga=r.a.forwardRef((function(e,t){var a=e.textPrefix,n=e.onChange,o=void 0===n?function(){}:n,i=e.onClick,c=void 0===i?function(){}:i,l=e.value,s=e.children,u=ha(e),m=t||r.a.useRef(null),d=r.a.useState(!1),_=Object(p.a)(d,2),f=_[0],h=_[1],g=r.a.useRef(l);g.current=l;var E,v=r.a.Children.map(s,(function(e){if(!e)return null;var t,a=g.current===e.props.value,n=e.props.children,i=a?r.a.createElement(ge.a,{style:{marginRight:"5px",verticalAlign:"-1px"}}):r.a.createElement(fa.a,{style:{marginRight:"5px",verticalAlign:"-1px"}});return r.a.createElement(R.a,{onClick:(t=e.props.value,function(e){h(!1),Object.defineProperty(e,"target",{writable:!0,value:{value:t}}),g.current=t,o(e)}),selected:a,role:"option","aria-selected":a?"true":void 0,"data-value-readable":n,"data-value":e.props.value,value:void 0},i,n)})).filter((function(e){return null!==e}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(pa.a,{variant:"contained",ref:m},r.a.createElement(se.a,{className:u.button,onClick:function(e){var t=g.current;Object.defineProperty(e,"target",{writable:!0,value:{value:t}}),g.current=t,c(e)},endIcon:e.endIcon,disabled:e.disabled},a,(E=g.current,v.find((function(e){return e.props["data-value"]===E})).props["data-value-readable"])),r.a.createElement(se.a,{className:u.buttonDropdown,size:"small",onClick:function(){return h(!0)},disabled:e.disabled},r.a.createElement(da.a,null))),r.a.createElement(_a.a,{open:f,onClose:function(){return h(!1)},getContentAnchorEl:null,anchorEl:m.current,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},v))}));ga.displayName="SelectButton";var Ea=ga,va=a(415),ba=a.n(va);function ya(){ya=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function l(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(k){l=function(e,t,a){return e[t]=a}}function s(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),c=new j(r||[]);return n(i,"_invoke",{value:y(e,a,c)}),i}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(k){return{type:"throw",arg:k}}}e.wrap=s;var m={};function d(){}function p(){}function _(){}var f={};l(f,o,(function(){return this}));var h=Object.getPrototypeOf,g=h&&h(h(C([])));g&&g!==t&&a.call(g,o)&&(f=g);var E=_.prototype=d.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var r;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(r,i){!function n(r,o,i,c){var l=u(e[r],e,o);if("throw"!==l.type){var s=l.arg,m=s.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(m).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}(n,o,r,i)}))}return r=r?r.then(i,i):i()}})}function y(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return S()}for(a.method=r,a.arg=o;;){var i=a.delegate;if(i){var c=x(i,a);if(c){if(c===m)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var l=u(e,t,a);if("normal"===l.type){if(n=a.done?"completed":"suspendedYield",l.arg===m)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n="completed",a.method="throw",a.arg=l.arg)}}}function x(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function C(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=_,n(E,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:p,configurable:!0}),p.displayName=l(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},v(b.prototype),l(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var i=new b(s(t,a,n,r),o);return e.isGeneratorFunction(a)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},v(E),l(E,c,"Generator"),l(E,o,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=C,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return i.type="throw",i.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),w(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;w(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:C(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}var xa=Object(M.a)((function(e){return{title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0},textIcon:{fontSize:15,verticalAlign:"middle",margin:"0px 3px"}}}));function Oa(e){var t=Object(Re.b)(),a=r.a.useState(!1),n=Object(p.a)(a,2),o=n[0],i=n[1],c=r.a.useState(!1),l=Object(p.a)(c,2),s=l[0],u=l[1],m=r.a.useState(!1),d=Object(p.a)(m,2),_=d[0],f=d[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ea,{buttonStyle:{textTransform:"none"},value:_?"development":"latest",onClick:function(){t({description:"To avoid possible data interruptions, we suggest updating between running experiments. "+(_?"We recommend being on the latest release of software before doing this. Confirm you are on the latest software before updating.":""),title:_?"Update to development build?":"Update to next release?",confirmationText:"Update",confirmationButtonProps:{color:"primary"},cancellationButtonProps:{color:"secondary"}}).then((function(){u(!0),_?fetch("/api/update_app_to_develop",{method:"POST"}):fetch("/api/update_app",{method:"POST"}),i(!0)}))},onChange:function(e){var t=e.target.value;return f("development"===t)},disabled:o,endIcon:_?r.a.createElement(ba.a,null):r.a.createElement(ia.a,null)},r.a.createElement(R.a,{value:"latest"},"Update to next release"),r.a.createElement(R.a,{value:"development"},"Update to development")),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:s,message:"Updating in the background. This may take a few minutes. You may leave this page.",autoHideDuration:2e4,key:"snackbar-update"}))}function wa(e){var t=xa(),a=r.a.useState(""),n=Object(p.a)(a,2),o=n[0],i=n[1],c=r.a.useState(""),l=Object(p.a)(c,2),s=l[0],u=l[1],m=r.a.useState(""),d=Object(p.a)(m,2),_=d[0],f=d[1];return r.a.useEffect((function(){function e(){return(e=Object(w.a)(ya().mark((function e(){return ya().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/versions/app").then((function(e){return e.text()})).then((function(e){i(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(w.a)(ya().mark((function e(){return ya().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/versions/ui").then((function(e){return e.text()})).then((function(e){u(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function a(){return(a=Object(w.a)(ya().mark((function e(){return ya().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.github.com/repos/pioreactor/pioreactor/releases/latest").then((function(e){return e.json()})).then((function(e){f(e.tag_name)})).catch((function(e){console.log("No internet connection?")}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}(),function(){e.apply(this,arguments)}(),function(){a.apply(this,arguments)}()}),[]),r.a.createElement("div",null,r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"}},r.a.createElement(N.a,{variant:"h5",component:"h1"},r.a.createElement(U.a,{fontWeight:"fontWeightBold"},"Updates")),r.a.createElement("div",null,r.a.createElement("div",{style:{float:"right",marginRight:"0px",marginLeft:"10px"}},r.a.createElement(Oa,null)),r.a.createElement(ra.a,{color:"inherit",underline:"none",href:"https://github.com/Pioreactor/pioreactor/releases/tag/".concat(_),target:"_blank",rel:"noopener noreferrer"},r.a.createElement(se.a,{style:{textTransform:"none",float:"right",marginRight:"0px"},color:"primary"},r.a.createElement(ua.a,{fontSize:"15",classes:{root:t.textIcon}})," View latest release")))),r.a.createElement(ae.a,null),r.a.createElement(N.a,{variant:"subtitle2"},r.a.createElement(U.a,{fontWeight:"fontWeightBold",style:{margin:"10px 2px 10px 2px",display:"inline-block"}},r.a.createElement(la.a,{style:{fontSize:14,verticalAlign:"-1px"}})," Version installed:"),r.a.createElement(U.a,{fontWeight:"fontWeightRegular",style:{marginRight:"20px",display:"inline-block"}},r.a.createElement(it,{title:"App: ".concat(o,"\nUI:  ").concat(s)}," ",o," ")),r.a.createElement(U.a,{fontWeight:"fontWeightBold",style:{margin:"10px 2px 10px 2px",display:"inline-block"}},r.a.createElement(ia.a,{style:{fontSize:14,verticalAlign:"-1px"}}),"Latest version available:"),r.a.createElement(U.a,{fontWeight:"fontWeightRegular",style:{marginRight:"20px",display:"inline-block"}},_)))}function ja(){var e=xa(),t=r.a.useState(""),a=Object(p.a)(t,2),n=a[0],o=a[1];return r.a.useEffect((function(){function e(){return(e=Object(w.a)(ya().mark((function e(){return ya().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://raw.githubusercontent.com/Pioreactor/pioreactor/master/CHANGELOG.md").then((function(e){return e.text()})).then((function(e){o(e)})).catch((function(e){o("Could not retrieve latest Changelog. Are you missing an internet connection? You can find the latest changelog at [https://github.com/pioreactor/pioreactor/master/CHANGELOG.md](https://github.com/pioreactor/pioreactor/master/CHANGELOG.md)")}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(I.a,{className:e.root},r.a.createElement(I.a,{className:e.cardContent},r.a.createElement(N.a,{variant:"h6",component:"h6"},"Change log"),r.a.createElement(zt.a,{markdown:n}))))}var Ca=function(e){return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(k.a,{container:!0,spacing:2},r.a.createElement(k.a,{item:!0,md:12,xs:12},r.a.createElement(wa,null),r.a.createElement(ja,null)))},Sa=a(304),ka=a(765),Pa=a(762),Ma=a(416),La=a.n(Ma),Da=a(748),Ta=a(154),Ba=a.n(Ta);function Aa(){Aa=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function l(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(k){l=function(e,t,a){return e[t]=a}}function s(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),c=new j(r||[]);return n(i,"_invoke",{value:y(e,a,c)}),i}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(k){return{type:"throw",arg:k}}}e.wrap=s;var m={};function d(){}function p(){}function _(){}var f={};l(f,o,(function(){return this}));var h=Object.getPrototypeOf,g=h&&h(h(C([])));g&&g!==t&&a.call(g,o)&&(f=g);var E=_.prototype=d.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var r;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(r,i){!function n(r,o,i,c){var l=u(e[r],e,o);if("throw"!==l.type){var s=l.arg,m=s.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(m).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}(n,o,r,i)}))}return r=r?r.then(i,i):i()}})}function y(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return S()}for(a.method=r,a.arg=o;;){var i=a.delegate;if(i){var c=x(i,a);if(c){if(c===m)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var l=u(e,t,a);if("normal"===l.type){if(n=a.done?"completed":"suspendedYield",l.arg===m)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n="completed",a.method="throw",a.arg=l.arg)}}}function x(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function C(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=_,n(E,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:p,configurable:!0}),p.displayName=l(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},v(b.prototype),l(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var i=new b(s(t,a,n,r),o);return e.isGeneratorFunction(a)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},v(E),l(E,c,"Generator"),l(E,o,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=C,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return i.type="throw",i.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),w(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;w(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:C(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}var Ia=Object(M.a)((function(e){return{root:{marginTop:"15px"},title:{fontSize:14},cardContent:{padding:"25px"},pos:{marginBottom:0},pluginList:{width:"92%",margin:"auto",marginBottom:"15px"},primaryActionButton:{marginLeft:"5px"},secondaryActionButton:{marginLeft:"15px"}}}));function Ra(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(N.a,{variant:"h5",component:"h2"},r.a.createElement(U.a,{fontWeight:"fontWeightBold"},"Plugins")))))}function Na(e){var t=e.alreadyInstalledPluginsNames,a=Ia(),n=r.a.useState([]),o=Object(p.a)(n,2),i=o[0],c=o[1],s=r.a.useState(!1),u=Object(p.a)(s,2),m=u[0],d=u[1],_=r.a.useState(""),f=Object(p.a)(_,2),h=f[0],g=f[1];r.a.useEffect((function(){function e(){return(e=Object(w.a)(Aa().mark((function e(){return Aa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://raw.githubusercontent.com/Pioreactor/list-of-plugins/main/plugins.json").then((function(e){return e.json()})).then((function(e){c(e)})).catch((function(e){}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:a.pluginList},r.a.createElement(Me.a,{dense:!0},i.filter((function(e){return!t.includes(e.name)})).map((function(e){return r.a.createElement(De.a,{key:e.name},r.a.createElement(ka.a,null,r.a.createElement(Da.a,{variant:"square",style:{backgroundColor:"#FFFFFF"}},r.a.createElement(Sa.Hashicon,{value:e.name,size:40}))),r.a.createElement(Pe.a,{primary:e.name,secondary:e.description,style:{maxWidth:"525px"}}),r.a.createElement(Pa.a,{sx:{display:{xs:"contents",md:"block"}}},r.a.createElement(se.a,{onClick:(t=e.name,function(){d(!0),g("Installing ".concat(t," in the background...")),fetch("/api/install_plugin",{method:"POST",body:JSON.stringify({plugin_name:t}),headers:{Accept:"application/json","Content-Type":"application/json"}})}),variant:"contained",size:"small","aria-label":"install",color:"primary",endIcon:r.a.createElement(Ba.a,null),className:a.primaryActionButton},"Install"),r.a.createElement(se.a,{component:l.b,target:"_blank",rel:"noopener noreferrer",to:e.homepage,variant:"text",size:"small",color:"primary","aria-label":"view homepage",disabled:!e.homepage||"Unknown"===e.homepage,endIcon:r.a.createElement(ua.a,null),className:a.secondaryActionButton},"View")));var t})))),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:m,onClose:function(e,t){"clickaway"!==t&&d(!1)},message:h,autoHideDuration:1e4,key:"snackbar-available"}))}function Wa(e){var t=e.installedPlugins,a=r.a.useState(!1),n=Object(p.a)(a,2),o=n[0],i=n[1],c=r.a.useState(""),s=Object(p.a)(c,2),u=s[0],m=s[1],d=Ia();return t.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:d.pluginList},r.a.createElement(Me.a,{dense:!0},t.map((function(e){return r.a.createElement(De.a,{key:e.name},r.a.createElement(ka.a,null,r.a.createElement(Da.a,{variant:"square",style:{backgroundColor:"#FFFFFF"}},r.a.createElement(Sa.Hashicon,{value:e.name,size:40}))),r.a.createElement(Pe.a,{primary:"".concat(e.name," ").concat("Unknown"===e.version?"":"("+e.version+")"),secondary:"".concat("Unknown"===e.description?"No description provided.":e.description),style:{maxWidth:"525px"}}),r.a.createElement(Pa.a,{sx:{display:{xs:"contents",md:"block"}}},r.a.createElement(se.a,{onClick:(t=e.source.startsWith("plugins/")?e.source.slice(8,-3):e.name,function(){i(!0),m("Uninstalling ".concat(t," in the background...")),fetch("/api/uninstall_plugin",{method:"POST",body:JSON.stringify({plugin_name:t}),headers:{Accept:"application/json","Content-Type":"application/json"}})}),variant:"text",size:"small",color:"primary","aria-label":"delete",endIcon:r.a.createElement(La.a,null),className:d.primaryActionButton},"Uninstall"),!e.source.startsWith("plugins/")&&r.a.createElement(se.a,{component:l.b,target:"_blank",rel:"noopener noreferrer",to:e.homepage,variant:"text",size:"small",color:"primary","aria-label":"view homepage",disabled:!e.homepage||"Unknown"===e.homepage,endIcon:r.a.createElement(ua.a,null),className:d.secondaryActionButton},"View"),e.source.startsWith("plugins/")&&r.a.createElement(se.a,{component:l.b,target:"_blank",rel:"noopener noreferrer",to:"/api/installed_plugins/".concat(e.source.slice(8)),variant:"text",size:"small",color:"primary","aria-label":"view homepage",endIcon:r.a.createElement(ua.a,null),className:d.secondaryActionButton},"View")));var t})))),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:o,onClose:function(e,t){"clickaway"!==t&&i(!1)},message:u,autoHideDuration:7e3,key:"snackbar-installation"})):r.a.createElement("div",{style:{textAlign:"center",marginBottom:"50px",marginTop:"50px"}},r.a.createElement(N.a,null,r.a.createElement(U.a,{fontWeight:"fontWeightRegular"},"No installed plugins. Try installing one below, or read more about ",r.a.createElement("a",{href:"https://docs.pioreactor.com/user-guide/using-community-plugins",target:"_blank",rel:"noopener noreferrer"},"Pioreactor plugins"),".")))}function Ua(){var e=Ia(),t=r.a.useState([]),a=Object(p.a)(t,2),n=a[0],o=a[1],i=r.a.useState(!1),c=Object(p.a)(i,2),l=c[0],s=c[1];return r.a.useEffect((function(){function e(){return(e=Object(w.a)(Aa().mark((function e(){return Aa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/installed_plugins").then((function(e){return e.json()})).then((function(e){s(!0),o(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Ra,null),r.a.createElement(I.a,{className:e.root},r.a.createElement(I.a,{className:e.cardContent},r.a.createElement("p",null," Discover, install, and manage Pioreactor plugins created by the community. These plugins can provide new functionalities for your Pioreactor (additional hardware may be necessary), or new automations to control dosing, temperature and LED tasks."),r.a.createElement(N.a,{variant:"h6",component:"h3"},"Installed plugins"),l&&r.a.createElement(Wa,{installedPlugins:n}),!l&&r.a.createElement("div",{style:{textAlign:"center",marginBottom:"50px",marginTop:"50px"}},r.a.createElement(ne.a,{size:33})),r.a.createElement(N.a,{variant:"h6",component:"h3"},"Available plugins from the community"),r.a.createElement(Na,{alreadyInstalledPluginsNames:n.map((function(e){return e.name}))}),r.a.createElement("p",{style:{textAlign:"center",marginTop:"30px"}},"Learn more about Pioreactor ",r.a.createElement("a",{href:"https://docs.pioreactor.com/user-guide/using-community-plugins",target:"_blank",rel:"noopener noreferrer"},"plugins"),"."))))}var Fa=function(e){return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(k.a,{container:!0,spacing:2},r.a.createElement(k.a,{item:!0,md:12,xs:12},r.a.createElement(Ua,null)))},Ka=a(418),za=a.n(Ka),Ga=a(440),Ha=Object(M.a)((function(e){return{cardContent:{padding:"10px"},DisplayProfileCard:{maxHeight:"350px",overflow:"auto",backgroundColor:"rgb(248,248,248)",letterSpacing:"0em",margin:"10px auto 10px auto",position:"relative",width:"98%",border:"1px solid #ccc",borderRadius:"0px",boxShadow:"none"}}})),Ya=function(e,t){return 0===t?"".concat(e," immediately"):t<1?"".concat(e," after ").concat(Math.round(60*t*10)/10," minutes"):1===t?"".concat(e," after ").concat(t," hour"):"".concat(e," after ").concat(t," hours")},$a=function(e){var t=e.data,a=Ha();return r.a.createElement(I.a,{className:a.DisplayProfileCard},r.a.createElement(Ga.a,{className:a.cardContent},r.a.createElement(N.a,{variant:"h6"},t.experiment_profile_name),r.a.createElement(N.a,{sx:{mb:1.5},color:"text.secondary",gutterBottom:!0},"Created by ",t.metadata.author),r.a.createElement(N.a,{variant:"body2"},r.a.createElement("b",null,"Description:")," ",t.metadata.description),r.a.createElement("br",null),t.labels&&Object.keys(t.labels).length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{variant:"body2"},r.a.createElement("b",null,"Labels:")),Object.keys(t.labels).map((function(e){return r.a.createElement(N.a,{key:e,variant:"body2",style:{marginLeft:"2em"}},e," \u21dd ",t.labels[e])})),r.a.createElement("br",null)),r.a.createElement(N.a,{variant:"body2"},r.a.createElement("b",null,"All Pioreactor(s) do:")),t.common&&Object.keys(t.common).map((function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{key:e,variant:"body2",style:{marginLeft:"2em"}},r.a.createElement("b",null,"Job"),": ",e),t.common[e].actions.sort((function(e,t){return e.hours_elapsed>t.hours_elapsed})).map((function(e,t){return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{key:"common-action-".concat(t),variant:"body2",style:{marginLeft:"4em"}},r.a.createElement("b",null,"Action ",t+1),": ",Ya(e.type,e.hours_elapsed)),Object.keys(e.options).map((function(t,a){return r.a.createElement(N.a,{key:"common-".concat(t,"-").concat(e,"-").concat(a),variant:"body2",style:{marginLeft:"8em"}},t,": ",e.options[t])})))})))})),r.a.createElement("br",null),t.pioreactors&&Object.keys(t.pioreactors).map((function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{key:e,variant:"body2"},r.a.createElement("b",null,e," does:")),Object.keys(t.pioreactors[e].jobs).map((function(a){return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{key:"".concat(e,"-").concat(a),variant:"body2",style:{marginLeft:"2em"}},r.a.createElement("b",null,"Job"),": ",a),t.pioreactors[e].jobs[a].actions.sort((function(e,t){return e.hours_elapsed>t.hours_elapsed})).map((function(t,a){return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{key:"".concat(e,"-action-").concat(a),variant:"body2",style:{marginLeft:"4em"}},r.a.createElement("b",null,"Action ",a+1),": ",Ya(t.type,t.hours_elapsed)),Object.keys(t.options).map((function(a,n){return r.a.createElement(N.a,{key:"".concat(e,"-").concat(a,"-").concat(t,"-").concat(n),variant:"body2",style:{marginLeft:"8em"}},a,": ",t.options[a])})))})))})),r.a.createElement("br",null))}))))},qa=Object(M.a)((function(e){return{cardContent:{padding:"10px"},DisplayProfileCard:{maxHeight:"350px",overflow:"auto",backgroundColor:"rgb(248,248,248)",letterSpacing:"0em",margin:"10px auto 10px auto",position:"relative",width:"98%",border:"1px solid #ccc",borderRadius:"0px",boxShadow:"none"}}})),Ja=function(e){var t=e.sourceCode,a=qa();return r.a.createElement(I.a,{className:a.DisplayProfileCard},r.a.createElement(Ga.a,{className:a.cardContent},r.a.createElement("pre",null,t)))},Va=a(417),Za=a.n(Va),Qa=Object(M.a)((function(e){return{root:{marginTop:"15px"},formControl:{margin:e.spacing(2)},title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0},caption:{marginLeft:"30px",maxWidth:"650px"},headerMenu:Object(j.a)({display:"flex",justifyContent:"space-between",marginBottom:"5px"},e.breakpoints.down("lg"),{flexFlow:"nowrap",flexDirection:"column"}),headerButtons:{display:"flex",flexDirection:"row",justifyContent:"flex-start",flexFlow:"wrap"}}}));function Xa(e){var t=r.a.useState([]),a=Object(p.a)(t,2),n=a[0],o=a[1],i=r.a.useState(""),c=Object(p.a)(i,2),l=c[0],s=c[1],u=r.a.useState(!1),m=Object(p.a)(u,2),d=m[0],_=m[1],f=r.a.useState(!1),h=Object(p.a)(f,2),E=h[0],v=h[1],b=r.a.useState(""),y=Object(p.a)(b,2),O=y[0],w=y[1];r.a.useEffect((function(){fetch("/api/experiment_profiles").then((function(e){return e.json()})).then((function(e){var t,a=e.reduce((function(e,t){return Object(x.a)(Object(x.a)({},e),{},Object(j.a)({},t.file,t.experimentProfile))}),{});o(a),s(null!==(t=Object.keys(a)[0])&&void 0!==t?t:"")}))}),[]),r.a.useEffect((function(){document.title=e.title}),[e.title]);return r.a.createElement(k.a,{container:!0,spacing:1},r.a.createElement(k.a,{item:!0,xs:6},r.a.createElement("div",{style:{width:"100%",margin:"10px",display:"flex",justifyContent:"space-between"}},r.a.createElement(D.a,{style:{minWidth:"300px"}},r.a.createElement(Qt.a,{id:"profileSelect",variant:"standard"},"Experiment profile"),r.a.createElement(W.a,{labelId:"profileSelect",variant:"standard",value:l,onChange:function(e){s(e.target.value),v(!1)},label:"Experiment profile"},Object.keys(n).map((function(e){var t=n[e];return r.a.createElement(R.a,{key:e,value:e},t.experiment_profile_name," (from ",e.split("/").pop(),")")})))))),r.a.createElement(k.a,{item:!0,xs:4}),r.a.createElement(k.a,{container:!0,xs:2,direction:"column",alignItems:"flex-end"},r.a.createElement(k.a,{item:!0,xs:6}),r.a.createElement(k.a,{item:!0,xs:6},r.a.createElement(se.a,{variant:"text",size:"small",color:"primary","aria-label":"view source code",disabled:""===l,endIcon:r.a.createElement(Za.a,null),onClick:function(e){E||fetch("/api/experiment_profiles/".concat(l.split("/").pop()),{method:"GET"}).then((function(e){if(e.ok)return e.text()})).then((function(e){w(e)})),v(!E)},style:{marginRight:"10px"}},"View source"))),r.a.createElement(k.a,{item:!0,xs:12},""!==l&&!E&&r.a.createElement($a,{data:n[l]}),""!==l&&E&&r.a.createElement(Ja,{sourceCode:O})),r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},r.a.createElement(se.a,{variant:"contained",color:"primary",style:{marginLeft:"20px"},onClick:function(){var t;return Object(g.c)(null===(t=e.config["cluster.topology"])||void 0===t?void 0:t.leader_hostname,"experiment_profile",["execute",l],{},(function(){return _(!0)}))},endIcon:r.a.createElement(za.a,null),disabled:""===l||d},"Execute"),r.a.createElement(se.a,{variant:"text",color:"secondary",style:{marginLeft:"20px"},onClick:function(){var t;fetch("/api/stop/".concat(null===(t=e.config["cluster.topology"])||void 0===t?void 0:t.leader_hostname,"/experiment_profile"),{method:"PATCH"})},endIcon:r.a.createElement(fe.a,null)},"Stop")))}function en(e){var t=Qa();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(N.a,{variant:"h5",component:"h2"},r.a.createElement(U.a,{fontWeight:"fontWeightBold"},"Experiment Profiles")))),r.a.createElement(I.a,{className:t.root},r.a.createElement(I.a,{className:t.cardContent},r.a.createElement(Xa,{config:e.config}),r.a.createElement("p",{style:{textAlign:"center",marginTop:"30px"}},"Learn more about ",r.a.createElement("a",{href:"https://docs.pioreactor.com/user-guide/experiment-profiles",target:"_blank",rel:"noopener noreferrer"},"experiment profiles"),"."))))}var tn=function(e){var t=r.a.useState({}),a=Object(p.a)(t,2),n=a[0],o=a[1];return r.a.useEffect((function(){Object(g.a)(o)}),[]),r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(k.a,{container:!0,spacing:2},r.a.createElement(k.a,{item:!0,md:12,xs:12},r.a.createElement(en,{config:n})))},an=a(419),nn=Object(M.a)((function(e){return{root:{marginTop:"15px"},title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0},textField:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},formControl:{margin:e.spacing(3)},halfTextField:{width:"70%"}}}));function rn(e){var t=nn(),a=r.a.useState(!1),n=Object(p.a)(a,2),o=n[0],i=n[1],c=r.a.useState(""),l=Object(p.a)(c,2),s=l[0],u=l[1],m=r.a.useState(""),d=Object(p.a)(m,2),_=d[0],f=d[1],h=r.a.useState(""),g=Object(p.a)(h,2),E=g[0],v=g[1],b=r.a.useState(!1),y=Object(p.a)(b,2),x=y[0],O=y[1],w=r.a.useState(!1),j=Object(p.a)(w,2),C=j[0],S=j[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement(N.a,{variant:"h5",component:"h2"},r.a.createElement(U.a,{fontWeight:"fontWeightBold"},"Share feedback"))),r.a.createElement(I.a,{className:t.root},r.a.createElement(I.a,{className:t.cardContent},r.a.createElement("p",null,"Include your email, and we may get back to you with some questions or advice about your provided feedback. We appreciate all feedback sent to us!"),r.a.createElement(T.a,null,r.a.createElement(k.a,{container:!0,spacing:1},r.a.createElement(k.a,{item:!0,xs:12,md:6},r.a.createElement(re.a,{error:o,id:"email",type:"email",label:"Email",required:!0,onChange:function(e){i(!1),u(""),f(e.target.value)},className:"".concat(t.halfTextField," ").concat(t.textField),value:_,helperText:s})),r.a.createElement(k.a,{item:!0,xs:12,md:12},r.a.createElement(re.a,{label:"What went wrong? What went right? What are you unsure about?",maxRows:4,multiline:!0,required:!0,onChange:function(e){v(e.target.value)},value:E,className:t.textField,minRows:3,fullWidth:!0})),r.a.createElement(k.a,{item:!0,xs:12,md:12},r.a.createElement(F.a,{loading:x,variant:"contained",color:"primary",disabled:C,onClick:function(e){if(e.preventDefault(),""===_)return i(!0),void u("Can't be blank.");O(!0),fetch("https://us-central1-pioreactor-backend.cloudfunctions.net/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:_,message:E})}),O(!1),S(!0)}},C?"Submitted":"Submit")))))))}var on=function(e){return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(k.a,{container:!0,spacing:3},r.a.createElement(k.a,{item:!0,md:12,xs:12},r.a.createElement(rn,null)))},cn=a(749),ln=a(739),sn=a(428),un=a.n(sn),mn=a(423),dn=a.n(mn),pn=a(766),_n=a(770),fn=a(426),hn=a.n(fn),gn=a(420),En=a.n(gn),vn=a(422),bn=a.n(vn),yn=a(425),xn=a.n(yn),On=a(424),wn=a.n(On),jn=a(421),Cn=a.n(jn),Sn=a(427),kn=a.n(Sn),Pn=a(59);function Mn(){Mn=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function l(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(k){l=function(e,t,a){return e[t]=a}}function s(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),c=new j(r||[]);return n(i,"_invoke",{value:y(e,a,c)}),i}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(k){return{type:"throw",arg:k}}}e.wrap=s;var m={};function d(){}function p(){}function _(){}var f={};l(f,o,(function(){return this}));var h=Object.getPrototypeOf,g=h&&h(h(C([])));g&&g!==t&&a.call(g,o)&&(f=g);var E=_.prototype=d.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var r;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(r,i){!function n(r,o,i,c){var l=u(e[r],e,o);if("throw"!==l.type){var s=l.arg,m=s.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(m).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}(n,o,r,i)}))}return r=r?r.then(i,i):i()}})}function y(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return S()}for(a.method=r,a.arg=o;;){var i=a.delegate;if(i){var c=x(i,a);if(c){if(c===m)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var l=u(e,t,a);if("normal"===l.type){if(n=a.done?"completed":"suspendedYield",l.arg===m)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n="completed",a.method="throw",a.arg=l.arg)}}}function x(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function C(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=_,n(E,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:p,configurable:!0}),p.displayName=l(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},v(b.prototype),l(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var i=new b(s(t,a,n,r),o);return e.isGeneratorFunction(a)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},v(E),l(E,c,"Generator"),l(E,o,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=C,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return i.type="throw",i.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),w(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;w(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:C(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}var Ln=Object(M.a)((function(e){return{root:{display:"flex"},drawer:Object(j.a)({},e.breakpoints.up("sm"),{width:230,flexShrink:0}),menuButton:{marginRight:e.spacing(2)},drawerPaper:{width:230},title:{flexGrow:1},appBarRoot:Object(j.a)({},e.breakpoints.up("sm"),{zIndex:e.zIndex.drawer+1}),listItemIcon:{minWidth:"40px"},divider:{marginTop:"15px",marginBottom:"15px"}}}));function Dn(){var e=Ln(),t=Object(c.k)(),a=r.a.useState(!1),n=Object(p.a)(a,2),o=n[0],i=n[1],s=r.a.useState(null),u=Object(p.a)(s,2),m=u[0],d=u[1],_=r.a.useState(null),f=Object(p.a)(_,2),h=f[0],g=f[1];r.a.useEffect((function(){function e(){return(e=Object(w.a)(Mn().mark((function e(){return Mn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/versions/app").then((function(e){return e.text()})).then((function(e){d(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(w.a)(Mn().mark((function e(){return Mn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.github.com/repos/pioreactor/pioreactor/releases/latest").then((function(e){return e.json()})).then((function(e){g(e.tag_name)})).catch((function(e){}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}()}),[]);var E=function(){i(!o)};function v(e){return t.pathname===e}var b=function(){return r.a.createElement(Pn.d,null,r.a.createElement(Pn.a,{style:{minWidth:"230px",width:"230px"},renderExpandIcon:function(e){e.level,e.active,e.disabled;return null},menuItemStyles:{label:{whiteSpace:"pre-wrap"},button:function(e){var t=e.level,a=e.active,n=e.disabled;if(0===t)return{color:n?"#00000050":a?"#5331ca":"inherit",backgroundColor:a?"#5331ca14":void 0}},icon:function(e){e.level;var t=e.active;return{color:e.disabled?"#00000050":t?"#5331ca":"#0000008a"}}}},r.a.createElement(Pn.b,{icon:r.a.createElement(En.a,null),component:r.a.createElement(l.b,{to:"/overview",className:"link"}),active:v("/")||v("/overview")},"Overview"),r.a.createElement(Pn.b,{icon:r.a.createElement(Fe.a,{viewBox:"-3 0 24 24"}),component:r.a.createElement(l.b,{to:"/pioreactors",className:"link"}),active:v("/pioreactors")},"Pioreactors"),r.a.createElement(Pn.b,{icon:r.a.createElement(Cn.a,null),component:r.a.createElement(l.b,{to:"/experiment-profiles",className:"link"}),active:v("/experiment-profiles")},"Profiles"),r.a.createElement(Pn.b,{icon:r.a.createElement(bn.a,null),component:r.a.createElement(l.b,{to:"/config",className:"link"}),active:v("/config")},"Configuration"),r.a.createElement(Pn.b,{icon:r.a.createElement(dn.a,null),component:r.a.createElement(l.b,{to:"/export-data",className:"link"}),active:v("/export-data")},"Export data"),r.a.createElement(Pn.b,{icon:r.a.createElement(wn.a,null),component:r.a.createElement(l.b,{to:"/experiments",className:"link"}),active:v("/experiments")},"Past experiments"),r.a.createElement(Pn.b,{icon:r.a.createElement(xn.a,null),component:r.a.createElement(l.b,{to:"/analysis",className:"link"}),active:v("/analysis"),disabled:!0},"Analysis"),r.a.createElement(Pn.b,{icon:r.a.createElement(Oe.a,null),component:r.a.createElement(l.b,{to:"/calibrations",className:"link"}),active:v("/calibrations"),disabled:!0},"Calibrations"),r.a.createElement(ae.a,{className:e.divider}),r.a.createElement(Pn.b,{icon:r.a.createElement(hn.a,null),component:r.a.createElement(l.b,{to:"/plugins",className:"link"}),active:v("/plugins")},"Plugins"),r.a.createElement(Pn.b,{icon:r.a.createElement(ln.a,{variant:"dot",color:"secondary",invisible:!(m&&h&&m!==h)},r.a.createElement(ia.a,null)),component:r.a.createElement(l.b,{to:"/updates",className:"link"}),active:v("/updates")},"Updates"),r.a.createElement(Pn.b,{icon:r.a.createElement(Ue.a,null),component:r.a.createElement(l.b,{target:"_blank",rel:"noopener noreferrer",to:{pathname:"https://docs.pioreactor.com"},className:"link"}),suffix:r.a.createElement(ua.a,{style:{fontSize:"15px",verticalAlign:"middle"}})},"Help"),r.a.createElement(Pn.b,{icon:r.a.createElement(kn.a,null),component:r.a.createElement(l.b,{target:"_blank",rel:"noopener noreferrer",to:{pathname:"https://forum.pioreactor.com"},className:"link"}),suffix:r.a.createElement(ua.a,{style:{fontSize:"15px",verticalAlign:"middle"}})},"Forums")))};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:e.appBarRoot},r.a.createElement(_n.a,{position:"fixed"},r.a.createElement(pn.a,{variant:"dense"},r.a.createElement(Le.a,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:E,classes:{root:e.menuButton},sx:{display:{xs:"block",sm:"none"}},size:"large"},r.a.createElement(un.a,null)),r.a.createElement(N.a,{variant:"h6",className:e.title},r.a.createElement(l.b,{color:"inherit",underline:"none",to:"/",className:e.title},r.a.createElement("img",{alt:"pioreactor logo",src:"/white_colour.png",style:{width:"120px",height:"29px"}})," ")),r.a.createElement(se.a,{component:l.b,target:"_blank",rel:"noopener noreferrer",to:{pathname:"https://docs.pioreactor.com"},color:"inherit",style:{textTransform:"none"}},"Help ",r.a.createElement(Ue.a,{style:{fontSize:18,verticalAlign:"middle",marginLeft:5}}))))),r.a.createElement(cn.a,{variant:"temporary",anchor:"left",open:o,onClose:E,classes:{paper:e.drawerPaper},ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"}}},b()),r.a.createElement(cn.a,{classes:{paper:e.drawerPaper},variant:"permanent",open:!0,className:e.drawer,sx:{display:{xs:"none",sm:"block"}}},r.a.createElement(pn.a,null),b()))}var Tn=function(e){Object(Vt.a)(a,e);var t=Object(Zt.a)(a);function a(e){var n;return Object($t.a)(this,a),(n=t.call(this,e)).state={hasError:!1,errorMsg:""},n}return Object(qt.a)(a,[{key:"componentDidCatch",value:function(e,t){console.log(e),this.setState({errorMsg:e.message})}},{key:"render",value:function(){return this.state.hasError?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{maxWidth:700,margin:"auto"}},r.a.createElement("div",null,r.a.createElement("h1",null,"Something went wrong with the PioreactorUI!"),r.a.createElement("h3",null,"Don't worry. It's our fault. Here's what you can do:"),r.a.createElement("p",null," Looks like there's a bug in the UI. See the below for error information. We would appreciate it if you create an issue in ",r.a.createElement("a",{href:"https://github.com/Pioreactor/pioreactorui/issues"},"Github")," for us, with the information below.")),r.a.createElement("div",null,r.a.createElement("code",null,this.state.errorMsg)))):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),a}(r.a.Component),Bn=(a(628),a(629),a(630),a(631),a(382),Object(s.a)({palette:{background:{default:"#f6f6f7"},primary:{main:"#5331CA"},secondary:{main:"#f44336"}}}));function An(){var e=Object(c.k)().pathname;return r.a.useEffect((function(){window.scrollTo(0,0)}),[e]),null}function In(){return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(Tn,null,r.a.createElement(Dn,null),r.a.createElement("main",{style:{flexGrow:1,paddingTop:Bn.spacing(9),paddingLeft:Bn.spacing(4),paddingRight:Bn.spacing(4)}},r.a.createElement("div",{className:"pageContainer"},r.a.createElement(c.c,null,r.a.createElement(c.a,{path:"/export-data",element:r.a.createElement(J,{title:"Pioreactor ~ Export data"})}),r.a.createElement(c.a,{path:"/start-new-experiment",element:r.a.createElement(Kt,{title:"Pioreactor ~ Start new experiment"})}),r.a.createElement(c.a,{path:"/overview",element:r.a.createElement(y.a,{title:"Pioreactor ~ Overview"})}),r.a.createElement(c.a,{path:"/plugins",element:r.a.createElement(Fa,{title:"Pioreactor ~ Plugins"})}),r.a.createElement(c.a,{path:"/experiments",element:r.a.createElement(an.a,{title:"Pioreactor ~ Past experiments"})}),r.a.createElement(c.a,{path:"/experiment-profiles",element:r.a.createElement(tn,{title:"Pioreactor ~ Experiment profiles"})}),r.a.createElement(c.a,{path:"/config",element:r.a.createElement(na,{title:"Pioreactor ~ Configuration"})}),r.a.createElement(c.a,{path:"/pioreactors",element:r.a.createElement(St,{title:"Pioreactor ~ Pioreactors"})}),r.a.createElement(c.a,{path:"/updates",element:r.a.createElement(Ca,{title:"Pioreactor ~ Updates"})}),r.a.createElement(c.a,{path:"/feedback",element:r.a.createElement(on,{title:"Pioreactor ~ Feedback"})}),r.a.createElement(c.a,{path:"/calibrations",element:r.a.createElement(Yt,{title:"Pioreactor ~ Calibrations"})}),r.a.createElement(c.a,{path:"/",element:r.a.createElement(y.a,{title:"Pioreactor ~ Overview"})})),r.a.createElement(b,null),r.a.createElement(v,null)))))}var Rn=function(){return r.a.createElement(r.a.StrictMode,null,r.a.createElement(d.a,{injectFirst:!0},r.a.createElement(u.a,{theme:Bn},r.a.createElement(l.a,null,r.a.createElement(Pn.c,null,r.a.createElement(An,null),r.a.createElement(Re.a,null,r.a.createElement(m.a,null),r.a.createElement(In,null)))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Rn,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},64:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(306);t.a=function(e){return r.a.createElement(o.a,e,r.a.createElement("g",{id:"PioreactorIcon1",stroke:"none",strokeWidth:"1",fill:e.fillColor||"none",fillRule:"evenodd"},r.a.createElement("g",{id:"PioreactorIcon2",transform:"translate(-728.000000, -1502.000000)",stroke:"currentColor",strokeWidth:"1.8"},r.a.createElement("g",{id:"PioreactorIcon3",transform:"translate(729.000000, 1503.000000)"},r.a.createElement("path",{d:"M1.4,18.9 L1.4,14.7 L0,14.7 L0,11.2 L2.799,11.2 L2.8,0 L14,0 L13.999,11.2 L16.8,11.2 L16.8,14.7 L15.399,14.7 L15.4,18.9 L1.4,18.9 Z",id:"Combined-Shape"}),r.a.createElement("circle",{id:"Oval",cx:"8.4",cy:"13.3",r:"2.1"})))))}}},[[480,1,2]]]);
//# sourceMappingURL=main.5e1e672b.chunk.js.map
