(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{352:function(e,t,a){},431:function(e,t,a){e.exports=a(591)},436:function(e,t,a){},591:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(115),o=a.n(i),l=(a(436),a(6)),c=a(263),s=a(38),m=a(387),u=a(734),d=a(671),p=a(670),f=a(27),g=a(682),h=a(697),E=a(685);var b=function(e){var t=r.a.useState(""),a=Object(l.a)(t,2),n=a[0],i=a[1],o=r.a.useState(""),c=Object(l.a)(o,2),s=c[0],m=c[1],u=r.a.useState(!1),d=Object(l.a)(u,2),p=d[0],b=d[1],v=r.a.useState({}),y=Object(l.a)(v,2),x=y[0],_=y[1];return r.a.useEffect((function(){fetch("/get_current_unit_labels").then((function(e){return e.json()})).then((function(e){_(e)}))}),[]),r.a.useEffect((function(){if(e.config["cluster.topology"]){var t;(t=e.config.remote&&e.config.remote.ws_url?new f.Client("ws://".concat(e.config.remote.ws_url,"/"),"webui_TactileButtonNotification"+Math.random()):new f.Client("".concat(e.config["cluster.topology"].leader_address),9001,"webui_TactileButtonNotification"+Math.random())).connect({onSuccess:function(){t.subscribe(["pioreactor","+","$experiment","monitor","button_down"].join("/"),{qos:1})},timeout:180,reconnect:!0}),t.onMessageArrived=function(e){if("True"===e.payloadString){var t=e.topic.split("/")[1];i(t);try{m(x[t])}catch(a){}b(!0)}else b(!1)}}}),[e.config,x]),r.a.createElement(E.a,{open:p,autoHideDuration:null,onClose:function(){},anchorOrigin:{vertical:"bottom",horizontal:"center"},key:"button-tactile-snackbar",transitionDuration:{enter:10}},r.a.createElement(g.a,{severity:"info",variant:"filled",icon:!1},r.a.createElement(h.a,{style:{fontSize:25}},n+(s?" / "+s:"")),"Holding ",r.a.createElement("b",null,n),"'s button down"))};var v=function(e){var t=r.a.useState(!1),a=Object(l.a)(t,2),n=a[0],i=a[1],o=r.a.useState(""),c=Object(l.a)(o,2),s=c[0],m=c[1],u=r.a.useState(""),d=Object(l.a)(u,2),p=d[0],b=d[1],v=r.a.useState(""),y=Object(l.a)(v,2),x=y[0],_=y[1],O=r.a.useState("error"),j=Object(l.a)(O,2),S=j[0],k=j[1],w=r.a.useState(""),C=Object(l.a)(w,2),T=C[0],N=C[1],D=r.a.useState({}),A=Object(l.a)(D,2),B=A[0],L=A[1];r.a.useEffect((function(){fetch("/get_current_unit_labels").then((function(e){return e.json()})).then((function(e){L(e)}))}),[]);var P=function(e,t){"clickaway"!==t&&i(!1)};return r.a.useEffect((function(){if(e.config["cluster.topology"]){var t;(t=e.config.remote&&e.config.remote.ws_url?new f.Client("ws://".concat(e.config.remote.ws_url,"/"),"webui_ErrorSnackbarNotification"+Math.random()):new f.Client("".concat(e.config["cluster.topology"].leader_address),9001,"webui_ErrorSnackbarNotification"+Math.random())).connect({onSuccess:function(){t.subscribe(["pioreactor","+","+","logs","+"].join("/"),{qos:1})},timeout:180,reconnect:!0}),t.onMessageArrived=function(e){var t=JSON.parse(e.payloadString);if(("ERROR"===t.level||"WARNING"===t.level||"NOTICE"===t.level)&&!e.topic.endsWith("/ui")){var a=e.topic.split("/")[1];try{m(B[a])}catch(n){}_(t.message),N(t.task),k("NOTICE"===t.level?"SUCCESS":t.level),b(a),i(!0)}}}}),[e.config,B]),r.a.createElement(E.a,{open:n,anchorOrigin:{vertical:"bottom",horizontal:"right"},key:"error-snackbar",autoHideDuration:12e3,style:{maxWidth:"500px"},onClose:P},r.a.createElement(g.a,{variant:"standard",severity:S.toLowerCase(),onClose:P},r.a.createElement(h.a,{style:{fontSize:15}},T," encountered a ",S.toLowerCase()," in ",p+(s?" / "+s:"")),r.a.createElement("span",{style:{whiteSpace:"pre-wrap"}},x)))},y=a(692),x=a(691),_=a(5),O=a(26),j=a.n(O),S=a(36),k=a(57),w=a(58),C=a(53),T=a(72),N=a(71),D=a(10),A=a(48),B=a.n(A),L=a(730),P=a(698),M=a(723),F=a(599),z=a(699),I=a(725),R=a(729),W=a(728),H=a(724),U=a(726),Y=a(727),J={NOTSET:0,DEBUG:1,INFO:2,NOTICE:2.5,WARNING:3,ERROR:4,CRITICAL:5},V=function(e){Object(T.a)(a,e);var t=Object(N.a)(a);function a(e){var n;return Object(k.a)(this,a),(n=t.call(this,e)).state={listOfLogs:[]},n.onConnect=n.onConnect.bind(Object(C.a)(n)),n.onMessageArrived=n.onMessageArrived.bind(Object(C.a)(n)),n}return Object(w.a)(a,[{key:"getData",value:function(){var e=Object(S.a)(j.a.mark((function e(){var t=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/recent_logs?"+new URLSearchParams({min_level:this.props.config.logging.ui_log_level})).then((function(e){return e.json()})).then((function(e){t.setState({listOfLogs:e})})).catch((function(e){console.log(e)}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.getData(),this.props.config.remote&&this.props.config.remote.ws_url?this.client=new f.Client("ws://".concat(this.props.config.remote.ws_url,"/"),"webui_LogTable"+Math.random()):this.client=new f.Client("".concat(this.props.config["cluster.topology"].leader_address),9001,"webui_LogTable"+Math.random()),this.client.connect({timeout:180,onSuccess:this.onConnect,reconnect:!0}),this.client.onMessageArrived=this.onMessageArrived}},{key:"componentDidUpdate",value:function(e){e.experiment!==this.props.experiment&&this.getData()}},{key:"onConnect",value:function(){this.client.subscribe(["pioreactor","+",this.props.experiment,"logs","+"].join("/")),this.client.subscribe(["pioreactor","+","$experiment","logs","+"].join("/"))}},{key:"onMessageArrived",value:function(e){this.state.listOfLogs.length>50&&this.state.listOfLogs.pop();var t=e.topic.split("/")[1],a=JSON.parse(e.payloadString);J[a.level]<J[this.props.config.logging.ui_log_level]||(this.state.listOfLogs.unshift({timestamp:B.a.utc().format("YYYY-MM-DD[T]HH:mm:ss.SSSSS[Z]"),pioreactor_unit:t,message:String(a.message),task:a.task,is_error:"ERROR"===a.level,is_warning:"WARNING"===a.level,is_notice:"NOTICE"===a.level}),this.setState({listOfLogs:this.state.listOfLogs}))}},{key:"relabelUnit",value:function(e){return this.props.relabelMap&&this.props.relabelMap[e]?"".concat(this.props.relabelMap[e]," / ").concat(e):e}},{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement(P.a,null,r.a.createElement(M.a,null,r.a.createElement(F.a,{variant:"h6",component:"h2"},r.a.createElement(z.a,{fontWeight:"fontWeightRegular"},"Recent event logs")),r.a.createElement(H.a,{style:{height:"700px",width:"100%",overflowY:"scroll"}},r.a.createElement(I.a,{stickyHeader:!0,size:"small","aria-label":"log table"},r.a.createElement(U.a,null,r.a.createElement(Y.a,null,r.a.createElement(W.a,{className:Object(D.a)(t.headerCell)},"Time"),r.a.createElement(W.a,{className:Object(D.a)(t.headerCell)},"Pioreactor"),r.a.createElement(W.a,{className:Object(D.a)(t.headerCell)},"Source"),r.a.createElement(W.a,{className:Object(D.a)(t.headerCell)},"Message"))),r.a.createElement(R.a,null,this.state.listOfLogs.map((function(a,n){var i,o,l,c;return r.a.createElement(Y.a,{key:n},r.a.createElement(W.a,{className:Object(D.a)(t.tightCell,t.smallText,(i={},Object(_.a)(i,t.noticeLog,a.is_notice),Object(_.a)(i,t.errorLog,a.is_error),Object(_.a)(i,t.warningLog,a.is_warning),i))},r.a.createElement("span",{title:B.a.utc(a.timestamp,"YYYY-MM-DD[T]HH:mm:ss.SSSSS[Z]").local().format("YYYY-MM-DD HH:mm:ss.SS")},B.a.utc(a.timestamp,"YYYY-MM-DD[T]HH:mm:ss.SSSSS[Z]").local().format("HH:mm:ss")," ")),r.a.createElement(W.a,{className:Object(D.a)(t.tightCell,t.smallText,(o={},Object(_.a)(o,t.noticeLog,a.is_notice),Object(_.a)(o,t.errorLog,a.is_error),Object(_.a)(o,t.warningLog,a.is_warning),o))}," ",e.relabelUnit(a.pioreactor_unit)),r.a.createElement(W.a,{className:Object(D.a)(t.tightCell,t.smallText,(l={},Object(_.a)(l,t.noticeLog,a.is_notice),Object(_.a)(l,t.errorLog,a.is_error),Object(_.a)(l,t.warningLog,a.is_warning),l))},a.task.replace(/_/g," ")),r.a.createElement(W.a,{className:Object(D.a)(t.tightCell,t.smallText,(c={},Object(_.a)(c,t.noticeLog,a.is_notice),Object(_.a)(c,t.errorLog,a.is_error),Object(_.a)(c,t.warningLog,a.is_warning),c))},a.message))})))))))}}]),a}(r.a.Component),$=Object(L.a)((function(e){return{tightCell:{padding:"6px 6px 6px 10px",fontSize:13},smallText:{fontSize:12},headerCell:{backgroundColor:"white",padding:"8px 6px 6px 6px"},tightRight:{textAlign:"right"},errorLog:{backgroundColor:"#ff7961"},warningLog:{backgroundColor:"#FFEA8A"},noticeLog:{backgroundColor:"#addcaf"}}}))(V),G=a(674),K=a(731),q=a(700),Z=a(705),Q=a(360),X=a.n(Q),ee=a(361),te=a.n(ee),ae=a(215),ne=a.n(ae),re=a(214),ie=a.n(re),oe=a(211),le=a.n(oe),ce=a(664),se=a(701),me=a(702),ue=a(704),de=a(703),pe=Object(G.a)((function(e){return{title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0},textIcon:{fontSize:15,verticalAlign:"middle",margin:"0px 3px"},headerMenu:Object(_.a)({display:"flex",justifyContent:"space-between",marginBottom:"5px"},e.breakpoints.down("lg"),{flexFlow:"nowrap",flexDirection:"column"}),headerButtons:{display:"flex",flexDirection:"row",justifyContent:"flex-start",flexFlow:"wrap"}}})),fe=function(e){Object(T.a)(a,e);var t=Object(N.a)(a);function a(e){var n;return Object(k.a)(this,a),(n=t.call(this,e)).saveToDatabaseOrSkip=function(){n.state.recentChange?(n.setState({recentChange:!1}),setTimeout(n.saveToDatabaseOrSkip,150)):(fetch("update_experiment_desc",{method:"POST",body:JSON.stringify({experiment:n.props.experiment,description:n.state.desc}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){200!==e.status&&console.log("Didn't save successfully.")})),n.setState({savingLoopActive:!1}))},n.onFocus=function(e){e.target.style.height=e.target.scrollHeight+"px"},n.handleChange=function(e){e.target.style.height=e.target.scrollHeight+"px",n.setState({desc:e.target.value}),n.setState({recentChange:!0}),n.state.savingLoopActive||(n.setState({savingLoopActive:!0}),setTimeout(n.saveToDatabaseOrSkip,150))},n.render=function(){return r.a.createElement("div",{style:{padding:"0px 5px 0px 5px"}},r.a.createElement(q.a,{htmlFor:"description-box"},"Description"),r.a.createElement(K.a,{placeholder:"Provide a description of your experiment.",id:"description-box",multiline:!0,fullWidth:!0,onChange:n.handleChange,value:n.state.desc,style:{padding:"10px 5px 10px 5px",fontSize:"14px",fontFamily:"Roboto",width:"100%",overflow:"hidden"}}))},n.contentEditable=r.a.createRef(),n.state={desc:"",recentChange:!1,savingLoopActive:!1},n}return Object(w.a)(a,[{key:"componentDidUpdate",value:function(e){this.props.description!==e.description&&this.setState({desc:this.props.description})}}]),a}(r.a.Component);function ge(){var e=pe(),t=r.a.useState(!1),a=Object(l.a)(t,2),n=a[0],i=a[1],o=function(){i(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{style:{textTransform:"none",float:"right"},color:"primary",onClick:function(){i(!0)}},r.a.createElement(le.a,{fontSize:"15",classes:{root:e.textIcon}})," New experiment"),r.a.createElement(se.a,{open:n,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(ce.a,{id:"alert-dialog-title"},"Starting a new experiment"),r.a.createElement(me.a,null,r.a.createElement(de.a,{id:"alert-dialog-description"},"Starting a new experiment will stop data collection for the current experiment. Do you wish to proceed?")),r.a.createElement(ue.a,null,r.a.createElement(x.a,{href:"/start-new-experiment",color:"primary"},"Confirm"),r.a.createElement(x.a,{onClick:o,color:"secondary",autoFocus:!0},"Cancel"))))}function he(){var e=pe(),t=r.a.useState(!1),a=Object(l.a)(t,2),n=a[0],i=a[1],o=function(){i(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{style:{textTransform:"none",float:"right"},color:"primary",onClick:function(){i(!0)}},r.a.createElement(ie.a,{fontSize:"15",classes:{root:e.textIcon}})," End experiment"),r.a.createElement(se.a,{open:n,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(ce.a,{id:"alert-dialog-title"},"End experiment?"),r.a.createElement(me.a,null,r.a.createElement(de.a,{id:"alert-dialog-description"},"This will halt all activies (stirring, dosing, optical density reading, etc.) in all Pioreactor units. You can manually start them again later. Do you wish to end the experiment?")),r.a.createElement(ue.a,null,r.a.createElement(x.a,{onClick:function(){fetch("/stop_all",{method:"POST"}),o()},color:"primary"},"Confirm"),r.a.createElement(x.a,{onClick:o,color:"secondary",autoFocus:!0},"Cancel"))))}var Ee=function(e){var t=pe(),a=e.experimentMetadata.experiment||"",n=e.experimentMetadata.created_at||B()(),i=e.experimentMetadata.description||"",o=e.experimentMetadata.delta_hours||0;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("div",{className:t.headerMenu},r.a.createElement(F.a,{variant:"h5",component:"h1"},r.a.createElement(z.a,{fontWeight:"fontWeightBold"},a)),r.a.createElement("div",{className:t.headerButtons},r.a.createElement(ge,null),r.a.createElement(he,null),r.a.createElement(x.a,{href:"/export-data",style:{textTransform:"none",marginRight:"0px",float:"right"},color:"primary"},r.a.createElement(ne.a,{fontSize:"15",classes:{root:t.textIcon}})," Export experiment data"))),r.a.createElement(Z.a,null),r.a.createElement(F.a,{variant:"subtitle2"},r.a.createElement(z.a,{fontWeight:"fontWeightBold",style:{margin:"10px 2px 10px 2px",display:"inline-block"}},r.a.createElement(X.a,{style:{fontSize:12,verticalAlign:"-1px"}})," Experiment started:"),r.a.createElement(z.a,{fontWeight:"fontWeightRegular",style:{marginRight:"20px",display:"inline-block"}},r.a.createElement("span",{title:B()(n).format("YYYY-MM-DD HH:mm:ss")},B()(n).format("dddd, MMMM D, YYYY"))),r.a.createElement(z.a,{fontWeight:"fontWeightBold",style:{margin:"10px 2px 10px 2px",display:"inline-block"}},r.a.createElement(te.a,{style:{fontSize:12,verticalAlign:"-1px"}}),"Time elapsed:"),r.a.createElement(z.a,{fontWeight:"fontWeightRegular",style:{marginRight:"20px",display:"inline-block"}},o,"h"))),r.a.createElement(P.a,{className:t.root},r.a.createElement(P.a,{className:t.cardContent},r.a.createElement(fe,{experiment:a,description:i}))))},be=a(20),ve=a(22),ye=a(167),xe=a(676),_e=a(736),Oe=a(672),je=a(737),Se=a(690),ke=a(353),we=a(735),Ce=a(335),Te=a(738),Ne=a(739),De=[{primary:"#0077BB",1:"#0077BB",2:"#0077BB"},{primary:"#009988",1:"#009988",2:"#009988"},{primary:"#CC3311",1:"#CC3311",2:"#CC3311"},{primary:"#33BBEE",1:"#33BBEE",2:"#33BBEE"},{primary:"#EE7733",1:"#EE7733",2:"#EE7733"},{primary:"#EE3377",1:"#EE3377",2:"#EE3377"},{primary:"#BBBBBB",1:"#BBBBBB",2:"#BBBBBB"}],Ae={};function Be(e){if(e in Ae)return Ae[e];var t=/(.*)-[1234]/;if(t.test(e))return Be(e.match(t)[1]);var a=De.shift();return Ae[e]=a.primary,Ae[e+"-1"]=a[1],Ae[e+"-2"]=a[2],Ae[e+"-3"]=a[3],Ae[e+"-4"]=a[4],Be(e)}var Le=function(e){Object(T.a)(a,e);var t=Object(N.a)(a);function a(e){var n;return Object(k.a)(this,a),(n=t.call(this,e)).createToolTip=function(e){return"".concat(e.datum.x.format("MMM DD HH:mm"),"\n").concat(n.relabelAndFormatSeries(e.datum.childName),": ").concat(Math.round(n.yTransformation(e.datum.y)*Math.pow(10,n.props.fixedDecimals))/Math.pow(10,n.props.fixedDecimals))},n.state={seriesMap:{},hiddenSeries:new Set,names:[],legendEvents:[],fetched:!1},n.onConnect=n.onConnect.bind(Object(C.a)(n)),n.onMessageArrived=n.onMessageArrived.bind(Object(C.a)(n)),n.selectLegendData=n.selectLegendData.bind(Object(C.a)(n)),n.selectVictoryLines=n.selectVictoryLines.bind(Object(C.a)(n)),n.yTransformation=n.props.yTransformation||function(e){return e},n.VictoryZoomVoronoiContainer=Object(xe.a)("zoom","voronoi"),n}return Object(w.a)(a,[{key:"onConnect",value:function(){this.client.subscribe(["pioreactor","+",this.props.experiment,this.props.topic].join("/"))}},{key:"componentDidUpdate",value:function(e){e.experiment!==this.props.experiment&&this.getData()}},{key:"componentDidMount",value:function(){this.getData(),this.props.config&&this.props.config["cluster.topology"]&&(this.props.config.remote&&this.props.config.remote.ws_url?this.client=new f.Client("ws://".concat(this.props.config.remote.ws_url,"/"),"webui_Chart"+Math.random()):this.client=new f.Client("".concat(this.props.config["cluster.topology"].leader_address),9001,"webui_Chart"+Math.random()),this.client.connect({onSuccess:this.onConnect,reconnect:!0}),this.client.onMessageArrived=this.onMessageArrived)}},{key:"getData",value:function(){var e=Object(S.a)(j.a.mark((function e(){var t=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.experiment){e.next=2;break}return e.abrupt("return");case 2:return.6,e.next=5,fetch("/time_series/"+this.props.dataSource+"/"+this.props.experiment+"?"+new URLSearchParams({filter_mod_N:Math.max(Math.floor(.6*Math.min(this.props.deltaHours,this.props.lookback)),1),lookback:this.props.lookback})).then((function(e){return e.json()})).then((function(e){var a,n={},r=Object(ye.a)(e.series.entries());try{for(r.s();!(a=r.n()).done;){var i=Object(l.a)(a.value,2),o=i[0],c=i[1];e.data[o].length>0&&(n[c]={data:e.data[o].map((function(e){return{y:e.y,x:B.a.utc(e.x,"YYYY-MM-DDTHH:mm:ss.SSSSS").local()}})),name:c,color:Be(c)})}}catch(m){r.e(m)}finally{r.f()}var s=Object.keys(n);t.setState({seriesMap:n,legendEvents:t.createLegendEvents(),names:s,fetched:!0})})).catch((function(e){console.log(e),t.setState({fetched:!0})}));case 5:this.forceUpdate();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteAndReturnSet",value:function(e,t){return e.delete(t),e}},{key:"createLegendEvents",value:function(){var e=this;return[{childName:"legend",target:"data",eventHandlers:{onClick:function(t,a){return[{childName:a.datum.name,target:"data",eventKey:"all",mutation:function(){return e.state.hiddenSeries.has(a.datum.name)?e.setState((function(t){return{hiddenSeries:e.deleteAndReturnSet(t.hiddenSeries,a.datum.name)}})):e.setState((function(e){return{hiddenSeries:e.hiddenSeries.add(a.datum.name)}})),null}}]}}}]}},{key:"onMessageArrived",value:function(e){if(this.state.fetched&&!e.retained&&e.payloadString){var t=JSON.parse(e.payloadString),a=B.a.utc(t.timestamp).local(),n=parseFloat(t[this.props.payloadKey]),r=this.props.isODReading?e.topic.split("/")[1]+"-"+e.topic.split("/")[5]:e.topic.split("/")[1];try{if(r in this.state.seriesMap)this.state.seriesMap[r].data.push({x:a,y:n}),this.setState({seriesMap:this.state.seriesMap});else{var i=Object(ve.a)(Object(ve.a)({},this.state.seriesMap),{},Object(_.a)({},r,{data:[{x:a,y:n}],name:r,color:Be(r)}));this.setState({seriesMap:i}),this.setState({names:[].concat(Object(be.a)(this.state.names),[r])})}}catch(o){console.log(o)}}}},{key:"breakString",value:function(e){return e.length>12?e.slice(0,5)+"..."+e.slice(e.length-2,e.length):e}},{key:"relabelAndFormatSeries",value:function(e){if(!this.props.relabelMap)return e;if(e.match(/(.*)-([1234])/g)){var t=e.match(/(.*)-([1234])/),a=t[1],n=t[2];return this.breakString(this.props.relabelMap[a]||a)+"-ch"+n}return this.breakString(this.props.relabelMap[e]||e)}},{key:"selectLegendData",value:function(e){var t=this.relabelAndFormatSeries(e);if(!this.state.seriesMap)return{};var a={name:t,symbol:{fill:this.state.seriesMap[e].color}};return this.state.hiddenSeries.has(t)?Object(ve.a)(Object(ve.a)({},a),{},{symbol:{fill:"white"}}):a}},{key:"selectVictoryLines",value:function(e){var t=this,a=this.relabelAndFormatSeries(e),n=null;return n=1===this.state.seriesMap[e].data.length?r.a.createElement(_e.a,{size:4,key:"line-"+a+this.props.title,name:a,style:{data:{fill:this.state.seriesMap[e].color}}}):r.a.createElement(Oe.a,{interpolation:this.props.interpolation,key:"line-"+a+this.props.title,name:a,style:{labels:{fill:this.state.seriesMap[e].color},data:{stroke:this.state.seriesMap[e].color,strokeWidth:2},parent:{border:"1px solid #ccc"}}}),r.a.createElement(je.a,{data:this.state.hiddenSeries.has(a)?[]:this.state.seriesMap[e].data,x:"x",y:function(e){return t.yTransformation(e.y)}},n)}},{key:"render",value:function(){var e=this;return r.a.createElement(P.a,{style:{maxHeight:"100%"}},r.a.createElement(Se.a,{style:{parent:{maxWidth:"700px"}},title:this.props.title,domainPadding:10,padding:{left:70,right:50,bottom:80,top:50},events:this.state.legendEvents,height:315,width:600,scale:{x:"time"},theme:ke.a.material,containerComponent:r.a.createElement(this.VictoryZoomVoronoiContainer,{zoomDimension:"x",responsive:!0,voronoiBlacklist:["parent"],labels:this.createToolTip,labelComponent:r.a.createElement(we.a,{cornerRadius:0,flyoutStyle:{fill:"white",stroke:"#90a4ae",strokeWidth:1.5}})})},r.a.createElement(Ce.a,{text:this.props.title,x:300,y:30,textAnchor:"middle",style:{fontSize:16,fontFamily:"inherit"}}),r.a.createElement(Te.a,{style:{tickLabels:{fontSize:14,padding:5,fontFamily:"inherit"}},offsetY:80,orientation:"bottom"}),r.a.createElement(Te.a,{crossAxis:!1,dependentAxis:!0,domain:this.props.yAxisDomain,tickFormat:function(t){return"".concat(t.toFixed(e.props.fixedDecimals))},label:this.props.yAxisLabel,axisLabelComponent:r.a.createElement(Ce.a,{dy:-41,style:{fontSize:15,padding:10,fontFamily:"inherit"}}),style:{tickLabels:{fontSize:14,padding:5,fontFamily:"inherit"}}}),r.a.createElement(Ne.a,{x:65,y:270,symbolSpacer:6,itemsPerRow:4,name:"legend",borderPadding:{right:8},orientation:"horizontal",cursor:"pointer",gutter:15,rowGutter:5,style:{labels:{fontSize:13},data:{stroke:"#485157",strokeWidth:.5,size:6.5}},data:this.state.names.map(this.selectLegendData)}),Object.keys(this.state.seriesMap).map(this.selectVictoryLines)))}}]),a}(r.a.Component),Pe=a(392);var Me=function(e){return r.a.createElement(Pe.a,e,r.a.createElement("g",{id:"PioreactorIcon1",stroke:"none",strokeWidth:"1",fill:e.fillColor||"none",fillRule:"evenodd"},r.a.createElement("g",{id:"PioreactorIcon2",transform:"translate(-728.000000, -1502.000000)",stroke:"currentColor",strokeWidth:"1.8"},r.a.createElement("g",{id:"PioreactorIcon3",transform:"translate(729.000000, 1503.000000)"},r.a.createElement("path",{d:"M1.4,18.9 L1.4,14.7 L0,14.7 L0,11.2 L2.799,11.2 L2.8,0 L14,0 L13.999,11.2 L16.8,11.2 L16.8,14.7 L15.399,14.7 L15.4,18.9 L1.4,18.9 Z",id:"Combined-Shape"}),r.a.createElement("circle",{id:"Oval",cx:"8.4",cy:"13.3",r:"2.1"})))))};function Fe(e){var t=e.title;return r.a.createElement("span",{className:Object(D.a)({underlineSpan:!!t}),title:t},e.children)}var ze=function(e){Object(T.a)(a,e);var t=Object(N.a)(a);function a(e){var n;return Object(k.a)(this,a),(n=t.call(this,e)).state={mediaThroughputPerUnit:{},altMediaThroughputPerUnit:{},mediaThroughput:0,altMediaThroughput:0,rates:{all:{mediaRate:0,altMediaRate:0}},activeUnits:[]},n.onConnect=n.onConnect.bind(Object(C.a)(n)),n.onMessageArrived=n.onMessageArrived.bind(Object(C.a)(n)),n}return Object(w.a)(a,[{key:"getRecentRates",value:function(){var e=Object(S.a)(j.a.mark((function e(){var t=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/recent_media_rates").then((function(e){return e.json()})).then((function(e){t.setState((function(t){return Object(ve.a)(Object(ve.a)({},t),{},{rates:e})}))}));case 2:return e.abrupt("return");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e){e.experiment!==this.props.experiment&&this.getRecentRates()}},{key:"componentDidMount",value:function(){this.props.config.remote&&this.props.config.remote.ws_url?this.client=new f.Client("ws://".concat(this.props.config.remote.ws_url,"/"),"webui_MediaCard"+Math.random()):this.client=new f.Client("".concat(this.props.config["cluster.topology"].leader_address),9001,"webui_MediaCard"+Math.random()),this.client.connect({timeout:180,onSuccess:this.onConnect}),this.client.onMessageArrived=this.onMessageArrived,this.setState({activeUnits:Object.entries(this.props.config["cluster.inventory"]).filter((function(e){return"1"===e[1]})).map((function(e){return e[0]}))}),this.getRecentRates()}},{key:"onConnect",value:function(){this.client.subscribe(["pioreactor","+",this.props.experiment,"dosing_automation","alt_media_throughput"].join("/")),this.client.subscribe(["pioreactor","+",this.props.experiment,"dosing_automation","media_throughput"].join("/"))}},{key:"addOrUpdate",value:function(e,t,a){return Object.hasOwnProperty(e)?t[e]=a+t[e]:t[e]=a,t}},{key:"onMessageArrived",value:function(e){var t=e.destinationName.split("/"),a=parseFloat(e.payloadString),n=t[1],r="alt_media_throughput"===t.slice(-1)[0]?"altMediaThroughputPerUnit":"mediaThroughputPerUnit",i="alt_media_throughput"===t.slice(-1)[0]?"altMediaThroughput":"mediaThroughput";this.setState(Object(_.a)({},r,this.addOrUpdate(n,this.state[r],a)));var o=Object.values(this.state[r]).reduce((function(e,t){return e+t}),0);this.setState(Object(_.a)({},i,o))}},{key:"relabelUnit",value:function(e){return this.props.relabelMap&&this.props.relabelMap[e]?"".concat(this.props.relabelMap[e]," / ").concat(e):e}},{key:"render",value:function(){var e=this;return r.a.createElement(P.a,null,r.a.createElement(M.a,null,r.a.createElement(F.a,{variant:"h6",component:"h2"},r.a.createElement(z.a,{fontWeight:"fontWeightRegular"},"Dosing")),r.a.createElement(H.a,{style:{width:"100%"}},r.a.createElement(I.a,{size:"small","aria-label":"media throughput"},r.a.createElement(U.a,null,r.a.createElement(Y.a,null,r.a.createElement(W.a,{style:{padding:"6px 0px"}}),r.a.createElement(W.a,{style:{padding:"6px 0px"},align:"right"},"Media"),r.a.createElement(W.a,{style:{padding:"6px 0px"},align:"right"},"Alt. Media"))),r.a.createElement(R.a,null,r.a.createElement(Y.a,{key:"all"},r.a.createElement(W.a,{style:{padding:"6px 0px"},component:"th",scope:"row"},"All Pioreactors"),r.a.createElement(W.a,{align:"right",style:{fontSize:13,padding:"6px 0px"}},this.state.mediaThroughput.toFixed(1),"mL (~",this.state.rates.all.mediaRate.toFixed(1),"mL/h)"),r.a.createElement(W.a,{align:"right",style:{fontSize:13,padding:"6px 0px"}},this.state.altMediaThroughput.toFixed(1),"mL (~",this.state.rates.all.altMediaRate.toFixed(1),"mL/h)")),this.state.activeUnits.map((function(t){return r.a.createElement(Y.a,{key:t},r.a.createElement(W.a,{style:{padding:"6px 0px"},component:"th",scope:"row"},r.a.createElement(Me,{style:{fontSize:14,verticalAlign:"middle"},color:"inherit"}),e.relabelUnit(t)),r.a.createElement(W.a,{align:"right",style:{fontSize:13,padding:"6px 0px"}},(e.state.mediaThroughputPerUnit[t]||0).toFixed(1),"mL (~",e.state.rates[t]?e.state.rates[t].mediaRate.toFixed(1):"0.0","mL/h)"),r.a.createElement(W.a,{align:"right",style:{fontSize:13,padding:"6px 0px"}},(e.state.altMediaThroughputPerUnit[t]||0).toFixed(1),"mL (~",e.state.rates[t]?e.state.rates[t].altMediaRate.toFixed(1):"0.0","mL/h)"))})))))))}}]),a}(r.a.Component),Ie=Object(L.a)((function(e){return{tightCell:{padding:"8px 2px 6px 4px",fontSize:13},smallText:{fontSize:12},headerCell:{backgroundColor:"white",padding:"8px 6px 6px 6px"},tightRight:{textAlign:"right"}}}))(ze);var Re=function(e){var t=r.a.useState({}),a=Object(l.a)(t,2),n=a[0],i=a[1],o=r.a.useState({}),c=Object(l.a)(o,2),s=c[0],m=c[1];return r.a.useEffect((function(){document.title=e.title,fetch("/get_latest_experiment").then((function(e){return e.json()})).then((function(e){i(e)})),fetch("/get_current_unit_labels").then((function(e){return e.json()})).then((function(e){m(e)}))}),[e.title]),r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{container:!0,spacing:2,justifyContent:"space-between"},r.a.createElement(y.a,{item:!0,xs:12,md:12},r.a.createElement(Ee,{experimentMetadata:n})),r.a.createElement(y.a,{item:!0,xs:12,md:7,container:!0,spacing:2,justifyContent:"flex-start",style:{height:"100%"}},e.config["ui.overview.charts"]&&"1"===e.config["ui.overview.charts"].implied_growth_rate&&r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(Le,{config:e.config,dataSource:"growth_rates",title:"1"===e.config["ui.overview.settings"].daily_growth_rate?"Implied daily growth rate":"Implied growth rate",topic:"growth_rate_calculating/growth_rate",payloadKey:"growth_rate",yAxisLabel:"1"===e.config["ui.overview.settings"].daily_growth_rate?"Growth rate, d\u207b\xb9":"Growth rate, h\u207b\xb9",yTransformation:"1"===e.config["ui.overview.settings"].daily_growth_rate?function(e){return 24*e}:function(e){return e},experiment:n.experiment,deltaHours:n.delta_hours,interpolation:"stepAfter",yAxisDomain:"1"===e.config["ui.overview.settings"].daily_growth_rate?[-.1,1]:[-.02,.1],lookback:1e5,fixedDecimals:2,relabelMap:s})),e.config["ui.overview.charts"]&&"1"===e.config["ui.overview.charts"].fraction_of_volume_that_is_alternative_media&&r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(Le,{config:e.config,yAxisDomain:[0,.05],dataSource:"alt_media_fraction",interpolation:"stepAfter",payloadKey:"alt_media_fraction",title:"Fraction of volume that is alternative media",topic:"alt_media_calculating/alt_media_fraction",yAxisLabel:"Fraction",experiment:n.experiment,deltaHours:1,fixedDecimals:3,lookback:1e5,relabelMap:s})),e.config["ui.overview.charts"]&&"1"===e.config["ui.overview.charts"].normalized_optical_density&&r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(Le,{config:e.config,dataSource:"od_readings_filtered",title:"Normalized optical density",payloadKey:"od_filtered",topic:"growth_rate_calculating/od_filtered",yAxisLabel:"Current OD / initial OD",experiment:n.experiment,deltaHours:n.delta_hours,interpolation:"stepAfter",lookback:parseFloat(e.config["ui.overview.settings"].filtered_od_lookback_hours),fixedDecimals:2,yAxisDomain:[.98,1.02],relabelMap:s})),e.config["ui.overview.charts"]&&"1"===e.config["ui.overview.charts"].raw_optical_density&&r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(Le,{config:e.config,isODReading:!0,dataSource:"od_readings_raw",title:"Optical density",interpolation:"stepAfter",topic:"od_reading/od_raw/+",yAxisLabel:"Voltage",payloadKey:"voltage",experiment:n.experiment,deltaHours:n.delta_hours,lookback:parseFloat(e.config["ui.overview.settings"].raw_od_lookback_hours),fixedDecimals:3,relabelMap:s})),e.config["ui.overview.charts"]&&"1"===e.config["ui.overview.charts"].temperature&&r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(Le,{config:e.config,dataSource:"temperature_readings",title:"Temperature of vials",topic:"temperature_control/temperature",yAxisLabel:"temperature, \u2103",payloadKey:"temperature",experiment:n.experiment,interpolation:"stepAfter",lookback:1e4,deltaHours:1,yAxisDomain:[22.5,37.5],fixedDecimals:1,relabelMap:s}))),r.a.createElement(y.a,{item:!0,xs:12,md:5,container:!0,spacing:1,justifyContent:"flex-end",style:{height:"100%"}},e.config["ui.overview.cards"]&&"1"===e.config["ui.overview.cards"].dosings&&r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(Ie,{experiment:n.experiment,config:e.config,relabelMap:s}),r.a.createElement(x.a,{href:"/pioreactors",color:"primary",style:{textTransform:"none",verticalAlign:"middle",margin:"0px 3px"}}," ",r.a.createElement(Me,{style:{fontSize:17},color:"primary"})," See all Pioreactor details ")),e.config["ui.overview.cards"]&&"1"===e.config["ui.overview.cards"].event_logs&&r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement($,{experiment:n.experiment,config:e.config,relabelMap:s})))))},We=a(659),He=a(706),Ue=a(708),Ye=a(709),Je=a(679),Ve=a(675),$e=a(683),Ge=Object(G.a)((function(e){return{root:{marginTop:"15px"},title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0},caption:{marginLeft:"30px",maxWidth:"650px"}}}));function Ke(e){var t=Ge(),a=r.a.useState([{experiment:"<All experiments>"}]),n=Object(l.a)(a,2),i=n[0],o=n[1];r.a.useEffect((function(){function t(){return(t=Object(S.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/get_experiments").then((function(e){return e.json()})).then((function(t){o((function(e){return[].concat(Object(be.a)(t),Object(be.a)(e))})),e.handleChange(t[0].experiment)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]);return r.a.createElement("div",{style:{maxWidth:"450px",margin:"10px"}},r.a.createElement(He.a,{fullWidth:!0,component:"fieldset",className:t.formControl},r.a.createElement(q.a,{id:"expSelect",variant:"standard"}," Experiment "),r.a.createElement(Ve.a,{native:!0,labelId:"expSelect",variant:"standard",value:e.ExperimentSelection,onChange:function(t){e.handleChange(t.target.value)},inputProps:{name:"experiment",id:"experiment"}},i.map((function(e){return r.a.createElement("option",{value:e.experiment},e.experiment+(e.created_at?" (started ".concat(B()(e.created_at).format("MMMM D, YYYY"),")"):""))})))))}var qe=function(e){var t=Ge();return r.a.createElement("div",{className:t.root,style:{margin:"10px"}},r.a.createElement(He.a,{component:"fieldset",className:t.formControl},r.a.createElement(We.a,{component:"legend"},"Datasets"),r.a.createElement(Ue.a,null,r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.growth_rates,onChange:e.handleChange,name:"growth_rates"}),label:"Implied growth rate"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},'The time series of the calculated (implied) growth rate. Same data as presented in the "Implied growth rate" chart in the Experiment Overview.'),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.od_readings_raw,onChange:e.handleChange,name:"od_readings_raw"}),label:"Raw optical density"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},'The time series of raw voltages provided by the senors, the inputs for growth calculations and normalized optical densities. Same data as presented in the "Raw optical density" chart in the Experiment Overview.'),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.od_readings_filtered,onChange:e.handleChange,name:"od_readings_filtered"}),label:"Normalized optical density"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},'The time series of normalized optical densities. Same data as presented in the "Normalized optical density" chart in the Experiment Overview.'),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.temperature_readings,onChange:e.handleChange,name:"temperature_readings"}),label:"Temperature readings"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},'The time series of temperature readings from the Pioreactors. Same data as presented in the "Temperature of vials" chart in the Experiment Overview.'),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.experiments,onChange:e.handleChange,name:"experiments"}),label:"Experiment metadata"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},"The description and other metadata from the experiment."),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.alt_media_fractions,onChange:e.handleChange,name:"alt_media_fractions"}),label:"Alternative media fraction"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},'A time series of how much alternative media is in each Pioreactor. Same data as presented in the "Fraction of volume that is alternative media" chart in the Experiment Overview.'),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.dosing_events,onChange:e.handleChange,name:"dosing_events"}),label:"Dosing event log"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},"A detailed log table of all dosing events, including the volume exchanged, and the source of who or what triggered the event."),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.led_events,onChange:e.handleChange,name:"led_events"}),label:"LED event log"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},"A detailed log table of all LED events, including the channel, intensity, and the source of who or what triggered the event."),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.dosing_automation_settings,onChange:e.handleChange,name:"dosing_automation_settings"}),label:"Dosing automation changelog"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},"Whenever a dosing automation is updated (new automation, new setting, etc.), a new row is recorded. You can reconstruct all the dosing automation states from this dataset."),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.led_automation_settings,onChange:e.handleChange,name:"led_automation_settings"}),label:"LED automation changelog"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},"Whenever a LED automation is updated (new automation, new setting, etc.), a new row is recorded. You can reconstruct all the LED automation states from this dataset."),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.temperature_automation_settings,onChange:e.handleChange,name:"temperature_automation_settings"}),label:"Temperature automation changelog"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},"Whenever a temperature automation is updated (new automation, new setting, etc.), a new row is recorded. You can reconstruct all the temperature automation states from this dataset."),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.dosing_automation_events,onChange:e.handleChange,name:"dosing_automation_events"}),label:"Dosing automation events"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},"Log of automation events created by dosing automations."),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.led_automation_events,onChange:e.handleChange,name:"led_automation_events"}),label:"LED automation events"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},"Log of automation events created by LED automations."),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.temperature_automation_events,onChange:e.handleChange,name:"temperature_automation_events"}),label:"Temperature automation events"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},"Log of automation events created by temperature automations."),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.kalman_filter_outputs,onChange:e.handleChange,name:"kalman_filter_outputs"}),label:"Kalman filter outputs"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},"An internal Kalman filter produces the normalized optical densities, growth rates, an acceleration term, and variances (and covariances) between the estimates."),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.stirring_rates,onChange:e.handleChange,name:"stirring_rates"}),label:"Stirring rates"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},"The measured RPM of the onboard stirring."),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.pioreactor_unit_labels,onChange:e.handleChange,name:"pioreactor_unit_labels"}),label:"Pioreactor unit labels"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},"Labels assigned to a Pioreactor during an experiment."),r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:e.isChecked.logs,onChange:e.handleChange,name:"logs"}),label:"Pioreactor logs"}),r.a.createElement(F.a,{variant:"caption",className:t.caption,gutterBottom:!0},'The append-only collection of logs from all Pioreactors. A subset of the these logs are displayed in the Log Table in the Experiment Overview. These are the logs that should be provided to get assistance when troubleshooting, but choose "<All experiments>" above.'))))};function Ze(){var e=Ge(),t=r.a.useState(!1),a=Object(l.a)(t,2),n=a[0],i=a[1],o=r.a.useState(!1),c=Object(l.a)(o,2),s=c[0],m=c[1],u=r.a.useState(""),d=Object(l.a)(u,2),p=d[0],f=d[1],g=r.a.useState({experimentSelection:"",datasetCheckbox:{growth_rates:!1,dosing_events:!1,led_events:!1,experiments:!1,od_readings_raw:!1,od_readings_filtered:!1,logs:!1,alt_media_fraction:!1,dosing_automation_settings:!1,led_automation_settings:!1,temperature_automation_settings:!1,kalman_filter_outputs:!1,stirring_rates:!1,temperature_readings:!1,pioreactor_unit_labels:!1,led_automation_events:!1,dosing_automation_events:!1,temperature_automation_events:!1}}),h=Object(l.a)(g,2),E=h[0],b=h[1];var v=s?r.a.createElement(z.a,{color:"error.main"},p):"";return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(F.a,{variant:"h5",component:"h2"},r.a.createElement(z.a,{fontWeight:"fontWeightBold"},"Export Experiment Data")))),r.a.createElement(P.a,{className:e.root},r.a.createElement(P.a,{className:e.cardContent},r.a.createElement("form",null,r.a.createElement(y.a,{container:!0,spacing:0},r.a.createElement(y.a,{item:!0,xs:12,md:12},r.a.createElement(Ke,{experimentSelection:E.experimentSelection,handleChange:function(e){b((function(t){return Object(ve.a)(Object(ve.a)({},t),{},{experimentSelection:e})}))}})),r.a.createElement(y.a,{item:!0,xs:12,md:12},r.a.createElement(qe,{isChecked:E.datasetCheckbox,handleChange:function(e){b((function(t){return Object(ve.a)(Object(ve.a)({},t),{},{datasetCheckbox:Object(ve.a)(Object(ve.a)({},E.datasetCheckbox),{},Object(_.a)({},e.target.name,e.target.checked))})}))}})),r.a.createElement(y.a,{item:!0,xs:0}),r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement($e.a,{type:"submit",variant:"contained",color:"primary",loading:n,onClick:function(e){if(e.preventDefault(),!Object.values(E.datasetCheckbox).some((function(e){return e})))return m(!0),void f("At least one dataset must be selected.");i(!0),fetch("export_datasets",{method:"POST",body:JSON.stringify(E),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var t=document.createElement("a"),a=e.filename.replace(/%/g,"%25");t.setAttribute("export",a),t.href="/static/exports/"+a,document.body.appendChild(t),t.click(),t.remove(),i(!1)})).catch((function(e){i(!1),m(!0),f("Server error occurred. Check logs.")}))},style:{width:"120px",marginLeft:24}},"Export"),r.a.createElement("p",{style:{marginLeft:24}},v)),r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement("p",{style:{textAlign:"center",marginTop:"30px"}},r.a.createElement("span",{role:"img","aria-labelledby":"Note"},"\ud83d\udca1")," Learn more about ",r.a.createElement("a",{href:"https://docs.pioreactor.com/user_guide/Exporting%20Data",target:"_blank",rel:"noopener noreferrer"},"data exporting"),".")))))))}var Qe=function(e){return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(y.a,{container:!0,spacing:2},r.a.createElement(y.a,{item:!0,md:12,xs:12},r.a.createElement(Ze,null)))},Xe=a(388),et=a(668),tt=a(710),at=a(688),nt=a(717),rt=a(711),it=a(677),ot=a(712),lt=a(89),ct=a.n(lt),st=a(270),mt=a.n(st),ut=a(220),dt=a.n(ut),pt=a(273),ft=a.n(pt),gt=a(374),ht=a.n(gt),Et=a(119),bt=a.n(Et),vt=a(271),yt=a.n(vt),xt=a(715),_t=a(716),Ot=a(707),jt=a(696),St=a(693),kt=a(713),wt=a(272),Ct=a.n(wt),Tt=Object(G.a)((function(e){return{textFieldCompact:{marginTop:e.spacing(3),marginRight:e.spacing(2),marginBottom:e.spacing(0),width:"18ch"}}}));var Nt=function(e){var t=Tt(),a=Object.assign.apply(Object,[{}].concat(Object(be.a)(e.fields.map((function(e){return Object(_.a)({},e.key,e.default)})))));Object(n.useEffect)((function(){e.updateParent(a)}),[e.fields]);var i=function(t){e.updateParent(Object(_.a)({},t.target.id,t.target.value))},o=e.fields.map((function(a){return r.a.createElement(at.a,{size:"small",autoComplete:"off",id:a.key,key:a.key+e.name,label:a.label,defaultValue:a.default,InputProps:{endAdornment:r.a.createElement(rt.a,{position:"end"},a.unit)},variant:"outlined",onChange:i,onKeyPress:function(e){"Enter"===e.key&&e.preventDefault()},className:t.textFieldCompact})}));return r.a.createElement("div",null,r.a.createElement("p",null," ",e.description," "),o)},Dt=Object(G.a)((function(e){return{formControl:{marginTop:e.spacing(2)},unitTitle:{fontSize:17,color:"rgba(0, 0, 0, 0.87)"},unitTitleDialog:{fontSize:20,color:"rgba(0, 0, 0, 0.87)"},suptitle:{fontSize:"13px",color:"rgba(0, 0, 0, 0.60)"}}})),At={temperature:"stable",dosing:"chemostat",led:"silent"};var Bt=function(e){var t,a=Dt(),i=e.automationType,o="led"===i?"LED":i,c=Object(n.useState)(At[i]),s=Object(l.a)(c,2),m=s[0],u=s[1],d=Object(n.useState)({skip_first_run:0}),p=Object(l.a)(d,2),g=p[0],h=p[1],b=Object(n.useState)(null),v=Object(l.a)(b,2),y=v[0],O=v[1],j=Object(n.useState)({}),S=Object(l.a)(j,2),k=S[0],w=S[1],C=Object(n.useState)(!1),T=Object(l.a)(C,2),N=T[0],D=T[1];Object(n.useEffect)((function(){fetch("/contrib/automations/"+i).then((function(e){if(e.ok)return e.json();throw new Error("Something went wrong")})).then((function(e){w(Object.assign.apply(Object,[{}].concat(Object(be.a)(e.map((function(e){return Object(_.a)({},e.automation_name,e)}))))))})).catch((function(e){}))}),[i]),Object(n.useEffect)((function(){var t;e.config["cluster.topology"]&&((t=e.config.remote&&e.config.remote.ws_url?new f.Client("ws://".concat(e.config.remote.ws_url,"/"),"webui_ButtonChangeDialog"+Math.random()):new f.Client("".concat(e.config["cluster.topology"].leader_address),9001,"webui_ButtonChangeDialog"+Math.random())).connect({timeout:180}),O(t))}),[e.config]);var A=function(){e.onFinished()};return r.a.createElement(r.a.Fragment,null,r.a.createElement(se.a,{open:e.open,onClose:A,"aria-labelledby":"form-dialog-title",PaperProps:{style:{height:"100%"}}},r.a.createElement(ce.a,null,r.a.createElement(F.a,{className:a.suptitle},r.a.createElement(Me,{style:{verticalAlign:"middle",fontSize:"1.2em"}}),"$broadcast"===e.unit?r.a.createElement("b",null,"All active Pioreactors"):e.title||e.label?" ".concat(e.label," / ").concat(e.unit):"".concat(e.unit)),r.a.createElement(F.a,{className:a.unitTitleDialog},"Select ",o," automation"),r.a.createElement(jt.a,{"aria-label":"close",onClick:A,sx:{position:"absolute",right:8,top:8,color:function(e){return e.palette.grey[500]}},size:"large"},r.a.createElement(ct.a,null))),r.a.createElement(me.a,null,r.a.createElement(F.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("span",{style:{textTransform:"capitalize"}},o)," automations control the ",o," in the Pioreactor's vial. The settings below can be changed later. Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.pioreactor.com/user-guide/"+o+"-automations"},o," automations"),"."),r.a.createElement("form",null,r.a.createElement(He.a,{component:"fieldset",className:a.formControl},r.a.createElement(We.a,{component:"legend"},"Automation"),r.a.createElement(Ve.a,{native:!0,variant:"standard",value:m,onChange:function(t){u(t.target.value),h(Object(ve.a)({},!e.no_skip_first_run&&{skip_first_run:g.skip_first_run}))},style:{maxWidth:"200px"}},Object.keys(k).map((function(e){return r.a.createElement("option",{id:e,value:e,key:"change-io"+e},k[e].display_name)}))),Object.keys(k).length>0&&r.a.createElement(Nt,{fields:k[m].fields,description:k[m].description,updateParent:function(e){h((function(t){return Object(ve.a)(Object(ve.a)({},t),e)}))},name:m}),e.no_skip_first_run?r.a.createElement(r.a.Fragment,null):r.a.createElement(Ye.a,{control:r.a.createElement(Je.a,{checked:Boolean(g.skip_first_run),color:"primary",onChange:function(e){h(Object(ve.a)(Object(ve.a)({},g),{},{skip_first_run:e.target.checked?1:0}))},size:"small"}),label:"Skip first run"})))),r.a.createElement(ue.a,null,r.a.createElement(x.a,{type:"submit",variant:"contained",color:"primary",onClick:e.isJobRunning?function(t){t.preventDefault();var a=new f.Message(JSON.stringify({automation_name:m,type:i,args:g}));a.destinationName=["pioreactor",e.unit,e.experiment,"".concat(i,"_control"),"automation","set"].join("/"),a.qos=2;try{y.publish(a),D(!0)}catch(n){console.log(n)}A()}:function(t){t.preventDefault(),fetch("/run/".concat(i,"_control/").concat(e.unit),{method:"POST",body:JSON.stringify(Object(ve.a)({automation_name:m},g)),headers:{Accept:"application/json","Content-Type":"application/json"}}),D(!0),A()}},"Start"),r.a.createElement(x.a,{color:"secondary",onClick:A},"Cancel"))),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:N,onClose:function(){D(!1)},message:"Starting ".concat(o," automation ").concat(null===(t=k[m])||void 0===t?void 0:t.display_name,"."),autoHideDuration:7e3,key:"snackbar-change-"+i}))},Lt=Object(G.a)({actionTextField:{padding:"0px 10px 0px 0px",width:"175px"},actionForm:{padding:"20px 0px 0px 0px"}}),Pt={remove_waste:"Removing waste",add_media:"Adding media",add_alt_media:"Adding alt. media"};function Mt(e){var t,a,i,o=Lt(),c=Object(n.useState)(""),s=Object(l.a)(c,2),m=s[0],u=s[1],d=Object(n.useState)(""),p=Object(l.a)(d,2),f=p[0],g=p[1],h=Object(n.useState)(!1),b=Object(l.a)(h,2),v=b[0],y=b[1],_=Object(n.useState)(!1),O=Object(l.a)(_,2),j=O[0],S=O[1],k=Object(n.useState)(!1),w=Object(l.a)(k,2),C=w[0],T=w[1],N=Object(n.useState)(""),D=Object(l.a)(N,2),A=D[0],B=D[1],L=Object(n.useState)(!1),P=Object(l.a)(L,2),M=P[0],F=P[1],z=Object(n.useState)(!1),I=Object(l.a)(z,2),R=I[0],W=I[1],H=Object(n.useState)(!1),U=Object(l.a)(H,2),Y=U[0],J=U[1],V=Object(n.useState)(!1),$=Object(l.a)(V,2),G=$[0],K=$[1];return r.a.createElement("form",{id:e.action,className:o.actionForm},r.a.createElement(at.a,{name:"mL",autoComplete:"off",error:G||M,value:m,size:"small",id:e.action+"_mL",label:"mL",variant:"outlined",disabled:v,onChange:function(e){F(!1),S(!0),""===e.target.value&&S(!1),u(e.target.value),""===e.target.value||/^[0-9.\b]+$/.test(e.target.value)?K(!1):K(!0)},className:o.actionTextField}),r.a.createElement(at.a,{name:"duration",autoComplete:"off",value:f,error:Y||M,size:"small",id:e.action+"_duration",label:"seconds",variant:"outlined",disabled:j,onChange:function(e){F(!1),y(!0),""===e.target.value&&y(!1),g(e.target.value),""===e.target.value||/^[0-9.\b]+$/.test(e.target.value)?J(!1):J(!0)},className:o.actionTextField}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement($e.a,{loading:R&&"disconnected"===(null===e||void 0===e||null===(t=e.job)||void 0===t?void 0:t.state),disabled:G||Y||"ready"===(null===e||void 0===e||null===(a=e.job)||void 0===a?void 0:a.state),type:"submit",variant:"contained",size:"small",color:"primary",onClick:function(t){if(t.preventDefault(),""!==m||""!==f){W(!0);var a=""!==m?{ml:m,source_of_event:"UI"}:{duration:f,source_of_event:"UI"};fetch("/run/".concat(e.action,"/").concat(e.unit),{method:"POST",body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json"}}),B(Pt[e.action]+(""!==f?" for "+f+" seconds.":" until "+m+"mL is reached.")),T(!0),setTimeout((function(){return W(!1)}),2500)}else F(!0)}},e.action.replace(/_/g," ")),r.a.createElement("div",null,r.a.createElement(x.a,{size:"small",color:"primary",disabled:"ready"===(null===e||void 0===e||null===(i=e.job)||void 0===i?void 0:i.state),onClick:function(t){fetch("/run/".concat(e.action,"/").concat(e.unit),{method:"POST",body:JSON.stringify({continuously:!0,source_of_event:"UI"}),headers:{Accept:"application/json","Content-Type":"application/json"}}),B("Running pump continuously"),T(!0)}},"Run continuously"),r.a.createElement(x.a,{size:"small",color:"secondary",onClick:function(t){fetch("/stop/".concat(e.action,"/").concat(e.unit),{method:"POST"})}},"Interrupt"))),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:C,onClose:function(){T(!1)},message:A,autoHideDuration:7e3,key:"snackbar"+e.unit+e.action}))}var Ft=Object(G.a)({actionTextField:{padding:"0px 10px 0px 0px",width:"160px"},actionForm:{padding:"10px 0px 0px 0px"}});function zt(e){var t=Ft(),a=Object(n.useState)(!1),i=Object(l.a)(a,2),o=i[0],c=i[1],s=Object(n.useState)(""),m=Object(l.a)(s,2),u=m[0],d=m[1],p=Object(n.useState)(!1),f=Object(l.a)(p,2),g=f[0],h=f[1];return r.a.createElement("form",{id:e.action,className:t.actionForm},r.a.createElement(at.a,{error:g,name:"intensity",autoComplete:"off",value:u,size:"small",id:e.channel+"_intensity_edit",label:"new intensity",variant:"outlined",onChange:function(e){d(e.target.value),""===e.target.value||/^[0-9.\b]+$/.test(e.target.value)?h(!1):h(!0)},InputProps:{endAdornment:r.a.createElement(rt.a,{position:"end"},"%")},className:t.actionTextField}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(x.a,{type:"submit",variant:"contained",size:"small",color:"primary",onClick:function(t){if(t.preventDefault(),""!==u&&/^[0-9.\b]+$/.test(u)){var a;h(!1),c(!0);var n=(a={},Object(_.a)(a,e.channel,parseFloat(u)),Object(_.a)(a,"source_of_event","UI"),a);fetch("/run/led_intensity/".concat(e.unit),{method:"POST",body:JSON.stringify(n),headers:{Accept:"application/json","Content-Type":"application/json"}})}else h(!0)}},"Submit"),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:o,onClose:function(){c(!1)},message:"Updating channel ".concat(e.channel," to ").concat(u,"%."),autoHideDuration:7e3,key:"snackbar"+e.unit+e.channel}))}var It=["children","value","index"],Rt=Object(G.a)((function(e){return{lostRed:{color:"#DE3618"},readyGreen:{color:"#4caf50"},textIcon:{verticalAlign:"middle",margin:"0px 3px"},pioreactorCard:{marginTop:"0px",marginBottom:"20px"},cardContent:{padding:"10px 20px 20px 20px"},unitTitle:{fontSize:20,color:"rgba(0, 0, 0, 0.87)",fontWeight:500},suptitle:{fontSize:"13px",color:"rgba(0, 0, 0, 0.60)"},disabledText:{color:"rgba(0, 0, 0, 0.38)"},textbox:{width:"130px",marginTop:"10px"},textboxLabel:{width:"100px",marginTop:"10px",marginRight:"5px"},footnote:{marginBottom:0,fontSize:12},textField:{marginTop:"15px",maxWidth:"180px"},textFieldWide:{marginTop:"15px",maxWidth:"220px"},textFieldCompact:{marginTop:"15px",width:"120px"},slider:{width:"70%",margin:"40px auto 0px auto"},divider:{marginTop:15,marginBottom:10},jobButton:{paddingRight:"15px",paddingLeft:"15px"},unitSettingsSubtext:{fontSize:"11px"},unitSettingsSubtextEmpty:{minHeight:"15px"},ledBlock:{width:"55px",display:"inline-block"},rowOfUnitSettingDisplay:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"stretch",alignContent:"stretch"},testingListItemIcon:{minWidth:"30px"},testingListItem:{paddingTop:"0px",paddingBottom:"0px"},headerMenu:Object(_.a)({display:"flex",justifyContent:"space-between",marginBottom:"5px"},e.breakpoints.down("lg"),{flexFlow:"nowrap",flexDirection:"column"}),cardHeaderSettings:Object(_.a)({display:"flex",justifyContent:"space-between"},e.breakpoints.down("md"),{flexFlow:"nowrap",flexDirection:"column"}),cardHeaderButtons:Object(_.a)({display:"flex",justifyContent:"flex-end",flexDirection:"row",flexWrap:"wrap"},e.breakpoints.down("md"),{justifyContent:"space-between"}),headerButtons:{display:"flex",flexDirection:"row",justifyContent:"flex-start",flexFlow:"wrap"}}}));function Wt(e){var t=e.children,a=e.value,n=e.index,i=Object(Xe.a)(e,It);return r.a.createElement("div",Object.assign({role:"tabpanel",hidden:a!==n,id:"simple-tabpanel-".concat(n),key:"simple-tabpanel-".concat(n),"aria-labelledby":"simple-tab-".concat(n)},i),a===n&&r.a.createElement("div",null,t))}function Ht(e){var t=Rt();return e.subtext?r.a.createElement("div",{className:t.unitSettingsSubtext},r.a.createElement("code",null,e.subtext)):r.a.createElement("div",{className:t.unitSettingsSubtextEmpty})}function Ut(e){var t=Rt(),a={init:{display:"Starting",color:"#4caf50"},ready:{display:"On",color:"#4caf50"},sleeping:{display:"Paused",color:"grey"},disconnected:{display:"Off",color:"grey"},lost:{display:"Lost",color:"#DE3618"},NA:{display:"Not available",color:"grey"}},n=null===e.value?"":e.value;function i(e){return e>=10?e.toFixed(0):0===e?"0":e<1?"<1":e.toFixed(1).replace(/[.,]0$/,"")}if(e.isStateSetting){if(e.isUnitActive){var o=a[n];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{color:o.color,fontWeight:500}},o.display),r.a.createElement(Ht,{subtext:e.subtext}))}return r.a.createElement("div",{className:Object(D.a)(Object(_.a)({},t.disabledText,!e.isUnitActive))}," ",a[n].display," ")}if(e.isLEDIntensity){if(e.isUnitActive&&"\u2014"!==n&&""!==n){var l=JSON.parse(n),c=e.config.leds,s=c.A?c.A.replace("_"," "):null,m=c.B?c.B.replace("_"," "):null,u=c.C?c.C.replace("_"," "):null,d=c.D?c.D.replace("_"," "):null;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{fontSize:"13px"}},r.a.createElement("div",null,r.a.createElement("span",{className:t.ledBlock},r.a.createElement(Fe,{title:s||null},"A"),": ",i(l.A),"%"),r.a.createElement("span",{className:t.ledBlock},r.a.createElement(Fe,{title:m||null},"B"),": ",i(l.B),"%")),r.a.createElement("div",null,r.a.createElement("span",{className:t.ledBlock},r.a.createElement(Fe,{title:u||null},"C"),": ",i(l.C),"%"),r.a.createElement("span",{className:t.ledBlock},r.a.createElement(Fe,{title:d||null},"D"),": ",i(l.D),"%"))),r.a.createElement(Ht,{subtext:e.subtext}))}return r.a.createElement("div",{style:{color:"grey",fontSize:"13px"}}," ",e.default," ")}return e.isUnitActive&&"\u2014"!==n&&""!==n?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{fontSize:"13px"}},("string"===typeof n?n:+n.toFixed(e.precision))+" "+(e.measurementUnit?e.measurementUnit:"")),r.a.createElement(Ht,{subtext:e.subtext})):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{color:"grey",fontSize:"13px"}}," ",e.default," "),r.a.createElement(Ht,{subtext:e.subtext}))}function Yt(){var e=Rt(),t=Object(n.useState)(!1),a=Object(l.a)(t,2),i=a[0],o=a[1],c=function(){o(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{style:{textTransform:"none",float:"right"},color:"secondary",onClick:function(){o(!0)}},r.a.createElement(ie.a,{fontSize:"15",classes:{root:e.textIcon}})," Stop all activity"),r.a.createElement(se.a,{open:i,onClose:c,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(ce.a,{id:"alert-dialog-title"},'"Stop all Pioreactor activity?"'),r.a.createElement(me.a,null,r.a.createElement(de.a,{id:"alert-dialog-description"},"This will stop all activies (stirring, dosing, optical density reading, etc.) in ",r.a.createElement("b",null,"all")," Pioreactor units. Do you wish to stop all activities?")),r.a.createElement(ue.a,null,r.a.createElement(x.a,{onClick:function(){fetch("/stop_all",{method:"POST"}),c()},color:"primary"},"Confirm"),r.a.createElement(x.a,{onClick:c,color:"secondary",autoFocus:!0},"Cancel"))))}function Jt(e){var t=Rt(),a=Object(n.useState)(!1),i=Object(l.a)(a,2),o=i[0],c=i[1],s=Object(n.useState)(!1),m=Object(l.a)(s,2),u=m[0],d=m[1],p=r.a.useState(""),f=Object(l.a)(p,2),g=f[0],h=f[1],b=r.a.useState(!1),v=Object(l.a)(b,2),y=v[0],_=v[1],O=r.a.useState(""),j=Object(l.a)(O,2),S=j[0],k=j[1],w=r.a.useState(!1),C=Object(l.a)(w,2),T=C[0],N=C[1],A=r.a.useState(""),B=Object(l.a)(A,2),L=B[0],P=B[1],M=r.a.useState(!1),F=Object(l.a)(M,2),z=F[0],I=F[1],R=r.a.useState(""),W=Object(l.a)(R,2),H=W[0],U=W[1],Y=function(){c(!1)},J=z?r.a.createElement(tt.a,{color:"inherit",size:24}):"Add Pioreactor";return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{onClick:function(){c(!0)},style:{textTransform:"none",float:"right",marginRight:"0px"},color:"primary"},r.a.createElement(le.a,{fontSize:"15",classes:{root:t.textIcon}})," Add new Pioreactor"),r.a.createElement(se.a,{open:o,onClose:Y,"aria-labelledby":"form-dialog-title"},r.a.createElement(ce.a,null,"Add new Pioreactor",r.a.createElement(jt.a,{"aria-label":"close",onClick:Y,sx:{position:"absolute",right:8,top:8,color:function(e){return e.palette.grey[500]}},size:"large"},r.a.createElement(ct.a,null))),r.a.createElement(me.a,null,r.a.createElement("p",null,"Follow the instructions to ",r.a.createElement("a",{href:"https://docs.pioreactor.com/user-guide/software-set-up#adding-workers-to-your-cluster"},"set up your Pioreactor's Raspberry Pi"),"."),r.a.createElement("p",null,"Below, provide the hostname you used when installing the Pioreactor image onto the Raspberry Pi. Your existing Pioreactors will automatically connect it to the cluster. When finished, the new Pioreactor will show up on this page."),r.a.createElement("div",null,r.a.createElement(at.a,{required:!0,size:"small",id:"new-pioreactor-name",label:"Provide hostname",variant:"outlined",className:t.textFieldWide,onChange:function(e){h(e.target.value)},value:g,InputProps:{startAdornment:r.a.createElement(rt.a,{position:"start"},r.a.createElement(Me,{style:{fontSize:"1.1em"}}))}})),r.a.createElement("div",{style:{minHeight:"60px",alignItems:"center",display:"flex"}},y?r.a.createElement("p",null,r.a.createElement(ct.a,{className:Object(D.a)(t.textIcon,t.lostRed)}),S):r.a.createElement(r.a.Fragment,null),z?r.a.createElement("p",null,H):r.a.createElement(r.a.Fragment,null),T?r.a.createElement("p",null,r.a.createElement(mt.a,{className:Object(D.a)(t.textIcon,t.readyGreen)}),L):r.a.createElement(r.a.Fragment,null)),r.a.createElement(x.a,{variant:"contained",color:"primary",style:{marginTop:"15px"},onClick:function(e){if(e.preventDefault(),!g)return _(!0),void k("Provide the hostname for the new Pioreactor worker");_(!1),N(!1),I(!0),U("Installation is occurring..."),fetch("add_new_pioreactor",{method:"POST",body:JSON.stringify({newPioreactorName:g}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){I(!1),U(""),e.ok?(N(!0),P("Success! Rebooting ".concat(g," now. Refresh to see ").concat(g," in your cluster."))):(_(!0),e.json().then((function(e){return k("Unable to complete installation. The following error occurred: ".concat(e.msg))})))}))},type:"submit"},J))),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:u,onClose:function(){d(!1)},message:"Adding new Pioreactor ".concat(g),autoHideDuration:7e3,key:"snackbar-add-new"}))}function Vt(e){var t=Rt();return r.a.createElement("div",null,r.a.createElement("div",{className:t.headerMenu},r.a.createElement(F.a,{variant:"h5",component:"h1"},r.a.createElement(z.a,{fontWeight:"fontWeightBold"},"Pioreactors")),r.a.createElement("div",{className:t.headerButtons},r.a.createElement(Yt,null),r.a.createElement(Jt,{config:e.config}),r.a.createElement(Zt,{config:e.config,experiment:e.experiment}))),r.a.createElement(Z.a,null))}function $t(e){var t=Object(n.useState)(e.buttonText),a=Object(l.a)(t,2),i=a[0],o=a[1];return Object(n.useEffect)((function(){o(e.buttonText)}),[e.buttonText]),r.a.createElement(x.a,{disableElevation:!0,style:{width:"70px",marginTop:"5px",height:"31px"},color:e.color,variant:e.variant,disabled:e.disabled,size:"small",onClick:function(){o(r.a.createElement(tt.a,{color:"inherit",size:21})),e.onClick()}},i)}function Gt(e){var t=Rt(),a=Object(n.useState)(!1),i=Object(l.a)(a,2),o=i[0],c=i[1],s=r.a.useState(0),m=Object(l.a)(s,2),u=m[0],d=m[1],p=function(){c(!1),setTimeout((function(){return d(0)}),200)};function f(t){return function(){fetch("/run/"+t+"/"+e.unit,{method:"POST"})}}function g(e,t){switch(e){case"disconnected":return r.a.createElement("div",null,r.a.createElement($t,{color:"primary",variant:"contained",onClick:f(t),buttonText:"Start"}));case"ready":return r.a.createElement("div",null,r.a.createElement($t,{color:"primary",variant:"contained",buttonText:"Running",disabled:!0}));default:return r.a.createElement("div",null)}}var h=g(e.odBlankJobState,"od_blank"),E=g(e.stirringCalibrationState,"stirring_calibration");return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{style:{textTransform:"none",float:"right"},color:"primary",disabled:e.disabled,onClick:function(){c(!0)}},r.a.createElement(ht.a,{color:e.disabled?"disabled":"primary",fontSize:"15",classes:{root:t.textIcon}})," Calibrate"),r.a.createElement(se.a,{open:o,onClose:p,"aria-labelledby":"form-dialog-title"},r.a.createElement(ce.a,null,r.a.createElement(F.a,{className:t.suptitle},r.a.createElement(Me,{style:{verticalAlign:"middle",fontSize:"1.2em"}})," ",e.label?"".concat(e.label," / ").concat(e.unit):"".concat(e.unit)),r.a.createElement(it.a,{value:u,onChange:function(e,t){d(t)},indicatorColor:"primary",textColor:"primary"},r.a.createElement(ot.a,{label:"Blanks"}),r.a.createElement(ot.a,{label:"Stirring"}),r.a.createElement(ot.a,{label:"Dosing",disabled:!0})),r.a.createElement(jt.a,{"aria-label":"close",onClick:p,sx:{position:"absolute",right:8,top:8,color:function(e){return e.palette.grey[500]}},size:"large"},r.a.createElement(ct.a,null))),r.a.createElement(me.a,null,r.a.createElement(Wt,{value:u,index:0},r.a.createElement(F.a,{gutterBottom:!0},"Record optical densities of blank (optional)"),r.a.createElement(F.a,{variant:"body2",component:"p",gutterBottom:!0},"For more accurate growth rate and biomass inferences, you can subtract out the media's optical density per sensor. Read more about ",r.a.createElement("a",{href:""},"using blanks"),"."),h,r.a.createElement(F.a,{variant:"body2",component:"p",style:{marginTop:"20px"}},"Recorded optical densities of blank vial: ",r.a.createElement("code",null,e.odBlankReading?Object.entries(JSON.parse(e.odBlankReading)).map((function(e){var t=Object(l.a)(e,2),a=t[0],n=t[1];return"".concat(a,":").concat(n.toFixed(4))})).join(", "):"\u2014")),r.a.createElement(Z.a,{className:t.divider})),r.a.createElement(Wt,{value:u,index:1},r.a.createElement(F.a,{gutterBottom:!0},"Stirring calibration (optional)"),r.a.createElement(F.a,{variant:"body2",component:"p",gutterBottom:!0},"You can improve the responsiveness of stirring RPM changes by running the below calibration. This calibration is optional, and stirring RPM changes can still occur without running this calibration."),r.a.createElement(F.a,{variant:"body2",component:"p",gutterBottom:!0},"Add a vial, with a stirbar and ~15ml water, to the Pioreactor, then hit Start below. This calibration will take less than three minutes."),E,r.a.createElement(Z.a,{className:t.divider})))))}function Kt(e){var t=Rt(),a=Object(n.useState)(!1),i=Object(l.a)(a,2),o=i[0],c=i[1],s=function(){c(!1)};function m(t){return function(){fetch("/run/"+t+"/"+e.unit,{method:"POST"})}}function u(a,n){return null==e.selfTestTests?r.a.createElement(yt.a,null):1===e.selfTestTests[a].value?r.a.createElement(mt.a,{className:t.readyGreen}):0===e.selfTestTests[a].value?r.a.createElement(ct.a,{className:t.lostRed}):"ready"===n?r.a.createElement(tt.a,{size:20}):r.a.createElement(yt.a,null)}function d(){return e.disabled?"disabled":"primary"}var p=function(e,t){switch(e){case"disconnected":return r.a.createElement("div",null,r.a.createElement($t,{color:"primary",variant:"contained",onClick:m(t),buttonText:"Start"}));case"ready":return r.a.createElement("div",null,r.a.createElement($t,{color:"primary",variant:"contained",disabled:!0,buttonText:"Running"}));default:return r.a.createElement("div",null)}}(e.selfTestState,"self_test");return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{style:{textTransform:"none",float:"right"},color:"primary",disabled:e.disabled,onClick:function(){c(!0)}},null==e.selfTestTests?r.a.createElement(Ct.a,{color:d(),fontSize:"15",classes:{root:t.textIcon}}):e.selfTestTests.all_tests_passed.value?r.a.createElement(bt.a,{color:d(),fontSize:"15",classes:{root:t.textIcon}}):r.a.createElement(Ct.a,{color:d(),fontSize:"15",classes:{root:t.textIcon}})," Self test"),r.a.createElement(se.a,{open:o,onClose:s},r.a.createElement(ce.a,null,r.a.createElement(F.a,{className:t.suptitle,gutterBottom:!0},r.a.createElement(Me,{style:{verticalAlign:"middle",fontSize:"1.2em"}})," ",e.label?"".concat(e.label," / ").concat(e.unit):"".concat(e.unit)),"Self test",r.a.createElement(jt.a,{"aria-label":"close",onClick:s,sx:{position:"absolute",right:8,top:8,color:function(e){return e.palette.grey[500]}},size:"large"},r.a.createElement(ct.a,null))),r.a.createElement(me.a,null,r.a.createElement(F.a,{variant:"body2",component:"p",gutterBottom:!0},"Perform a check of the heating & temperature sensor, LEDs & photodiodes, and stirring."),p,r.a.createElement(Z.a,{className:t.divider}),r.a.createElement(Ot.a,{component:"nav",subheader:r.a.createElement(kt.a,{style:{lineHeight:"20px"},component:"div",disableSticky:!0,disableGutters:!0},"LEDs & photodiodes")},r.a.createElement(St.a,{className:t.testingListItem},r.a.createElement(xt.a,{className:t.testingListItemIcon},u("test_pioreactor_HAT_present",e.selfTestState)),r.a.createElement(_t.a,{primary:"Pioreactor HAT is detected"})),r.a.createElement(St.a,{className:t.testingListItem},r.a.createElement(xt.a,{className:t.testingListItemIcon},u("test_all_positive_correlations_between_pds_and_leds",e.selfTestState)),r.a.createElement(_t.a,{primary:"Photodiodes are responsive to IR LED",secondary:e.selfTestTests?JSON.parse(e.selfTestTests.correlations_between_pds_and_leds.value).map((function(e){return"".concat(e[0]," \u21dd ").concat(e[1])})).join(",  "):""})),r.a.createElement(St.a,{className:t.testingListItem},r.a.createElement(xt.a,{className:t.testingListItemIcon},u("test_ambient_light_interference",e.selfTestState)),r.a.createElement(_t.a,{primary:"No ambient IR light detected"})),r.a.createElement(St.a,{className:t.testingListItem},r.a.createElement(xt.a,{className:t.testingListItemIcon},u("test_REF_is_lower_than_0_dot_256_volts",e.selfTestState)),r.a.createElement(_t.a,{primary:"Reference photodiode is correct magnitude"})),r.a.createElement(St.a,{className:t.testingListItem},r.a.createElement(xt.a,{className:t.testingListItemIcon},u("test_REF_is_in_correct_position",e.selfTestState)),r.a.createElement(_t.a,{primary:"Reference photodiode is in correct position"}))),r.a.createElement(Ot.a,{component:"nav",subheader:r.a.createElement(kt.a,{style:{lineHeight:"20px"},component:"div",disableSticky:!0,disableGutters:!0},"Heating & temperature")},r.a.createElement(St.a,{className:t.testingListItem},r.a.createElement(xt.a,{className:t.testingListItemIcon},u("test_detect_heating_pcb",e.selfTestState)),r.a.createElement(_t.a,{primary:"Heating PCB is detected"})),r.a.createElement(St.a,{className:t.testingListItem},r.a.createElement(xt.a,{className:t.testingListItemIcon},u("test_positive_correlation_between_temperature_and_heating",e.selfTestState)),r.a.createElement(_t.a,{primary:"Heating is responsive"}))),r.a.createElement(Ot.a,{component:"nav",subheader:r.a.createElement(kt.a,{style:{lineHeight:"20px"},component:"div",disableSticky:!0,disableGutters:!0},"Stirring")},r.a.createElement(St.a,{className:t.testingListItem},r.a.createElement(xt.a,{className:t.testingListItemIcon},u("test_positive_correlation_between_rpm_and_stirring",e.selfTestState)),r.a.createElement(_t.a,{primary:"Stirring RPM is responsive"}))),r.a.createElement(Z.a,{className:t.divider}))))}function qt(e){var t=Rt(),a=Object(n.useState)(!1),i=Object(l.a)(a,2),o=i[0],c=i[1],s=Object(n.useState)(!1),m=Object(l.a)(s,2),u=m[0],d=m[1],p=Object(n.useState)(""),g=Object(l.a)(p,2),h=g[0],b=g[1],v=r.a.useState(0),y=Object(l.a)(v,2),_=y[0],O=y[1],j=r.a.useState(!1),S=Object(l.a)(j,2),k=S[0],w=S[1],C=r.a.useState(!1),T=Object(l.a)(C,2),N=T[0],A=T[1],B=r.a.useState(!1),L=Object(l.a)(B,2),P=L[0],M=L[1];function z(e,t){return function(){W("".concat(e,"/$state"),t)}}function I(t){return function(){fetch("/run/"+t+"/"+e.unit,{method:"POST"})}}function R(e){return function(){W("".concat(e,"/$state"),"disconnected")}}function W(t,a){var n=new f.Message(String(a));n.destinationName=["pioreactor",e.unit,e.experiment,t,"set"].join("/"),n.qos=1;try{e.client.publish(n)}catch(r){console.log(r),e.client.connect({onSuccess:function(){return W(t,a)}})}}var H=function(){c(!1),setTimeout((function(){return O(0)}),200)};function U(e,t){switch(e){case"lost":return r.a.createElement("div",{key:"patient_buttons_"+t},r.a.createElement($t,{color:"secondary",variant:"contained",onClick:I(t),buttonText:"Start"}));case"disconnected":return r.a.createElement("div",{key:"patient_buttons_"+t},r.a.createElement($t,{color:"primary",variant:"contained",onClick:I(t),buttonText:"Start"}));case"init":return r.a.createElement("div",{key:"patient_buttons_"+t},r.a.createElement($t,{color:"primary",variant:"contained",onClick:function(){return!1},buttonText:r.a.createElement(tt.a,{color:"inherit",size:22}),disabled:!0}),r.a.createElement($t,{color:"secondary",onClick:R(t),buttonText:"Stop"}));case"ready":return r.a.createElement("div",{key:"patient_buttons_"+t},r.a.createElement($t,{color:"secondary",variant:"contained",onClick:z(t,"sleeping"),buttonText:"Pause"}),r.a.createElement($t,{color:"secondary",onClick:R(t),buttonText:"Stop"}));case"sleeping":return r.a.createElement("div",{key:"patient_buttons_"+t},r.a.createElement($t,{color:"primary",variant:"contained",onClick:z(t,"ready"),buttonText:"Resume"}),r.a.createElement($t,{color:"secondary",onClick:R(t),buttonText:"Stop"}));default:return r.a.createElement("div",{key:"patient_buttons_"+t})}}var Y=e.config.leds,J=Object.fromEntries(Object.entries(e.jobs).map((function(e,t){var a=Object(l.a)(e,2),n=a[0];return[n,U(a[1].state,n)]}))),V={init:{display:"Starting",color:"#4caf50"},ready:{display:"On",color:"#4caf50"},sleeping:{display:"Paused",color:"grey"},disconnected:{display:"Off",color:"grey"},lost:{display:"Lost",color:"#DE3618"},NA:{display:"Not available",color:"grey"}},$=Object(et.a)((function(e){return e.breakpoints.down("xl")})),G=e.jobs.dosing_control,K=["ready","sleeping","init"].includes(null===G||void 0===G?void 0:G.state),q=e.jobs.led_control,Q=["ready","sleeping","init"].includes(null===q||void 0===q?void 0:q.state),X=e.jobs.temperature_control,ee=["ready","sleeping","init"].includes(null===X||void 0===X?void 0:X.state);return r.a.createElement("div",null,r.a.createElement(x.a,{style:{textTransform:"none",float:"right"},disabled:e.disabled,onClick:function(){c(!0)},color:"primary"},r.a.createElement(ft.a,{color:e.disabled?"disabled":"primary",fontSize:"15",classes:{root:t.textIcon}})," Manage"),r.a.createElement(se.a,{maxWidth:$?"sm":"md",fullWidth:!0,open:o,onClose:H},r.a.createElement(ce.a,null,r.a.createElement(F.a,{className:t.suptitle},r.a.createElement(Me,{style:{verticalAlign:"middle",fontSize:"1.2em"}}),r.a.createElement("span",null," ",e.label?"".concat(e.label," / ").concat(e.unit):"".concat(e.unit)," ")),r.a.createElement(jt.a,{"aria-label":"close",onClick:H,sx:{position:"absolute",right:8,top:8,color:function(e){return e.palette.grey[500]}},size:"large"},r.a.createElement(ct.a,null)),r.a.createElement(it.a,{value:_,onChange:function(e,t){O(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:!0,allowScrollButtonsMobile:!0},r.a.createElement(ot.a,{label:"Activities"}),r.a.createElement(ot.a,{label:"Settings"}),r.a.createElement(ot.a,{label:"Dosing"}),r.a.createElement(ot.a,{label:"LEDs"}),r.a.createElement(ot.a,{label:"System"}))),r.a.createElement(me.a,null,r.a.createElement(Wt,{value:_,index:0},Object.entries(e.jobs).filter((function(e){var t=Object(l.a)(e,2);t[0];return t[1].metadata.display})).filter((function(e){var t=Object(l.a)(e,2),a=t[0];t[1];return!["dosing_control","led_control","temperature_control"].includes(a)})).map((function(e){var a=Object(l.a)(e,2),n=a[0],i=a[1];return r.a.createElement("div",{key:n},r.a.createElement("div",{style:{justifyContent:"space-between",display:"flex"}},r.a.createElement(F.a,{display:"block"},i.metadata.name),r.a.createElement(F.a,{display:"block",gutterBottom:!0},r.a.createElement("span",{style:{color:V[i.state].color}},V[i.state].display))),r.a.createElement(F.a,{variant:"caption",display:"block",gutterBottom:!0,color:"textSecondary"},"app"!==i.metadata.source?"Installed by ".concat(i.metadata.source):""),r.a.createElement(F.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:i.metadata.description}})),J[n],r.a.createElement(Z.a,{className:t.divider}))})),X&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{justifyContent:"space-between",display:"flex"}},r.a.createElement(F.a,{display:"block"},"Temperature automation"),r.a.createElement(F.a,{display:"block",gutterBottom:!0},r.a.createElement("span",{style:{color:V[X.state].color}},V[X.state].display))),r.a.createElement(F.a,{variant:"caption",display:"block",gutterBottom:!0,color:"textSecondary"}),r.a.createElement("div",{key:X.metadata.key},"ready"===X.state||"sleeping"===X.state?r.a.createElement(r.a.Fragment,null,r.a.createElement(F.a,{variant:"body2",component:"p",gutterBottom:!0},"Currently running temperature automation ",r.a.createElement("code",null,X.automation_name.value),". Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.pioreactor.com/user-guide/temperature-automations"},"temperature automations"),"."),J[X.metadata.key]):r.a.createElement(r.a.Fragment,null,r.a.createElement(F.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:X.metadata.description}})),r.a.createElement(x.a,{style:{width:"70px",marginTop:"5px"},size:"small",color:"primary",variant:"contained",onClick:function(){return M(!0)}},"Start"))),r.a.createElement(x.a,{onClick:function(){return M(!0)},style:{marginTop:"10px"},size:"small",color:"primary",disabled:!ee},"Change temperature automation"),r.a.createElement(Bt,{open:P,onFinished:function(){return M(!1)},unit:e.unit,label:e.label,config:e.config,experiment:e.experiment,isJobRunning:ee,automationType:"temperature",no_skip_first_run:!0})),r.a.createElement(Z.a,{className:t.divider}),G&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{justifyContent:"space-between",display:"flex"}},r.a.createElement(F.a,{display:"block"},"Dosing automation"),r.a.createElement(F.a,{display:"block",gutterBottom:!0},r.a.createElement("span",{style:{color:V[G.state].color}},V[G.state].display))),r.a.createElement(F.a,{variant:"caption",display:"block",gutterBottom:!0,color:"textSecondary"}),r.a.createElement("div",{key:G.metadata.key},"ready"===G.state||"sleeping"===G.state?r.a.createElement(r.a.Fragment,null,r.a.createElement(F.a,{variant:"body2",component:"p",gutterBottom:!0},"Currently running dosing automation ",r.a.createElement("code",null,G.automation_name.value),". Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.pioreactor.com/user-guide/dosing-automations"},"dosing automations"),"."),J[G.metadata.key]):r.a.createElement(r.a.Fragment,null,r.a.createElement(F.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:G.metadata.description}})),r.a.createElement(x.a,{style:{width:"70px",marginTop:"5px"},size:"small",color:"primary",variant:"contained",onClick:function(){return w(!0)}},"Start"))),r.a.createElement(x.a,{onClick:function(){return w(!0)},style:{marginTop:"10px"},size:"small",color:"primary",disabled:!K},"Change dosing automation"),r.a.createElement(Bt,{automationType:"dosing",open:k,onFinished:function(){return w(!1)},unit:e.unit,label:e.label,config:e.config,experiment:e.experiment,isJobRunning:K,no_skip_first_run:!1})),r.a.createElement(Z.a,{className:t.divider}),q&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{justifyContent:"space-between",display:"flex"}},r.a.createElement(F.a,{display:"block"},"LED automation"),r.a.createElement(F.a,{display:"block",gutterBottom:!0},r.a.createElement("span",{style:{color:V[q.state].color}},V[q.state].display))),r.a.createElement(F.a,{variant:"caption",display:"block",gutterBottom:!0,color:"textSecondary"}),r.a.createElement("div",{key:q.metadata.key},"ready"===q.state||"sleeping"===q.state?r.a.createElement(r.a.Fragment,null,r.a.createElement(F.a,{variant:"body2",component:"p",gutterBottom:!0},"Currently running LED automation ",r.a.createElement("code",null,q.automation_name.value),". Learn more about ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.pioreactor.com/user-guide/led-automations"},"LED automations"),"."),J[q.metadata.key]):r.a.createElement(r.a.Fragment,null,r.a.createElement(F.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:q.metadata.description}})),r.a.createElement(x.a,{style:{width:"70px",marginTop:"5px"},size:"small",color:"primary",variant:"contained",onClick:function(){return A(!0)}},"Start"))),r.a.createElement(x.a,{onClick:function(){return A(!0)},style:{marginTop:"10px"},size:"small",color:"primary",disabled:!Q},"Change LED automation"),r.a.createElement(Bt,{automationType:"led",open:N,onFinished:function(){return A(!1)},unit:e.unit,config:e.config,label:e.label,experiment:e.experiment,isJobRunning:Q,no_skip_first_run:!1})),r.a.createElement(Z.a,{className:t.divider})),r.a.createElement(Wt,{value:_,index:1},r.a.createElement(F.a,{gutterBottom:!0},"Assign label to Pioreactor"),r.a.createElement(F.a,{variant:"body2",component:"p"},"Temporarily assign a label to this Pioreactor for the duration of the experiment. The new label will display in graph legends, and throughout the interface."),r.a.createElement(at.a,{size:"small",autoComplete:"off",defaultValue:e.label,variant:"outlined",className:t.textFieldCompact,onKeyPress:function(t){if("Enter"===t.key&&t.target.value){var a=t.target.value;b("Updating to ".concat(a)),d(!0),fetch("/update_current_unit_labels",{method:"POST",body:JSON.stringify({label:a,unit:e.unit}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(t){t.ok&&e.setLabel(a)}))}},InputProps:{autoComplete:"new-password"}}),r.a.createElement(Z.a,{className:t.divider}),Object.values(e.jobs).filter((function(e){return e.metadata.display})).map((function(e){return Object.entries(e).filter((function(e){var t=Object(l.a)(e,2),a=t[0];t[1];return"state"!==a&&"metadata"!==a})).filter((function(e){var t=Object(l.a)(e,2);t[0];return t[1].display})).map((function(a){var n,i=Object(l.a)(a,2),o=i[0],c=i[1];return r.a.createElement(r.a.Fragment,{key:o},r.a.createElement(F.a,{gutterBottom:!0},c.label),r.a.createElement(F.a,{variant:"body2",component:"p"},c.description),r.a.createElement(at.a,{size:"small",autoComplete:"off",id:"".concat(e.metadata.key.replace("_control","_automation"),"/").concat(o),defaultValue:c.value,InputProps:{endAdornment:r.a.createElement(rt.a,{position:"end"},c.unit),autoComplete:"new-password"},variant:"outlined",onKeyPress:(n=c.unit,function(e){"Enter"===e.key&&e.target.value&&(W(e.target.id,e.target.value),b("Updating to ".concat(e.target.value," ").concat(n,".")),d(!0))}),className:t.textFieldCompact}),r.a.createElement(Z.a,{className:t.divider}))}))}))),r.a.createElement(Wt,{value:_,index:2},r.a.createElement(F.a,{gutterBottom:!0},"Add media"),r.a.createElement(F.a,{variant:"body2",component:"p"},"Run the media pump for a set duration (seconds), or a set volume (mL)."),r.a.createElement(Mt,{action:"add_media",unit:e.unit,job:e.jobs.add_media}),r.a.createElement(Z.a,{classes:{root:t.divider}}),r.a.createElement(F.a,{gutterBottom:!0},"Remove waste"),r.a.createElement(F.a,{variant:"body2",component:"p"},"Run the waste pump for a set duration (seconds), or a set volume (mL)."),r.a.createElement(Mt,{action:"remove_waste",unit:e.unit,job:e.jobs.remove_waste}),r.a.createElement(Z.a,{className:t.divider}),r.a.createElement(F.a,{gutterBottom:!0},"Add alternative media"),r.a.createElement(F.a,{variant:"body2",component:"p"},"Run the alternative media pump for a set duration (seconds), or a set volume (mL)."),r.a.createElement(Mt,{action:"add_alt_media",unit:e.unit,job:e.jobs.add_alt_media}),r.a.createElement(Z.a,{className:t.divider})),r.a.createElement(Wt,{value:_,index:3},r.a.createElement(F.a,{className:Object(D.a)(t.suptitle),color:"textSecondary"},Y.A?"Channel A":""),r.a.createElement(F.a,{style:{textTransform:"capitalize"}},Y.A?Y.A.replace("_"," ").replace("led","LED"):"Channel A"),r.a.createElement(zt,{channel:"A",unit:e.unit}),r.a.createElement(Z.a,{className:t.divider}),r.a.createElement(F.a,{className:Object(D.a)(t.suptitle),color:"textSecondary"},Y.B?"Channel B":""),r.a.createElement(F.a,{style:{textTransform:"capitalize"}},Y.B?Y.B.replace("_"," ").replace("led","LED"):"Channel B"),r.a.createElement(zt,{channel:"B",unit:e.unit}),r.a.createElement(Z.a,{className:t.divider}),r.a.createElement(F.a,{className:Object(D.a)(t.suptitle),color:"textSecondary"},Y.C?"Channel C":""),r.a.createElement(F.a,{style:{textTransform:"capitalize"}},Y.C?Y.C.replace("_"," ").replace("led","LED"):"Channel C"),r.a.createElement(zt,{channel:"C",unit:e.unit}),r.a.createElement(Z.a,{className:t.divider}),r.a.createElement(F.a,{className:Object(D.a)(t.suptitle),color:"textSecondary"},Y.D?"Channel D":""),r.a.createElement(F.a,{style:{textTransform:"capitalize"}},Y.D?Y.D.replace("_"," ").replace("led","LED"):"Channel D"),r.a.createElement(zt,{channel:"D",unit:e.unit}),r.a.createElement(Z.a,{className:t.divider})),r.a.createElement(Wt,{value:_,index:4},r.a.createElement(F.a,{gutterBottom:!0},"Reboot"),r.a.createElement(F.a,{variant:"body2",component:"p"},"Reboot the Raspberry Pi operating system. This will stop all jobs, and the Pioreactor will be inaccessible for a few minutes."),r.a.createElement(x.a,{variant:"contained",color:"primary",size:"small",style:{marginTop:"15px"},onClick:function(){fetch("/reboot/"+e.unit,{method:"POST"})}},"Reboot"),r.a.createElement(Z.a,{className:t.divider})))),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:u,onClose:function(){d(!1)},message:h,autoHideDuration:7e3,resumeHideDuration:2e3,key:"snackbar"+e.unit+"settings"}))}function Zt(e){var t=e.config,a=e.experiment,i=Rt(),o="$broadcast",c=Object(n.useState)(!1),s=Object(l.a)(c,2),m=s[0],u=s[1],d=Object(n.useState)(null),p=Object(l.a)(d,2),g=p[0],h=p[1],b=Object(n.useState)(!1),v=Object(l.a)(b,2),y=v[0],_=v[1],O=Object(n.useState)(""),j=Object(l.a)(O,2),S=j[0],k=j[1],w=r.a.useState(0),C=Object(l.a)(w,2),T=C[0],N=C[1],D=r.a.useState({}),A=Object(l.a)(D,2),B=A[0],L=A[1],P=r.a.useState(!1),M=Object(l.a)(P,2),z=M[0],I=M[1],R=r.a.useState(!1),W=Object(l.a)(R,2),H=W[0],U=W[1],Y=r.a.useState(!1),J=Object(l.a)(Y,2),V=J[0],$=J[1];Object(n.useEffect)((function(){fetch("/contrib/jobs").then((function(e){if(e.ok)return e.json();throw new Error("Something went wrong")})).then((function(e){var t,a={},n=Object(ye.a)(e);try{for(n.s();!(t=n.n()).done;){for(var r=t.value,i={state:"disconnected",metadata:{name:r.name,subtext:r.subtext,display:r.display,description:r.description,key:r.job_name,source:r.source}},o=0;o<r.editable_settings.length;++o){var l=r.editable_settings[o];i[l.key]={value:l.default,label:l.label,type:l.type,unit:l.unit||null,display:l.display,description:l.description}}a[r.job_name]=i}}catch(c){n.e(c)}finally{n.f()}L((function(e){return Object(ve.a)(Object(ve.a)({},e),a)}))})).catch((function(e){}))}),[]),Object(n.useEffect)((function(){var e;t["cluster.topology"]&&((e=t.remote&&t.remote.ws_url?new f.Client("ws://".concat(t.remote.ws_url,"/"),"webui_SettingsActionsDialogAll"+Math.random()):new f.Client("".concat(t["cluster.topology"].leader_address),9001,"webui_SettingsActionsDialogAll"+Math.random())).connect({timeout:180,reconnect:!0}),h(e))}),[t]);function G(e,t){return function n(){var r=new f.Message(String(t));r.destinationName=["pioreactor",o,a,e.metadata.key,"$state","set"].join("/"),r.qos=1;try{g.publish(r)}catch(i){console.log(i),setTimeout((function(){n()}),750)}finally{k("".concat({sleeping:"Pausing",disconnected:"Stopping",ready:"Resuming"}[t]," ").concat(e.metadata.name.toLowerCase()," on all active Pioreactors")),_(!0)}}}function K(e){return function(t){"Enter"===t.key&&t.target.value&&(!function e(n,r){var i=new f.Message(String(r));i.destinationName=["pioreactor",o,a,n,"set"].join("/"),i.qos=1;try{g.publish(i),_(!0)}catch(t){console.log(t),g.connect({onSuccess:function(){return e(n,r)}})}}(t.target.id,t.target.value),k("Updating to ".concat(t.target.value," ").concat(e,".")),_(!0))}}var q=function(){u(!1),setTimeout((function(){return N(0)}),200)};function Q(e){if("temperature_control"===e.metadata.key)var t=function(){return I(!0)};else if("dosing_control"===e.metadata.key)t=function(){return U(!0)};else if("led_control"===e.metadata.key)t=function(){return $(!0)};else t=function(e){return function(){k("Starting ".concat(e.metadata.name.toLowerCase()," on all active Pioreactors")),_(!0),fetch("/run/"+e.metadata.key+"/"+o,{method:"POST"})}}(e);return r.a.createElement("div",{key:e.metadata.key},r.a.createElement(x.a,{className:i.jobButton,disableElevation:!0,color:"primary",onClick:t},"Start"),r.a.createElement(x.a,{className:i.jobButton,disableElevation:!0,color:"primary",onClick:G(e,"sleeping")},"Pause"),r.a.createElement(x.a,{className:i.jobButton,disableElevation:!0,color:"primary",onClick:G(e,"ready")},"Resume"),r.a.createElement(x.a,{className:i.jobButton,disableElevation:!0,color:"secondary",onClick:G(e,"disconnected")},"Stop"))}var X=Object.fromEntries(Object.entries(B).map((function(e,t){var a=Object(l.a)(e,2);return[a[0],Q(a[1])]}))),ee=Object(et.a)((function(e){return e.breakpoints.down("xl")})),te=B.dosing_control,ae=B.led_control,ne=B.temperature_control;return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{style:{textTransform:"none",float:"right"},onClick:function(){u(!0)},color:"primary"},r.a.createElement(ft.a,{fontSize:"15",classes:{root:i.textIcon}})," Manage all Pioreactors"),r.a.createElement(se.a,{maxWidth:ee?"sm":"md",fullWidth:!0,open:m,onClose:q,"aria-labelledby":"form-dialog-title"},r.a.createElement(ce.a,{style:{backgroundImage:"linear-gradient(to bottom left, rgba(83, 49, 202, 0.4), rgba(0,0,0,0))"}},r.a.createElement(F.a,{className:i.suptitle},r.a.createElement("b",null,"All active Pioreactors")),r.a.createElement(jt.a,{"aria-label":"close",onClick:q,sx:{position:"absolute",right:8,top:8,color:function(e){return e.palette.grey[600]}},size:"large"},r.a.createElement(ct.a,null)),r.a.createElement(it.a,{value:T,onChange:function(e,t){N(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:!0,allowScrollButtonsMobile:!0},r.a.createElement(ot.a,{label:"Activities"}),r.a.createElement(ot.a,{label:"Settings"}),r.a.createElement(ot.a,{label:"Dosing"}),r.a.createElement(ot.a,{label:"LEDs"}))),r.a.createElement(me.a,null,r.a.createElement(Wt,{value:T,index:0},Object.entries(B).filter((function(e){var t=Object(l.a)(e,2);t[0];return t[1].metadata.display})).filter((function(e){var t=Object(l.a)(e,2),a=t[0];t[1];return!["dosing_control","led_control","temperature_control"].includes(a)})).map((function(e){var t=Object(l.a)(e,2),a=t[0],n=t[1];return r.a.createElement("div",{key:a},r.a.createElement(F.a,{gutterBottom:!0},n.metadata.name),r.a.createElement(F.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:n.metadata.description}})),X[a],r.a.createElement(Z.a,{classes:{root:i.divider}}))})),ne&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{justifyContent:"space-between",display:"flex"}},r.a.createElement(F.a,{display:"block"},"Temperature automation")),r.a.createElement("div",null,r.a.createElement(F.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:ne.metadata.description}})),X.temperature_control),r.a.createElement(Bt,{open:z,onFinished:function(){return I(!1)},unit:o,config:t,experiment:a,isJobRunning:!1,automationType:"temperature",no_skip_first_run:!0})),r.a.createElement(Z.a,{className:i.divider}),te&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{justifyContent:"space-between",display:"flex"}},r.a.createElement(F.a,{display:"block"},"Dosing automation")),r.a.createElement("div",null,r.a.createElement(F.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:te.metadata.description}})),X.dosing_control),r.a.createElement(Bt,{automationType:"dosing",open:H,onFinished:function(){return U(!1)},unit:o,config:t,experiment:a,isJobRunning:!0,no_skip_first_run:!1})),r.a.createElement(Z.a,{className:i.divider}),ae&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{justifyContent:"space-between",display:"flex"}},r.a.createElement(F.a,{display:"block"},"LED automation")),r.a.createElement("div",null,r.a.createElement(F.a,{variant:"body2",component:"p",gutterBottom:!0},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:ae.metadata.description}})),X.led_control),r.a.createElement(Bt,{automationType:"led",open:V,onFinished:function(){return $(!1)},unit:o,config:t,experiment:a,isJobRunning:!0,no_skip_first_run:!1})),r.a.createElement(Z.a,{className:i.divider})),r.a.createElement(Wt,{value:T,index:1},Object.values(B).filter((function(e){return e.metadata.display})).map((function(e){return Object.entries(e).filter((function(e){var t=Object(l.a)(e,2),a=t[0];t[1];return"state"!==a&&"metadata"!==a})).filter((function(e){var t=Object(l.a)(e,2);t[0];return t[1].display})).map((function(t){var a=Object(l.a)(t,2),n=a[0],o=a[1];return r.a.createElement(r.a.Fragment,{key:n},r.a.createElement(F.a,{gutterBottom:!0},o.label),r.a.createElement(F.a,{variant:"body2",component:"p"},o.description),r.a.createElement(at.a,{size:"small",autoComplete:"off",id:"".concat(e.metadata.key.replace("_control","_automation"),"/").concat(n),key:n,defaultValue:o.value,InputProps:{endAdornment:r.a.createElement(rt.a,{position:"end"},o.unit)},variant:"outlined",onKeyPress:K(o.unit),className:i.textFieldCompact}),r.a.createElement(Z.a,{classes:{root:i.divider}}))}))}))),r.a.createElement(Wt,{value:T,index:2},r.a.createElement(F.a,{gutterBottom:!0},"Add media"),r.a.createElement(F.a,{variant:"body2",component:"p"},"Run the media pumps for a set duration (seconds), or a set volume (mL)."),r.a.createElement(Mt,{action:"add_media",unit:o}),r.a.createElement(Z.a,{className:i.divider}),r.a.createElement(F.a,{gutterBottom:!0},"Remove waste"),r.a.createElement(F.a,{variant:"body2",component:"p"},"Run the waste pumps for a set duration (seconds), or a set volume (mL)."),r.a.createElement(Mt,{action:"remove_waste",unit:o}),r.a.createElement(Z.a,{className:i.divider}),r.a.createElement(F.a,{gutterBottom:!0},"Add alternative media"),r.a.createElement(F.a,{variant:"body2",component:"p"},"Run the alternative media pumps for a set duration (seconds), or a set volume (mL)."),r.a.createElement(Mt,{action:"add_alt_media",unit:o}),r.a.createElement(Z.a,{className:i.divider})),r.a.createElement(Wt,{value:T,index:3},r.a.createElement(F.a,{style:{textTransform:"capitalize"}},"Channel A"),r.a.createElement(zt,{channel:"A",unit:o}),r.a.createElement(Z.a,{className:i.divider}),r.a.createElement(F.a,{style:{textTransform:"capitalize"}},"Channel B"),r.a.createElement(zt,{channel:"B",unit:o}),r.a.createElement(Z.a,{className:i.divider}),r.a.createElement(F.a,{style:{textTransform:"capitalize"}},"Channel C"),r.a.createElement(zt,{channel:"C",unit:o}),r.a.createElement(Z.a,{className:i.divider}),r.a.createElement(F.a,{style:{textTransform:"capitalize"}},"Channel D"),r.a.createElement(zt,{channel:"D",unit:o}),r.a.createElement(Z.a,{className:i.divider})))),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:y,onClose:function(){_(!1)},message:S,autoHideDuration:7e3,resumeHideDuration:2e3,key:"snackbar"+o+"settings"}))}function Qt(e){var t=r.a.useState({}),a=Object(l.a)(t,2),n=a[0],i=a[1];r.a.useEffect((function(){fetch("/get_current_unit_labels").then((function(e){return e.json()})).then((function(e){i(e)}))}),[]);var o=e.units.map((function(t){return r.a.createElement(ea,{isUnitActive:!0,key:t,unit:t,config:e.config,experiment:e.experiment,label:n[t]})})),c=r.a.createElement("div",{style:{textAlign:"center",marginBottom:"50px",marginTop:"50px"}},r.a.createElement(F.a,null,r.a.createElement(z.a,{fontWeight:"fontWeightRegular"},"No active Pioreactors. Do you need to update `cluster.inventory` section in the ",r.a.createElement("a",{href:"/config"},"configuration"),"?"),r.a.createElement(z.a,{fontWeight:"fontWeightRegular"},"Or, ",r.a.createElement("a",{href:"https://docs.pioreactor.com/user-guide/create-cluster"},"read our documentation")," about managing inventory.")));return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"10px",marginTop:"15px"}},r.a.createElement(F.a,{variant:"h5",component:"h2"},r.a.createElement(z.a,{fontWeight:"fontWeightRegular"},"Active Pioreactors")),r.a.createElement("div",null)),0===e.units.length&&e.experiment?c:o)}function Xt(e){var t=Rt(),a=Object(n.useState)(!1),i=Object(l.a)(a,2),o=i[0],c=i[1];return r.a.createElement(x.a,{style:{textTransform:"none",float:"right"},className:Object(D.a)({blinkled:o}),disabled:e.disabled,onClick:function(){c(!0);!function t(){var a=new f.Message("1");a.destinationName=["pioreactor",e.unit,"$experiment","monitor","flicker_led_response_okay"].join("/"),a.qos=0;try{e.client.publish(a)}catch(n){console.log(n),setTimeout((function(){t()}),1e3)}}(),setTimeout((function(){c(!1)}),3600)},color:"primary"},r.a.createElement(dt.a,{color:e.disabled?"disabled":"primary",fontSize:"15",classes:{root:t.textIcon}})," ",r.a.createElement("span",null," Identify "))}function ea(e){var t=Rt(),a=e.unit,i=e.isUnitActive,o=e.experiment,c=e.config,s=Object(n.useState)(!1),m=Object(l.a)(s,2),u=m[0],d=m[1],p=Object(n.useState)(""),g=Object(l.a)(p,2),h=g[0],E=g[1],b=Object(n.useState)(null),v=Object(l.a)(b,2),y=v[0],x=v[1],O=Object(n.useState)({monitor:{state:"disconnected",metadata:{display:!1}}}),j=Object(l.a)(O,2),S=j[0],k=j[1];Object(n.useEffect)((function(){E(e.label)}),[e.label]),Object(n.useEffect)((function(){fetch("/contrib/jobs").then((function(e){if(e.ok)return e.json();throw new Error("Something went wrong")})).then((function(e){var t,a={},n=Object(ye.a)(e);try{for(n.s();!(t=n.n()).done;){for(var r=t.value,i={state:"disconnected",metadata:{name:r.name,subtext:r.subtext,display:r.display,description:r.description,key:r.job_name,source:r.source,is_testing:r.is_testing}},o=0;o<r.editable_settings.length;++o){var l=r.editable_settings[o];i[l.key]={value:l.default,label:l.label,type:l.type,unit:l.unit||null,display:l.display,description:l.description}}a[r.job_name]=i}}catch(c){n.e(c)}finally{n.f()}k((function(e){return Object(ve.a)(Object(ve.a)({},e),a)})),d(!0)})).catch((function(e){}))}),[]),Object(n.useEffect)((function(){var t;e.config["cluster.topology"]&&(i&&o&&((t=e.config.remote&&e.config.remote.ws_url?new f.Client("ws://".concat(e.config.remote.ws_url,"/"),"webui"+Math.random()):new f.Client("".concat(e.config["cluster.topology"].leader_address),9001,"webui"+Math.random())).onMessageArrived=function(e){var t=parseFloat(e.payloadString),a=isNaN(t)?e.payloadString:t,n=e.topic.split("/").slice(-2),r=Object(l.a)(n,2),i=r[0],o=r[1];"$state"===o?k((function(e){return Object(ve.a)(Object(ve.a)({},e),{},Object(_.a)({},i,Object(ve.a)(Object(ve.a)({},e[i]),{},{state:a})))})):i.endsWith("_automation")?(i=i.replace("_automation","_control"),k((function(e){return Object(ve.a)(Object(ve.a)({},e),{},Object(_.a)({},i,Object(ve.a)(Object(ve.a)({},e[i]),{},Object(_.a)({},o,Object(ve.a)(Object(ve.a)({},e[i][o]),{},{value:a})))))}))):k((function(e){return Object(ve.a)(Object(ve.a)({},e),{},Object(_.a)({},i,Object(ve.a)(Object(ve.a)({},e[i]),{},Object(_.a)({},o,Object(ve.a)(Object(ve.a)({},e[i][o]),{},{value:a})))))}))},t.connect({onSuccess:function(){t.subscribe(["pioreactor",a,"$experiment","monitor","$state"].join("/"));for(var e=0,n=Object.keys(S);e<n.length;e++){var r=n[e];if("monitor"!==r){var i=S[r].metadata.is_testing?"_testing_"+o:o;t.subscribe(["pioreactor",a,i,r,"$state"].join("/"));for(var l=0,c=Object.keys(S[r]);l<c.length;l++){var s=c[l];if("state"!==s&&"metadata"!==s){var m=["pioreactor",a,i,"automation_name"===s?r:r.replace("_control","_automation"),s].join("/");t.subscribe(m)}}}}},reconnect:!0}),x(t)))}),[c,o,u,i]);var w,C="disconnected"===(w=S.monitor.state)?"grey":"lost"===w?"#DE3618":"#4caf50",T=function(e,t){return"disconnected"===e&&t?"Offline, need to power up":"disconnected"!==e||t?"lost"===e?"Lost, something went wrong. Try manually power-cycling the unit.":"Online and ready":"Offline, change inventory status in config.ini"}(S.monitor.state,i);return r.a.createElement(P.a,{className:t.pioreactorCard,id:a},r.a.createElement(P.a,{className:t.cardContent},r.a.createElement("div",{className:"fixme"},r.a.createElement(F.a,{className:Object(D.a)(t.suptitle),color:"textSecondary"},h?a:""),r.a.createElement("div",{className:t.cardHeaderSettings},r.a.createElement("div",{style:{display:"flex",justifyContent:"left"}},r.a.createElement(F.a,{className:Object(D.a)(t.unitTitle,Object(_.a)({},t.disabledText,!i)),gutterBottom:!0},r.a.createElement(Me,{color:i?"inherit":"disabled",style:{verticalAlign:"middle"},sx:{display:{xs:"none",sm:"none",md:"inline"}}}),h||a),r.a.createElement(nt.a,{title:T,placement:"right"},r.a.createElement("div",null,r.a.createElement("div",{"aria-label":T,className:"indicator-dot",style:{boxShadow:"0 0 ".concat(0,"px ").concat(C,", inset 0 0 12px  ").concat(C)}})))),r.a.createElement("div",{className:t.cardHeaderButtons},r.a.createElement("div",null,r.a.createElement(Kt,{client:y,disabled:!i,unit:a,label:h,selfTestState:S.self_test?S.self_test.state:null,selfTestTests:S.self_test?S.self_test:null})),r.a.createElement("div",null,r.a.createElement(Xt,{client:y,disabled:!i,config:e.config,unit:a})),r.a.createElement("div",null,r.a.createElement(Gt,{client:y,odBlankReading:S.od_blank?S.od_blank.means.value:null,odBlankJobState:S.od_blank?S.od_blank.state:null,stirringCalibrationState:S.stirring_calibration?S.stirring_calibration.state:null,experiment:o,unit:a,label:h,disabled:!i})),r.a.createElement(qt,{config:e.config,client:y,unit:a,label:h,disabled:!i,experiment:o,jobs:S,setLabel:E})))),r.a.createElement("div",{style:{display:"flex",margin:"15px 20px 20px 0px",flexDirection:"row"}},r.a.createElement("div",{className:t.textboxLabel},r.a.createElement(F.a,{variant:"body2"},r.a.createElement(z.a,{fontWeight:"fontWeightBold",className:Object(D.a)(Object(_.a)({},t.disabledText,!i))},"Activities:"))),r.a.createElement("div",{className:t.rowOfUnitSettingDisplay},Object.values(S).filter((function(e){return e.metadata.display})).map((function(e){return r.a.createElement("div",{className:t.textbox,key:e.metadata.key},r.a.createElement(F.a,{variant:"body2",style:{fontSize:"0.84rem"},className:Object(D.a)(Object(_.a)({},t.disabledText,!i))},e.metadata.name),r.a.createElement(Ut,{value:e.state,isUnitActive:i,default:"disconnected",subtext:e.metadata.subtext?e[e.metadata.subtext].value:null,isStateSetting:!0}))})))),r.a.createElement(Z.a,null),r.a.createElement("div",{style:{display:"flex",margin:"15px 20px 20px 0px",flexDirection:"row"}},r.a.createElement("div",{className:t.textboxLabel},r.a.createElement(F.a,{variant:"body2"},r.a.createElement(z.a,{fontWeight:"fontWeightBold",className:Object(D.a)(Object(_.a)({},t.disabledText,!i))},"Settings:"))),r.a.createElement("div",{className:t.rowOfUnitSettingDisplay},Object.values(S).map((function(a){return Object.entries(a).filter((function(e){var t=Object(l.a)(e,2),a=t[0];t[1];return"state"!==a&&"metadata"!==a})).filter((function(e){var t=Object(l.a)(e,2);t[0];return t[1].display})).map((function(n){var o=Object(l.a)(n,2),c=o[0],s=o[1];return r.a.createElement("div",{className:t.textbox,key:a.metadata.key+c},r.a.createElement(F.a,{variant:"body2",style:{fontSize:"0.84rem"},className:Object(D.a)(Object(_.a)({},t.disabledText,!i))},s.label),r.a.createElement(Ut,{value:s.value,isUnitActive:i,measurementUnit:s.unit,precision:2,default:"\u2014",isLEDIntensity:"LED intensity"===s.label,config:e.config}))}))}))))))}function ta(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"10px",marginTop:"15px"}},r.a.createElement(F.a,{variant:"h5",component:"h2"},r.a.createElement(z.a,{fontWeight:"fontWeightRegular"},"Inactive Pioreactors"))),e.units.map((function(t){return r.a.createElement(ea,{isUnitActive:!1,key:t,unit:t,config:e.config,experiment:e.experiment})})))}var aa=function(e){var t=e.title,a=e.config,n=r.a.useState({}),i=Object(l.a)(n,2),o=i[0],c=i[1];r.a.useEffect((function(){document.title=t,fetch("/get_latest_experiment").then((function(e){return e.json()})).then((function(e){c(e)}))}),[t]);var s=function(e){return Object.entries(e)},m=a["cluster.inventory"]?s(a["cluster.inventory"]).filter((function(e){return"1"===e[1]})).map((function(e){return e[0]})):[],u=a["cluster.inventory"]?s(a["cluster.inventory"]).filter((function(e){return"0"===e[1]})).map((function(e){return e[0]})):[];return r.a.createElement(y.a,{container:!0,spacing:2},r.a.createElement(y.a,{item:!0,md:12,xs:12},r.a.createElement(Vt,{config:a,experiment:o.experiment}),r.a.createElement(Qt,{experiment:o.experiment,config:a,units:m}),u.length>0&&r.a.createElement(ta,{experiment:o.experiment,config:a,units:u})))};var na=function(e){var t=e.title,a=(e.config,r.a.useState({})),n=Object(l.a)(a,2),i=(n[0],n[1]),o=Object(s.f)().unit;return r.a.useEffect((function(){document.title=t,fetch("/get_latest_experiment").then((function(e){return e.json()})).then((function(e){i(e)}))}),[t]),r.a.createElement(y.a,{container:!0,spacing:2},r.a.createElement(y.a,{item:!0,md:12,xs:12},r.a.createElement("h2",null,o)))},ra=a(689),ia=a(718),oa=a(684),la=a(669),ca=a(686),sa=Object(G.a)((function(e){return{root:{marginTop:"15px"},cardContent:{padding:"10px"},button:{marginRight:e.spacing(1)},textField:{marginTop:e.spacing(1),marginBottom:e.spacing(1),width:"100%"}}}));function ma(e){var t=sa(),a=Object(n.useState)(!1),i=Object(l.a)(a,2),o=i[0],c=i[1];return r.a.createElement(x.a,{style:{textTransform:"none",float:"right"},className:Object(D.a)({blinkled:o}),disabled:e.disabled,onClick:function(){c(!0);!function t(){var a=new f.Message("1");a.destinationName=["pioreactor",e.unit,"$experiment","monitor","flicker_led_response_okay"].join("/"),a.qos=0;try{e.client.publish(a)}catch(n){console.log(n),setTimeout((function(){t()}),1e3)}}(),setTimeout((function(){c(!1)}),3600)},color:"primary"},r.a.createElement(dt.a,{color:e.disabled?"disabled":"primary",fontSize:"15",classes:{root:t.textIcon}})," ",r.a.createElement("span",null," Identify "))}var ua=function(e){var t=sa(),a=Object(n.useState)({}),i=Object(l.a)(a,2),o=i[0],c=i[1],s=Object(n.useState)(null),m=Object(l.a)(s,2),u=m[0],d=m[1],p=e.config["cluster.inventory"]?Object.entries(e.config["cluster.inventory"]).filter((function(e){return"1"===e[1]})).map((function(e){return e[0]})):[];Object(n.useEffect)((function(){var t;(t=e.config.remote&&e.config.remote.ws_url?new f.Client("ws://".concat(e.config.remote.ws_url,"/"),"webui_publishExpNameToMQTT"+Math.random()):new f.Client("".concat(e.config["cluster.topology"].leader_address),9001,"webui_publishExpNameToMQTT"+Math.random())).connect(),d(t)}),[e.config]);var g=function(e){return function(t){return c(Object(ve.a)(Object(ve.a)({},o),{},Object(_.a)({},e,t.target.value)))}};return r.a.createElement("div",{className:t.root},r.a.createElement(y.a,{container:!0,spacing:1},r.a.createElement(y.a,{item:!0,xs:1}),r.a.createElement(y.a,{item:!0,xs:10},r.a.createElement("p",null," Assign labels to Pioreactors in your cluster. These labels are temporary, and will show up in charts, tables, and elsewhere in the interface. Labels can be changed later."),r.a.createElement(Z.a,{style:{marginBottom:"20px"}})),r.a.createElement(y.a,{item:!0,xs:1}),p.map((function(t){return r.a.createElement(r.a.Fragment,{key:t},r.a.createElement(y.a,{item:!0,xs:2}),r.a.createElement(y.a,{item:!0,xs:7},r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement("div",null,r.a.createElement(Me,{style:{verticalAlign:"middle",fontSize:"1.0em"}}),r.a.createElement("span",{style:{lineHeight:"40px"}},t)),r.a.createElement("div",null,r.a.createElement(at.a,{size:"small",placeholder:"(Optional)",onChange:g(t),style:{width:"140px"}}),r.a.createElement(ma,{client:u,disable:!1,config:e.config,unit:t})))),r.a.createElement(y.a,{item:!0,xs:3}))})),r.a.createElement(y.a,{item:!0,xs:12,md:4}),r.a.createElement(y.a,{item:!0,xs:12,md:8},r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},r.a.createElement(x.a,{variant:"contained",color:"primary",onClick:function(){Object.entries(o).map((function(e){return fetch("/update_current_unit_labels",{method:"POST",body:JSON.stringify({label:e[1],unit:e[0]}),headers:{Accept:"application/json","Content-Type":"application/json"}})})),e.handleNext()}}," Assign ")))))},da=a(144),pa=a.n(da);function fa(e){var t=r.a.useState(!1),a=Object(l.a)(t,2),n=a[0],i=a[1],o=r.a.useState(!1),c=Object(l.a)(o,2),s=c[0],m=c[1];return r.a.createElement("div",null,r.a.createElement("p",null," For consistent temperatures of the culture, we recommend using the onboard heating. Click below and set the temperature of the cultures (you can change this temperature later)."),r.a.createElement(x.a,{variant:"contained",onClick:function(){m(!0),i(!0)},endIcon:n?r.a.createElement(bt.a,null):r.a.createElement(pa.a,null)},"Start heating"),r.a.createElement(Bt,{open:s,onFinished:function(){return m(!1)},unit:"$broadcast",config:e.config,experiment:"+",isJobRunning:!1,automationType:"temperature",no_skip_first_run:!0}))}function ga(e){var t=r.a.useState(!1),a=Object(l.a)(t,2),n=a[0],i=a[1],o=r.a.useState(!1),c=Object(l.a)(o,2),s=c[0],m=c[1];return r.a.createElement("div",null,r.a.createElement("p",null," To get an accurate reading, we need to start start the stirring. This also provides gas transfer and keeps the cells in suspension."),r.a.createElement(x.a,{variant:"contained",color:"primary",endIcon:n?r.a.createElement(bt.a,null):r.a.createElement(pa.a,null),onClick:function(e){i(!0),fetch("/run/stirring/$broadcast",{method:"POST"}).then((function(e){200===e.status&&m(!0)}))}},"Start stirring"),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:s,onClose:function(){m(!1)},message:"Stirring starting",autoHideDuration:7e3,key:"snackbarStirring"}))}function ha(e){var t=r.a.useState(!1),a=Object(l.a)(t,2),n=a[0],i=a[1],o=r.a.useState(!1),c=Object(l.a)(o,2),s=c[0],m=c[1];return r.a.createElement("div",null,r.a.createElement("p",null," Next, we will turn on the optical density reading. We also call this ",r.a.createElement("em",null,"OD readings"),". This will provide us with a measure of cell density. In a moment, you should see the data in the chart below. "),r.a.createElement(x.a,{variant:"contained",color:"primary",endIcon:n?r.a.createElement(bt.a,null):r.a.createElement(pa.a,null),onClick:function(e){i(!0),fetch("/run/od_reading/$broadcast",{method:"POST"}).then((function(e){200===e.status&&m(!0)}))}},"Start OD readings"),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:s,onClose:function(){m(!1)},message:"OD reading starting",autoHideDuration:7e3,key:"snackbarOD"}))}var Ea=function(e){return r.a.createElement(y.a,{container:!0,direction:"column",justifyContent:"flex-start",alignItems:"center",spacing:2},r.a.createElement(y.a,{item:!0,xs:2}),r.a.createElement(y.a,{container:!0},r.a.createElement(y.a,{item:!0,xs:10},r.a.createElement("p",null,"Place the vials in the Pioreactor(s).")),r.a.createElement(y.a,{item:!0,xs:10},r.a.createElement(fa,{config:e.config})),r.a.createElement(y.a,{item:!0,xs:10},r.a.createElement(ga,null)),r.a.createElement(y.a,{item:!0,xs:10},r.a.createElement(ha,null)),r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(Le,{config:e.config,isODReading:!0,dataSource:"od_readings_raw",title:"Optical density",interpolation:"stepAfter",topic:"od_reading/od_raw/+",yAxisLabel:"Voltage",payloadKey:"voltage",experiment:null,deltaHours:1,lookback:1,fixedDecimals:3}))),r.a.createElement(y.a,{item:!0,xs:2}))};function ba(e){var t=r.a.useState(!1),a=Object(l.a)(t,2),n=a[0],i=a[1],o=r.a.useState(""),c=Object(l.a)(o,2),s=c[0],m=c[1],u=r.a.useState(!1),d=Object(l.a)(u,2),p=d[0],f=d[1];return r.a.createElement("div",null,r.a.createElement("p",null,"Because of the varying strength & quality of the electronics, not all readings look the same - even for the same density of cells. So we compute a baseline measurement from the OD readings, and measure all growth against that baseline. "),r.a.createElement("p",null,"From the (normalized) OD readings, we can calculate the ",r.a.createElement("em",null,"implied hourly growth rate"),", which is our measure of growth. "),r.a.createElement("p",null,"Let's start the growth rate calculations. This first computes the normalization constants, ",r.a.createElement("b",null,"which can take up to two minutes to complete"),". After that, the graph below should start to populate."),r.a.createElement(x.a,{variant:"contained",color:"primary",endIcon:p?r.a.createElement(bt.a,null):r.a.createElement(pa.a,null),onClick:function(e){fetch("/run/growth_rate_calculating/$broadcast",{method:"POST"}).then((function(e){m("Growth rate calculating starting"),i(!0),f(!0)}))}},"Start growth rate calculations"),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:n,onClose:function(){i(!1)},message:s,autoHideDuration:7e3,key:"snackbarGR"}))}var va=function(e){var t=r.a.useState("null_exp"),a=Object(l.a)(t,2),n=a[0],i=a[1];return r.a.useEffect((function(){function e(){return(e=Object(S.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/get_latest_experiment").then((function(e){return e.json()})).then((function(e){i(e.experiment)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),r.a.createElement(y.a,{container:!0,direction:"column",justifyContent:"flex-start",alignItems:"center",spacing:2},r.a.createElement(y.a,{item:!0,xs:2}),r.a.createElement(y.a,{item:!0,xs:10},r.a.createElement(ba,{experiment:n})),r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(Le,{config:e.config,experiment:n,dataSource:"growth_rates",interpolation:"stepAfter",title:"Implied growth rate",topic:"growth_rate_calculating/growth_rate",payloadKey:"growth_rate",yAxisLabel:"Growth rate, h\u207b\xb9",yAxisDomain:[-.02,.1],lookback:1e5,deltaHour:1,fixedDecimals:2})),r.a.createElement(y.a,{item:!0,xs:2}))},ya=Object(G.a)((function(e){return{root:{marginTop:"15px"},cardContent:{padding:"10px"},button:{marginRight:e.spacing(1)},instructions:{marginTop:e.spacing(2),marginBottom:e.spacing(4),marginLeft:"auto",marginRight:"auto",width:"60%"},textField:{marginTop:e.spacing(1),marginBottom:e.spacing(1),width:"100%"},formControl:{margin:e.spacing(3)}}})),xa=Object(la.a)();function _a(e){var t=ya(),a=r.a.useState({key:e.value}),n=Object(l.a)(a,2),i=n[0],o=n[1],c=e.options,s=e.updateParentCallback;return r.a.useEffect((function(){o({key:e.value})}),[e.value]),r.a.createElement(ca.a,{value:i,className:t.textField,onChange:function(e,t){"string"===typeof t?(o({key:t}),s(t)):t&&t.inputValue?(o({key:t.inputValue}),s(t.inputValue)):(o(t),s(null===t||void 0===t?void 0:t.key))},filterOptions:function(e,t){var a=xa(e,t),n=t.inputValue,r=e.some((function(e){return n===e.key}));return""===n||r||a.push({inputValue:n,key:'Add "'.concat(n,'"')}),a},selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,id:"free-solo-with-text-addition",options:c,getOptionLabel:function(e){return"string"===typeof e?e:e.inputValue?e.inputValue:e.key?e.key:""},renderOption:function(e,t){return r.a.createElement("li",e,t.key)},sx:{width:300},freeSolo:!0,renderInput:function(t){return r.a.createElement(at.a,Object.assign({},t,{label:e.label}))}})}function Oa(e){var t=ya(),a=r.a.useState(!1),n=Object(l.a)(a,2),i=n[0],o=n[1],c=r.a.useState(""),s=Object(l.a)(c,2),m=s[0],u=s[1],d=r.a.useState(""),p=Object(l.a)(d,2),f=p[0],g=p[1],h=r.a.useState(B.a.utc()),E=Object(l.a)(h,2),b=E[0],v=E[1],_=r.a.useState(""),O=Object(l.a)(_,2),j=O[0],S=O[1],k=r.a.useState(""),w=Object(l.a)(k,2),C=w[0],T=w[1],N=r.a.useState(""),D=Object(l.a)(N,2),A=D[0],L=D[1],P=r.a.useState([]),M=Object(l.a)(P,2),F=M[0],z=M[1],I=r.a.useState([]),R=Object(l.a)(I,2),W=R[0],H=R[1];r.a.useEffect((function(){fetch("/get_historical_media_used").then((function(e){if(e.ok)return e.json()})).then((function(e){return z(e)})),fetch("/get_historical_organisms_used").then((function(e){if(e.ok)return e.json()})).then((function(e){return H(e)}))}),[]);return r.a.createElement("div",{className:t.root},r.a.createElement(Ue.a,null,r.a.createElement(y.a,{container:!0,spacing:1},r.a.createElement(y.a,{item:!0,xs:12,md:6},r.a.createElement(at.a,{error:i,id:"expName",label:"Experiment name",value:f,required:!0,className:t.textField,onChange:function(e){g(e.target.value)},helperText:m})),r.a.createElement(y.a,{item:!0,xs:12,md:6},r.a.createElement(at.a,{id:"datetime",label:"Start time",type:"datetime-local",defaultValue:b.local().format("YYYY-MM-DDTHH:mm:ss"),className:t.textField,onChange:function(e){v(e.target.value)},InputLabelProps:{shrink:!0}})),r.a.createElement(y.a,{item:!0,xs:12,md:12},r.a.createElement(at.a,{label:"Description (optional)",maxRows:4,placeholder:"Add a description: what is your hypothesis? What is the experiment protocol? This description can always be changed later.",multiline:!0,value:j,className:t.textField,onChange:function(e){S(e.target.value)},fullWidth:!0})),r.a.createElement(y.a,{item:!0,xs:12,md:6},r.a.createElement(_a,{options:W,label:"Organism / strain (optional)",updateParentCallback:T,value:C})),r.a.createElement(y.a,{item:!0,xs:12,md:6},r.a.createElement(_a,{options:F,label:"Media (optional)",updateParentCallback:L,value:A})),r.a.createElement(y.a,{item:!0,xs:12,md:4}),r.a.createElement(y.a,{item:!0,xs:12,md:8},r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},r.a.createElement(x.a,{style:{marginRight:"10px"},size:"small",color:"primary",onClick:function(){fetch("/get_latest_experiment").then((function(e){return e.json()})).then((function(e){g(e.experiment),S(e.description),T(e.organism_used),L(e.media_used)}))}},"Populate with previous experiment"),r.a.createElement(x.a,{variant:"contained",color:"primary",onClick:function(t){return t.preventDefault(),""===f?(o(!0),void u("Can't be blank.")):f.includes("#")||f.includes("+")||f.includes("/")?(o(!0),void u("Can't use #, / or + characters in experiment name.")):void fetch("create_experiment",{method:"POST",body:JSON.stringify({experiment:f.trim(),created_at:b.toISOString(),description:j,mediaUsed:A,organismUsed:C}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(t){200===t.status?(u(""),o(!1),fetch("/stop_all",{method:"POST"}),e.handleNext()):(o(!0),u("Experiment name already used."))}))}}," Create "))))))}function ja(e){var t=ya(),a=r.a.useState(0),n=Object(l.a)(a,2),i=n[0],o=n[1],c=r.a.useState(new Set),s=Object(l.a)(c,2),m=s[0],u=s[1],d=function(e){return g[e].optional},p=function(e){return m.has(e)},f=function(){if(i===g.length-1)window.location.href="/overview";else{var e=m;p(i)&&(e=new Set(e.values())).delete(i),o((function(e){return e+1})),u(e),window.scrollTo({top:0})}},g=[{title:"Experiment summary",content:r.a.createElement(Oa,{config:e.config,handleNext:f}),optional:!1},{title:"Assign labels",content:r.a.createElement(ua,{config:e.config,handleNext:f}),optional:!0},{title:"Start sensors",content:r.a.createElement(Ea,{config:e.config}),optional:!1},{title:"Start calculations",content:r.a.createElement(va,{config:e.config}),optional:!1}];return r.a.createElement(P.a,{className:t.root},r.a.createElement(P.a,{className:t.cardContent},r.a.createElement(F.a,{variant:"h5",component:"h1"},"Start a new experiment"),r.a.createElement(ra.a,{activeStep:i},g.map((function(e,t){var a={},n={};return e.optional&&(n.optional=r.a.createElement(F.a,{variant:"caption"},"Optional")),p(t)&&(a.completed=!1),r.a.createElement(ia.a,Object.assign({key:e.title},a),r.a.createElement(oa.a,n,e.title))}))),r.a.createElement("div",null,i===g.length?r.a.createElement("div",null,r.a.createElement(F.a,{className:t.instructions},"All steps completed - you're finished"),r.a.createElement(x.a,{onClick:function(){o(0)},className:t.button},"Reset")):r.a.createElement("div",null,r.a.createElement("div",{className:t.instructions},g[i].content),r.a.createElement("div",null,r.a.createElement(x.a,{disabled:0===i,onClick:function(){o((function(e){return e-1}))},className:t.button},"Back"),d(i)&&r.a.createElement(x.a,{variant:"contained",onClick:function(){if(!d(i))throw new Error("You can't skip a step that isn't optional.");o((function(e){return e+1})),u((function(e){var t=new Set(e.values());return t.add(i),t}))},className:t.button},"Skip"),r.a.createElement(x.a,{variant:"contained",onClick:f,className:t.button},i===g.length-1?"Go to overview":"Next"))))))}var Sa=function(e){return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(y.a,{container:!0,spacing:2},r.a.createElement(y.a,{item:!0,xs:12,md:12},r.a.createElement(ja,{config:e.config})))},ka=a(375),wa=Object(G.a)((function(e){return{root:{marginTop:"15px"},title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0}}})),Ca=function(e){Object(T.a)(a,e);var t=Object(N.a)(a);function a(e){var n;return Object(k.a)(this,a),(n=t.call(this,e)).onSelectionChange=function(e){n.setState({filename:e.target.value}),n.getConfig(e.target.value)},n.getCodeFlaskRef=function(e){n.codeFlask=e},n.onTextChange=function(e){n.setState({code:e,hasChangedSinceSave:!0,buttonText:"Save"})},n.handleSnackbarClose=function(){n.setState({openSnackbar:!1})},n.state={code:"",openSnackbar:!1,filename:"config.ini",snackbarMsg:"",buttonText:"Save",hasChangedSinceSave:!0,availableConfigs:[{name:"shared config.ini",filename:"config.ini"}]},n.saveCurrentCode=n.saveCurrentCode.bind(Object(C.a)(n)),n.deleteConfig=n.deleteConfig.bind(Object(C.a)(n)),n}return Object(w.a)(a,[{key:"getConfig",value:function(e){var t=this;fetch("/get_config/"+e).then((function(e){return e.text()})).then((function(e){t.setState({code:e})}))}},{key:"getListOfConfigFiles",value:function(e){var t=this;fetch("/get_configs").then((function(e){return e.json()})).then((function(e){t.setState((function(t){return{availableConfigs:[].concat(Object(be.a)(t.availableConfigs),Object(be.a)(e.filter((function(e){return"config.ini"!==e})).map((function(e){return{name:e,filename:e}}))))}}))}))}},{key:"saveCurrentCode",value:function(){var e=this;this.setState({buttonText:r.a.createElement(tt.a,{color:"inherit",size:24})}),fetch("/save_new_config",{method:"POST",body:JSON.stringify({code:this.state.code,filename:this.state.filename}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(t){t.ok?e.setState({snackbarMsg:e.state.filename+" saved and synced.",hasChangedSinceSave:!1,buttonText:"Saved"}):e.setState({snackbarMsg:"Hm. Something when wrong saving or syncing...",hasChangedSinceSave:!0,buttonText:"Save"}),e.setState({openSnackbar:!0})}))}},{key:"deleteConfig",value:function(){var e=this;fetch("/delete_config",{method:"POST",body:JSON.stringify({filename:this.state.filename}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(t){t.ok?e.setState({snackbarMsg:e.state.filename+" deleted."}):e.setState({snackbarMsg:"Hm. Something when wrong deleting..."}),e.setState({openSnackbar:!0}),setTimeout((function(){window.location.reload()}),750)}))}},{key:"componentDidMount",value:function(){this.getConfig(this.state.filename),this.getListOfConfigFiles()}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{maxWidth:"200px",margin:"10px"}},r.a.createElement(He.a,{fullWidth:!0},r.a.createElement(q.a,{id:"configSelect",variant:"standard"},"Config file"),r.a.createElement(Ve.a,{native:!0,labelId:"configSelect",variant:"standard",value:this.state.filename,onChange:this.onSelectionChange,inputProps:{name:"config",id:"config"}},this.state.availableConfigs.map((function(e){return r.a.createElement("option",{key:e.filename,value:e.filename},e.name)}))))),r.a.createElement("div",{style:{letterSpacing:"0em",margin:"10px auto 10px auto",position:"relative",width:"98%",height:"280px",border:"1px solid #ccc"}},r.a.createElement(ka.CodeFlaskReact,{code:this.state.code,onChange:this.onTextChange,editorRef:this.getCodeFlaskRef,language:"python"})),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement(x.a,{style:{margin:"5px 12px 5px 12px"},color:"primary",variant:"contained",onClick:this.saveCurrentCode,disabled:!this.state.hasChangedSinceSave},this.state.buttonText),r.a.createElement(x.a,{style:{margin:"5px 10px 5px 10px"},color:"secondary",onClick:this.deleteConfig,disabled:"config.ini"===this.state.filename},"Delete config file")),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:this.state.openSnackbar,onClose:this.handleSnackbarClose,message:this.state.snackbarMsg,autoHideDuration:2e3,key:"edit-config-snackbar"}))}}]),a}(r.a.Component);function Ta(){var e=wa();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(F.a,{variant:"h5",component:"h2"},r.a.createElement(z.a,{fontWeight:"fontWeightBold"},"Configuration")))),r.a.createElement(P.a,{className:e.root},r.a.createElement(P.a,{className:e.cardContent},r.a.createElement(Ca,null),r.a.createElement("p",{style:{textAlign:"center",marginTop:"30px"}},r.a.createElement("span",{role:"img","aria-labelledby":"Note"},"\ud83d\udca1")," Learn more about Pioreactor  ",r.a.createElement("a",{href:"https://docs.pioreactor.com/user-guide/configuration",target:"_blank",rel:"noopener noreferrer"},"configuration"),"."))))}var Na=function(e){return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(y.a,{container:!0,spacing:2},r.a.createElement(y.a,{item:!0,md:12,xs:12},r.a.createElement(Ta,null)))},Da=a(376),Aa=a(719),Ba=a(169),La=a.n(Ba),Pa=a(378),Ma=a.n(Pa),Fa=a(127),za=a.n(Fa),Ia=Object(G.a)((function(e){return{title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0},textIcon:{fontSize:15,verticalAlign:"middle",margin:"0px 3px"}}}));function Ra(){var e=Ia(),t=r.a.useState(!1),a=Object(l.a)(t,2),n=a[0],i=a[1],o=r.a.useState(!1),c=Object(l.a)(o,2),s=c[0],m=c[1],u=function(){i(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{onClick:function(){i(!0)},style:{textTransform:"none",float:"right",marginRight:"0px"},color:"primary"},r.a.createElement(La.a,{fontSize:"15",classes:{root:e.textIcon}})," Update to latest release"),r.a.createElement(se.a,{open:n,onClose:u,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(ce.a,{id:"alert-dialog-title"},"Confirm update to latest release"),r.a.createElement(me.a,null,r.a.createElement(de.a,{id:"alert-dialog-description"},"Updating will not stop or change currently running activities or experiments.")),r.a.createElement(ue.a,null,r.a.createElement(x.a,{onClick:function(){i(!1),m(!0),fetch("/update_app",{method:"POST"}).then((function(e){if(e.ok)return window.location.reload(),!1}))},color:"primary"},"Update now"),r.a.createElement(x.a,{onClick:u,color:"secondary",autoFocus:!0},"Cancel"))),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:s,message:"Updating in the background - you may leave this page",autoHideDuration:2e4,key:"snackbar-update"}))}function Wa(e){var t=Ia(),a=r.a.useState(""),n=Object(l.a)(a,2),i=n[0],o=n[1],c=r.a.useState(""),s=Object(l.a)(c,2),m=s[0],u=s[1];return r.a.useEffect((function(){function e(){return(e=Object(S.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/get_app_version").then((function(e){return e.text()})).then((function(e){o(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(S.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.github.com/repos/pioreactor/pioreactor/releases/latest").then((function(e){return e.json()})).then((function(e){u(e.name)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}()}),[]),r.a.createElement("div",null,r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"}},r.a.createElement(F.a,{variant:"h5",component:"h1"},r.a.createElement(z.a,{fontWeight:"fontWeightBold"},"Updates")),r.a.createElement("div",null,r.a.createElement(Ra,null),r.a.createElement(Aa.a,{color:"inherit",underline:"none",href:"https://github.com/Pioreactor/pioreactor/releases",target:"_blank",rel:"noopener noreferrer"},r.a.createElement(x.a,{style:{textTransform:"none",float:"right",marginRight:"0px"},color:"primary"},r.a.createElement(za.a,{fontSize:"15",classes:{root:t.textIcon}})," View latest release")))),r.a.createElement(Z.a,null),r.a.createElement(F.a,{variant:"subtitle2"},r.a.createElement(z.a,{fontWeight:"fontWeightBold",style:{margin:"10px 2px 10px 2px",display:"inline-block"}},r.a.createElement(Ma.a,{style:{fontSize:14,verticalAlign:"-1px"}})," Version installed:"),r.a.createElement(z.a,{fontWeight:"fontWeightRegular",style:{marginRight:"20px",display:"inline-block"}},i),r.a.createElement(z.a,{fontWeight:"fontWeightBold",style:{margin:"10px 2px 10px 2px",display:"inline-block"}},r.a.createElement(La.a,{style:{fontSize:14,verticalAlign:"-1px"}}),"Latest version available:"),r.a.createElement(z.a,{fontWeight:"fontWeightRegular",style:{marginRight:"20px",display:"inline-block"}},m)))}function Ha(){var e=Ia(),t=r.a.useState(""),a=Object(l.a)(t,2),n=a[0],i=a[1];return r.a.useEffect((function(){function e(){return(e=Object(S.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://raw.githubusercontent.com/Pioreactor/pioreactor/master/CHANGELOG.md").then((function(e){return e.text()})).then((function(e){i(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(P.a,{className:e.root},r.a.createElement(P.a,{className:e.cardContent},r.a.createElement(F.a,{variant:"h6",component:"h6"},"Change log"),r.a.createElement(Da.a,{markdown:n}))))}var Ua=function(e){return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(y.a,{container:!0,spacing:2},r.a.createElement(y.a,{item:!0,md:12,xs:12},r.a.createElement(Wa,null),r.a.createElement(Ha,null)))},Ya=a(277),Ja=a(720),Va=a(714),$a=a(379),Ga=a.n($a),Ka=a(694),qa=Object(G.a)((function(e){return{root:{marginTop:"15px"},title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0},pluginList:{width:"95%",margin:"auto",marginBottom:"15px"},secondaryActionButton:{marginLeft:"10px"}}}));function Za(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(F.a,{variant:"h5",component:"h2"},r.a.createElement(z.a,{fontWeight:"fontWeightBold"},"Plugins")))))}function Qa(e){var t=e.alreadyInstalledPluginsNames,a=qa(),n=r.a.useState([]),i=Object(l.a)(n,2),o=i[0],c=i[1],s=r.a.useState(!1),m=Object(l.a)(s,2),u=m[0],d=m[1],p=r.a.useState(""),f=Object(l.a)(p,2),g=f[0],h=f[1];r.a.useEffect((function(){function e(){return(e=Object(S.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://raw.githubusercontent.com/Pioreactor/list-of-plugins/main/plugins.json").then((function(e){return e.json()})).then((function(e){c(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:a.pluginList},r.a.createElement(Ot.a,{dense:!0},o.filter((function(e){return!t.includes(e.name)})).map((function(e){return r.a.createElement(St.a,{key:e.name},r.a.createElement(Ja.a,null,r.a.createElement(Ka.a,{variant:"square",style:{backgroundColor:"#FFFFFF"}},r.a.createElement(Ya.Hashicon,{value:e.name,size:40}))),r.a.createElement(_t.a,{primary:e.name,secondary:e.description,style:{maxWidth:"500px"}}),r.a.createElement(Va.a,{sx:{display:{xs:"contents",md:"block"}}},r.a.createElement(x.a,{onClick:(t=e.name,function(){d(!0),h("Installing ".concat(t," in the background...")),fetch("/install_plugin",{method:"POST",body:JSON.stringify({plugin_name:t}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){if(!e.ok)throw new Error("Installation went wrong");window.location.reload()}))}),variant:"text",size:"small",color:"inherit","aria-label":"delete",endIcon:r.a.createElement(ne.a,null),className:a.secondaryActionButton},"Install"),r.a.createElement(x.a,{href:e.homepage,target:"_blank",rel:"noopener",variant:"text",size:"small",color:"inherit","aria-label":"install",disabled:!e.homepage,endIcon:r.a.createElement(za.a,null),className:a.secondaryActionButton},"View")));var t})))),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:u,onClose:function(){d(!1)},message:g,autoHideDuration:15e3,resumeHideDuration:2e3,key:"snackbar-available"}))}function Xa(e){var t=e.installedPlugins,a=r.a.useState(!1),n=Object(l.a)(a,2),i=n[0],o=n[1],c=r.a.useState(""),s=Object(l.a)(c,2),m=s[0],u=s[1],d=qa();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:d.pluginList},r.a.createElement(Ot.a,{dense:!0},t.map((function(e){return r.a.createElement(St.a,{key:e.name},r.a.createElement(Ja.a,null,r.a.createElement(Ka.a,{variant:"square",style:{backgroundColor:"#FFFFFF"}},r.a.createElement(Ya.Hashicon,{value:e.name,size:40}))),r.a.createElement(_t.a,{primary:"".concat(e.name," (").concat(e.version,")"),secondary:e.description}),r.a.createElement(Va.a,{sx:{display:{xs:"contents",md:"block"}}},r.a.createElement(x.a,{onClick:(t=e.name,function(){o(!0),u("Uninstalling ".concat(t," in the background...")),fetch("/uninstall_plugin",{method:"POST",body:JSON.stringify({plugin_name:t}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){if(!e.ok)throw new Error("Uninstallation went wrong");window.location.reload()}))}),variant:"text",size:"small",color:"inherit","aria-label":"delete",endIcon:r.a.createElement(Ga.a,null),disabled:"plugins_folder"===e.source,className:d.secondaryActionButton},"plugins_folder"===e.source?"Delete from plugins folder":"Uninstall"),r.a.createElement(x.a,{href:e.homepage,target:"_blank",rel:"noopener",variant:"text",size:"small",color:"inherit","aria-label":"delete",disabled:!e.homepage,endIcon:r.a.createElement(za.a,null),className:d.secondaryActionButton},"View")));var t})))),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:i,onClose:function(){o(!1)},message:m,autoHideDuration:7e3,resumeHideDuration:2e3,key:"snackbar-installation"}))}function en(){var e=qa(),t=r.a.useState([]),a=Object(l.a)(t,2),n=a[0],i=a[1];return r.a.useEffect((function(){function e(){return(e=Object(S.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/get_installed_plugins").then((function(e){return e.json()})).then((function(e){i(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Za,null),r.a.createElement(P.a,{className:e.root},r.a.createElement(P.a,{className:e.cardContent},r.a.createElement("p",null," Install, manage, and discover new Pioreactor plugins created by the community. These plugins can provide new functionalities for your Pioreactor (additional hardware may be necessary), or new automations to control dosing, temperature and LED operations."),r.a.createElement(F.a,{variant:"h6",component:"h3"},"Installed plugins"),r.a.createElement(Xa,{installedPlugins:n}),r.a.createElement(F.a,{variant:"h6",component:"h3"},"Available plugins from the community"),r.a.createElement(Qa,{alreadyInstalledPluginsNames:n.map((function(e){return e.name}))}),r.a.createElement("p",{style:{textAlign:"center",marginTop:"30px"}},r.a.createElement("span",{role:"img","aria-labelledby":"Note"},"\ud83d\udca1")," Learn more about Pioreactor  ",r.a.createElement("a",{href:"https://docs.pioreactor.com/user-guide/using-community-plugins",target:"_blank",rel:"noopener noreferrer"},"plugins"),"."))))}var tn=function(e){return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(y.a,{container:!0,spacing:2},r.a.createElement(y.a,{item:!0,md:12,xs:12},r.a.createElement(en,null)))},an=Object(G.a)((function(e){return{root:{marginTop:"15px"},formControl:{margin:e.spacing(2)},title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0},caption:{marginLeft:"30px",maxWidth:"650px"}}}));function nn(e){var t=an(),a=r.a.useState([{experiment:"<All experiments>"}]),n=Object(l.a)(a,2),i=n[0],o=n[1];r.a.useEffect((function(){function t(){return(t=Object(S.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/get_experiments").then((function(e){return e.json()})).then((function(t){o((function(e){return[].concat(Object(be.a)(t),Object(be.a)(e))})),e.handleChange(t[0].experiment)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]);return r.a.createElement("div",{className:t.root},r.a.createElement(He.a,{component:"fieldset",className:t.formControl},r.a.createElement(Ve.a,{native:!0,variant:"standard",value:e.ExperimentSelection,onChange:function(t){e.handleChange(t.target.value)},inputProps:{name:"experiment",id:"experiment"}},i.map((function(e){return r.a.createElement("option",{value:e.experiment},e.experiment+(e.created_at?" (started ".concat(B()(e.created_at).format("MMMM D, YYYY"),")"):""))})))))}var rn=function(e){var t=r.a.useState(""),a=Object(l.a)(t,2),n=a[0],i=a[1];return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{container:!0,spacing:2,justifyContent:"space-between"},r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(nn,{experimentSelection:n,handleChange:function(e){i(e)}})),r.a.createElement(y.a,{item:!0,xs:12,md:6,container:!0,spacing:2,justifyContent:"flex-start",style:{height:"100%"}},r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(Le,{dataSource:"growth_rates",title:"Implied growth rate",topic:"growth_rate_calculating/growth_rate",payloadKey:"growth_rate",yAxisLabel:"Growth rate, h\u207b\xb9",experiment:n,deltaHours:20,interpolation:"stepAfter",yAxisDomain:[-.02,.1],lookback:1e5,fixedDecimals:2})),r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(Le,{dataSource:"temperature_readings",title:"Temperature of vials",topic:"temperature_control/temperature",yAxisLabel:"temperature, \u2103",payloadKey:"temperature",experiment:n,interpolation:"stepAfter",lookback:1e4,deltaHours:1,yAxisDomain:[22.5,37.5],fixedDecimals:1})),r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(Le,{yAxisDomain:[0,.05],dataSource:"alt_media_fraction",interpolation:"stepAfter",payloadKey:"alt_media_fraction",title:"Fraction of volume that is alternative media",topic:"alt_media_calculating/alt_media_fraction",yAxisLabel:"Fraction",experiment:n,deltaHours:1,fixedDecimals:3,lookback:1e5}))),r.a.createElement(y.a,{item:!0,xs:12,md:6,container:!0,spacing:2,justifyContent:"flex-start",style:{height:"100%"}},r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(Le,{isODReading:!0,dataSource:"od_readings_filtered",title:"Normalized optical density",payloadKey:"od_filtered",topic:"growth_rate_calculating/od_filtered",yAxisLabel:"Current OD / initial OD",experiment:n,deltaHours:20,interpolation:"stepAfter",lookback:1e5,fixedDecimals:2})),r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(Le,{isODReading:!0,dataSource:"od_readings_raw",title:"Optical density",payloadKey:"voltage",topic:"od_reading/od_raw/+",yAxisLabel:"Voltage",experiment:n,deltaHours:20,interpolation:"stepAfter",lookback:1e4,fixedDecimals:3})))))},on=Object(G.a)((function(e){return{root:{marginTop:"15px"},title:{fontSize:14},cardContent:{padding:"10px"},pos:{marginBottom:0},textField:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},formControl:{margin:e.spacing(3)},halfTextField:{width:"70%"}}}));function ln(e){var t=on(),a=r.a.useState(!1),n=Object(l.a)(a,2),i=n[0],o=n[1],c=r.a.useState(""),s=Object(l.a)(c,2),m=s[0],u=s[1],d=r.a.useState(""),p=Object(l.a)(d,2),f=p[0],g=p[1],h=r.a.useState(""),E=Object(l.a)(h,2),b=E[0],v=E[1],x=r.a.useState(!1),_=Object(l.a)(x,2),O=_[0],j=_[1],S=r.a.useState(!1),k=Object(l.a)(S,2),w=k[0],C=k[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement(F.a,{variant:"h5",component:"h2"},r.a.createElement(z.a,{fontWeight:"fontWeightBold"},"Share feedback"))),r.a.createElement(P.a,{className:t.root},r.a.createElement(P.a,{className:t.cardContent},r.a.createElement("p",null,"Include your email, and we may get back to you with some questions or advice about your provided feedback. We appreciate all feedback sent to us!"),r.a.createElement(Ue.a,null,r.a.createElement(y.a,{container:!0,spacing:1},r.a.createElement(y.a,{item:!0,xs:12,md:6},r.a.createElement(at.a,{error:i,id:"email",type:"email",label:"Email",required:!0,onChange:function(e){o(!1),u(""),g(e.target.value)},className:"".concat(t.halfTextField," ").concat(t.textField),value:f,helperText:m})),r.a.createElement(y.a,{item:!0,xs:12,md:12},r.a.createElement(at.a,{label:"What went wrong? What went right? What are you unsure about?",maxRows:4,multiline:!0,required:!0,onChange:function(e){v(e.target.value)},value:b,className:t.textField,minRows:3,fullWidth:!0})),r.a.createElement(y.a,{item:!0,xs:12,md:12},r.a.createElement($e.a,{loading:O,variant:"contained",color:"primary",disabled:w,onClick:function(e){if(e.preventDefault(),""===f)return o(!0),void u("Can't be blank.");j(!0),fetch("https://us-central1-pioreactor-backend.cloudfunctions.net/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:f,message:b})}),j(!1),C(!0)}},w?"Submitted":"Submit")))))))}var cn=function(e){return r.a.useEffect((function(){document.title=e.title}),[e.title]),r.a.createElement(y.a,{container:!0,spacing:3},r.a.createElement(y.a,{item:!0,md:12,xs:12},r.a.createElement(ln,null)))},sn=a(695),mn=a(680),un=a(386),dn=a.n(un),pn=a(381),fn=a.n(pn),gn=a(278),hn=a.n(gn),En=a(385),bn=a.n(En),vn=a(721),yn=a(733),xn=a(384),_n=a.n(xn),On=a(380),jn=a.n(On),Sn=a(382),kn=a.n(Sn),wn=a(383),Cn=a.n(wn),Tn=Object(G.a)((function(e){return{root:{display:"flex"},drawer:Object(_.a)({},e.breakpoints.up("sm"),{width:212,flexShrink:0}),menuButton:{marginRight:e.spacing(2)},drawerPaper:{width:212},title:{flexGrow:1},appBarRoot:Object(_.a)({},e.breakpoints.up("sm"),{zIndex:e.zIndex.drawer+1}),listItemIcon:{minWidth:"40px"},divider:{marginTop:"15px",marginBottom:"15px"}}}));function Nn(){var e=Tn(),t=r.a.useState(!1),a=Object(l.a)(t,2),n=a[0],i=a[1],o=r.a.useState(null),c=Object(l.a)(o,2),s=c[0],m=c[1],u=r.a.useState(null),d=Object(l.a)(u,2),p=d[0],f=d[1];r.a.useEffect((function(){function e(){return(e=Object(S.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/get_app_version").then((function(e){return e.text()})).then((function(e){m(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(S.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.github.com/repos/pioreactor/pioreactor/releases/latest").then((function(e){return e.json()})).then((function(e){f(e.name)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}()}),[]);var g=function(){i(!n)};function h(e){return window.location.pathname===e}var E=r.a.createElement(r.a.Fragment,null,"Help ",r.a.createElement(za.a,{style:{fontSize:"15px",verticalAlign:"middle"}})),b=function(){return r.a.createElement("div",{className:e.drawerContainer},r.a.createElement(Ot.a,null,r.a.createElement(St.a,{href:"/overview",component:"a",key:"overview",selected:h("/")||h("/overview")},r.a.createElement(xt.a,{className:e.listItemIcon},r.a.createElement(jn.a,{color:h("/")||h("/overview")?"primary":"inherit"})," "),r.a.createElement(_t.a,{primaryTypographyProps:{color:h("/")||h("/overview")?"primary":"rgba(0, 0, 0, 0.87)"},primary:"Overview"})),r.a.createElement(St.a,{href:"/pioreactors",component:"a",key:"pioreactors",selected:h("/pioreactors")},r.a.createElement(xt.a,{className:e.listItemIcon}," ",r.a.createElement(Me,{color:h("/pioreactors")?"primary":"inherit",viewBox:"-3 0 24 24"})," "),r.a.createElement(_t.a,{primaryTypographyProps:{color:h("/pioreactors")?"primary":"rgba(0, 0, 0, 0.87)"},primary:"Pioreactors"})),r.a.createElement(St.a,{href:"/export-data",component:"a",key:"export_data",selected:h("/export-data")},r.a.createElement(xt.a,{className:e.listItemIcon},r.a.createElement(fn.a,{color:h("/export-data")?"primary":"inherit"})," "),r.a.createElement(_t.a,{primaryTypographyProps:{color:h("/export-data")?"primary":"rgba(0, 0, 0, 0.87)"},primary:"Export data"})),r.a.createElement(St.a,{href:"/config",component:"a",key:"config",selected:h("/config")},r.a.createElement(xt.a,{className:e.listItemIcon}," ",r.a.createElement(kn.a,{color:h("/config")?"primary":"inherit"})," "),r.a.createElement(_t.a,{primaryTypographyProps:{color:h("/config")?"primary":"rgba(0, 0, 0, 0.87)"},primary:"Configuration"})),r.a.createElement(St.a,{href:"/analysis",component:"a",key:"analysis",selected:h("/analysis")},r.a.createElement(xt.a,{className:e.listItemIcon}," ",r.a.createElement(Cn.a,{color:h("/analysis")?"primary":"inherit"})," "),r.a.createElement(_t.a,{primaryTypographyProps:{color:h("/analysis")?"primary":"rgba(0, 0, 0, 0.87)"},primary:"Analysis"})),r.a.createElement(Z.a,{className:e.divider}),r.a.createElement(St.a,{href:"/plugins",component:"a",key:"plugins",selected:h("/plugins")},r.a.createElement(xt.a,{className:e.listItemIcon},r.a.createElement(_n.a,{color:h("/plugins")?"primary":"inherit"})," "),r.a.createElement(_t.a,{primaryTypographyProps:{color:h("/plugins")?"primary":"rgba(0, 0, 0, 0.87)"},primary:"Plugins"})),r.a.createElement(St.a,{href:"/updates",component:"a",key:"updates",selected:h("/updates")},r.a.createElement(xt.a,{className:e.listItemIcon},r.a.createElement(mn.a,{variant:"dot",color:"secondary",invisible:!(s&&p&&s!==p)},r.a.createElement(La.a,{color:h("/updates")?"primary":"inherit"}))),r.a.createElement(_t.a,{primaryTypographyProps:{color:h("/updates")?"primary":"rgba(0, 0, 0, 0.87)"},primary:"Updates"})),r.a.createElement(St.a,{target:"_blank",rel:"noopener noreferrer",href:"https://docs.pioreactor.com",component:"a",key:"help"},r.a.createElement(xt.a,{className:e.listItemIcon},r.a.createElement(hn.a,null)," "),r.a.createElement(_t.a,{primary:E,primaryTypographyProps:{color:"rgba(0, 0, 0, 0.87)"}})),r.a.createElement(St.a,{href:"/feedback",component:"a",key:"feedback",selected:h("/feedback")},r.a.createElement(xt.a,{className:e.listItemIcon},r.a.createElement(bn.a,{color:h("/feedback")?"primary":"inherit"})),r.a.createElement(_t.a,{primaryTypographyProps:{color:h("/feedback")?"primary":"rgba(0, 0, 0, 0.87)"},primary:"Share feedback"}))))};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:e.appBarRoot},r.a.createElement(yn.a,{position:"fixed"},r.a.createElement(vn.a,{variant:"dense"},r.a.createElement(jt.a,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:g,classes:{root:e.menuButton},sx:{display:{xs:"block",sm:"none"}},size:"large"},r.a.createElement(dn.a,null)),r.a.createElement(F.a,{variant:"h6",className:e.title},r.a.createElement(Aa.a,{color:"inherit",underline:"none",href:"/",className:e.title}," ",r.a.createElement("img",{alt:"pioreactor logo",src:"/white_colour.png",style:{width:"120px",height:"29px"}})," ")),r.a.createElement(Aa.a,{color:"inherit",underline:"none",href:"https://docs.pioreactor.com",target:"_blank",rel:"noopener noreferrer"},r.a.createElement(x.a,{color:"inherit",style:{textTransform:"none"}},"Help ",r.a.createElement(hn.a,{style:{fontSize:18,verticalAlign:"middle",marginLeft:5}})))))),r.a.createElement(sn.a,{variant:"temporary",anchor:"left",open:n,onClose:g,classes:{paper:e.drawerPaper},ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"}}},b()),r.a.createElement(sn.a,{classes:{paper:e.drawerPaper},variant:"permanent",open:!0,className:e.drawer,sx:{display:{xs:"none",sm:"block"}}},r.a.createElement(vn.a,null),b()))}var Dn=function(e){Object(T.a)(a,e);var t=Object(N.a)(a);function a(e){var n;return Object(k.a)(this,a),(n=t.call(this,e)).state={hasError:!1},n}return Object(w.a)(a,[{key:"componentDidCatch",value:function(e,t){console.log(e),console.log(this.props.config)}},{key:"render",value:function(){return this.state.hasError?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{maxWidth:700,margin:"auto"}},r.a.createElement("div",null,r.a.createElement("h1",null,"Something went wrong with the PioreactorUI!"),r.a.createElement("h3",null,"Don't worry. It's our fault. Here's what you can do:"),r.a.createElement("p",null," Looks like there's a bug in the UI. See the console (\u2318+\u2325+i) for error information. We would appreciate it if you create an issue in ",r.a.createElement("a",{href:"https://github.com/Pioreactor/pioreactorui/issues"},"Github")," for us, with the information in the console (\u2318+\u2325+i).")),r.a.createElement("div",null,r.a.createElement("h3",null," Current config.ini "),r.a.createElement("pre",null,JSON.stringify(this.props.config,null,2))))):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),a}(r.a.Component);a(587),a(588),a(589),a(590),a(352);var An=Object(m.a)({palette:{background:{default:"#f6f6f7"},primary:{main:"#5331CA"},secondary:{main:"#f44336"}}});function Bn(){var e=r.a.useState({}),t=Object(l.a)(e,2),a=t[0],n=t[1];return r.a.useEffect((function(){fetch("/get_config/config.ini").then((function(e){if(e.ok)return e.text();throw new Error("Something went wrong")})).then((function(e){n(function(e){var t={section:/^\s*\[\s*([^\]]*)\s*\]\s*$/,param:/^\s*([^=]+?)\s*=\s*(.*?)\s*$/,comment:/^\s*;.*$/},a={},n=e.split(/[\r\n]+/),r=null;return n.forEach((function(e){if(!t.comment.test(e))if(t.param.test(e)){var n=e.match(t.param);r?a[r][n[1]]=n[2]:a[n[1]]=n[2]}else t.section.test(e)?(n=e.match(t.section),a[n[1]]={},r=n[1]):0===e.length&&r&&(r=null)})),a}(e))})).catch((function(e){}))}),[]),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(Dn,{config:a},r.a.createElement(Nn,null),r.a.createElement("main",{style:{flexGrow:1,paddingTop:An.spacing(9),paddingLeft:An.spacing(4),paddingRight:An.spacing(4)}},r.a.createElement(c.a,null,r.a.createElement("div",{className:"pageContainer"},r.a.createElement(s.c,null,r.a.createElement(s.a,{path:"/export-data"},r.a.createElement(Qe,{config:a,title:"Pioreactor ~ Export data"})),r.a.createElement(s.a,{path:"/start-new-experiment"},r.a.createElement(Sa,{config:a,title:"Pioreactor ~ Start new experiment"})),r.a.createElement(s.a,{path:"/overview"},r.a.createElement(Re,{config:a,title:"Pioreactor ~ Overview"})),r.a.createElement(s.a,{path:"/plugins"},r.a.createElement(tn,{config:a,title:"Pioreactor ~ Plugins"})),r.a.createElement(s.a,{path:"/analysis"},r.a.createElement(rn,{config:a,title:"Pioreactor ~ Analysis"})),r.a.createElement(s.a,{path:"/config"},r.a.createElement(Na,{config:a,title:"Pioreactor ~ Configuration"})),r.a.createElement(s.a,{path:"/pioreactors",exact:!0},r.a.createElement(aa,{config:a,title:"Pioreactor ~ Pioreactors"})),r.a.createElement(s.a,{path:"/pioreactors/:unit"},r.a.createElement(na,{config:a,title:"Pioreactor ~ Unit"})),r.a.createElement(s.a,{path:"/updates"},r.a.createElement(Ua,{config:a,title:"Pioreactor ~ Updates"})),r.a.createElement(s.a,{path:"/feedback"},r.a.createElement(cn,{config:a,title:"Pioreactor ~ Feedback"})),r.a.createElement(s.a,{path:"/"},r.a.createElement(Re,{config:a,title:"Pioreactor ~ Pioreactor"}))),r.a.createElement(v,{config:a}),r.a.createElement(b,{config:a}))))))}var Ln=function(){return r.a.createElement(r.a.StrictMode,null,r.a.createElement(p.a,{injectFirst:!0},r.a.createElement(u.a,{theme:An},r.a.createElement(d.a,null),r.a.createElement(Bn,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Ln,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[431,1,2]]]);
//# sourceMappingURL=main.00cea04f.chunk.js.map